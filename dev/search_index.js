var documenterSearchIndex = {"docs":
[{"location":"methods/CorrespondenceAnalysis/#Correspondence-Analysis","page":"Correspondence Analysis","title":"Correspondence Analysis","text":"","category":"section"},{"location":"methods/CorrespondenceAnalysis/#Outline","page":"Correspondence Analysis","title":"Outline","text":"","category":"section"},{"location":"methods/CorrespondenceAnalysis/","page":"Correspondence Analysis","title":"Correspondence Analysis","text":"This page details how to perform correspondence analysis in Julia following the computational algorithm outlined in appendix A of Greenacre (2017) and implemented in the R package ca (Nenadic and Greenacre 2007).","category":"page"},{"location":"methods/CorrespondenceAnalysis/","page":"Correspondence Analysis","title":"Correspondence Analysis","text":"The Julia package MultivariateStats.jl does not currently contain an implementation of correspondence analysis.","category":"page"},{"location":"methods/CorrespondenceAnalysis/#Import-Required-Packages","page":"Correspondence Analysis","title":"Import Required Packages","text":"","category":"section"},{"location":"methods/CorrespondenceAnalysis/#Julia","page":"Correspondence Analysis","title":"Julia","text":"","category":"section"},{"location":"methods/CorrespondenceAnalysis/","page":"Correspondence Analysis","title":"Correspondence Analysis","text":"using Pkg; Pkg.activate(\"docs\")\nusing EcoVeg\nusing NamedArrays\nusing LinearAlgebra\nusing CSV\nusing BenchmarkTools\nusing DataFrames\n# using Plots","category":"page"},{"location":"methods/CorrespondenceAnalysis/#R","page":"Correspondence Analysis","title":"R","text":"","category":"section"},{"location":"methods/CorrespondenceAnalysis/","page":"Correspondence Analysis","title":"Correspondence Analysis","text":"library(ca)\nlibrary(microbenchmark)\nlibrary(ggplot2)\nlibrary(dplyr)","category":"page"},{"location":"methods/CorrespondenceAnalysis/","page":"Correspondence Analysis","title":"Correspondence Analysis","text":"Attaching package: 'dplyr'\n\nThe following objects are masked from 'package:stats':\n\n    filter, lag\n\nThe following objects are masked from 'package:base':\n\n    intersect, setdiff, setequal, union","category":"page"},{"location":"methods/CorrespondenceAnalysis/","page":"Correspondence Analysis","title":"Correspondence Analysis","text":"library(JuliaCall)","category":"page"},{"location":"methods/CorrespondenceAnalysis/#Create-example-data","page":"Correspondence Analysis","title":"Create example data","text":"","category":"section"},{"location":"methods/CorrespondenceAnalysis/","page":"Correspondence Analysis","title":"Correspondence Analysis","text":"Create example data in the form of a site by species named matrix, N.","category":"page"},{"location":"methods/CorrespondenceAnalysis/","page":"Correspondence Analysis","title":"Correspondence Analysis","text":"<details class=\"code-fold\"> <summary>Code</summary>","category":"page"},{"location":"methods/CorrespondenceAnalysis/","page":"Correspondence Analysis","title":"Correspondence Analysis","text":"N = generate_test_array(rown = 20, coln = 30, meancoloccs = 10, rowprefix = \"SiteA-\", colprefix = \"Species\")","category":"page"},{"location":"methods/CorrespondenceAnalysis/","page":"Correspondence Analysis","title":"Correspondence Analysis","text":"</details>","category":"page"},{"location":"methods/CorrespondenceAnalysis/","page":"Correspondence Analysis","title":"Correspondence Analysis","text":"20×30 Named Matrix{Float64}\nReleve ╲ Species │   Species1    Species2  …   Species29   Species30\n─────────────────┼──────────────────────────────────────────────────\nSiteA-1          │        0.0         0.0  …         0.0         0.0\nSiteA-2          │   0.164662   0.0936614            0.0         0.0\nSiteA-3          │   0.154406         0.0            0.0         0.0\nSiteA-4          │        0.0         0.0            0.0   0.0878286\nSiteA-5          │        0.0         0.0        0.15232         0.0\nSiteA-6          │  0.0422097         0.0            0.0         0.0\nSiteA-7          │   0.174271    0.153655            0.0   0.0613221\nSiteA-8          │   0.167771         0.0            0.0         0.0\n⋮                           ⋮           ⋮  ⋱           ⋮           ⋮\nSiteA-13         │   0.136191   0.0530328      0.0382785         0.0\nSiteA-14         │        0.0         0.0       0.159143         0.0\nSiteA-15         │        0.0   0.0581085      0.0687663  0.00675044\nSiteA-16         │        0.0    0.131618            0.0         0.0\nSiteA-17         │        0.0         0.0            0.0   0.0365927\nSiteA-18         │  0.0281285   0.0955669            0.0    0.165666\nSiteA-19         │   0.106493         0.0            0.0         0.0\nSiteA-20         │        0.0         0.0  …   0.0146647         0.0","category":"page"},{"location":"methods/CorrespondenceAnalysis/","page":"Correspondence Analysis","title":"Correspondence Analysis","text":"<!– ## Perform chi^2 test","category":"page"},{"location":"methods/CorrespondenceAnalysis/","page":"Correspondence Analysis","title":"Correspondence Analysis","text":"Perform a chi-squared (chi^2) test to check whether there is asignificant dependence between the rows and columns. –>","category":"page"},{"location":"methods/CorrespondenceAnalysis/#A.1-Create-the-correspondence-matrix","page":"Correspondence Analysis","title":"A.1 Create the correspondence matrix","text":"","category":"section"},{"location":"methods/CorrespondenceAnalysis/","page":"Correspondence Analysis","title":"Correspondence Analysis","text":"Calculate the correspondence matrix $P$ following @eq-p.\n\n$$\nP = \\frac{1}{n}N\n$$ {#eq-p}","category":"page"},{"location":"methods/CorrespondenceAnalysis/","page":"Correspondence Analysis","title":"Correspondence Analysis","text":"begin\n  n = sum(N)\n  P = N / n\nend","category":"page"},{"location":"methods/CorrespondenceAnalysis/","page":"Correspondence Analysis","title":"Correspondence Analysis","text":"20×30 Named Matrix{Float64}\nReleve ╲ Species │    Species1     Species2  …    Species29    Species30\n─────────────────┼──────────────────────────────────────────────────────\nSiteA-1          │         0.0          0.0  …          0.0          0.0\nSiteA-2          │   0.0082331   0.00468307             0.0          0.0\nSiteA-3          │  0.00772029          0.0             0.0          0.0\nSiteA-4          │         0.0          0.0             0.0   0.00439143\nSiteA-5          │         0.0          0.0      0.00761602          0.0\nSiteA-6          │  0.00211049          0.0             0.0          0.0\nSiteA-7          │  0.00871354   0.00768277             0.0   0.00306611\nSiteA-8          │  0.00838856          0.0             0.0          0.0\n⋮                            ⋮            ⋮  ⋱            ⋮            ⋮\nSiteA-13         │  0.00680954   0.00265164      0.00191392          0.0\nSiteA-14         │         0.0          0.0      0.00795717          0.0\nSiteA-15         │         0.0   0.00290542      0.00343832  0.000337522\nSiteA-16         │         0.0   0.00658088             0.0          0.0\nSiteA-17         │         0.0          0.0             0.0   0.00182964\nSiteA-18         │  0.00140643   0.00477835             0.0   0.00828331\nSiteA-19         │  0.00532463          0.0             0.0          0.0\nSiteA-20         │         0.0          0.0  …  0.000733237          0.0","category":"page"},{"location":"methods/CorrespondenceAnalysis/#A.2-Calculate-column-and-row-masses","page":"Correspondence Analysis","title":"A.2 Calculate column and row masses","text":"","category":"section"},{"location":"methods/CorrespondenceAnalysis/","page":"Correspondence Analysis","title":"Correspondence Analysis","text":"Calculate the row and and column masses using @eq-row_masses and @eq-column_masses respectively.\n\n$$\nr = P1 \\space \\space\nr_{i} = \\sum^{J}_{j = 1} P_{ij}\n$$ {#eq-row_masses}","category":"page"},{"location":"methods/CorrespondenceAnalysis/","page":"Correspondence Analysis","title":"Correspondence Analysis","text":"$$\nc = P^{t}1 \\space \\space\nc_{j} = \\sum^{I}_{i = 1} P_{ij}\n$$ {#eq-column_masses}","category":"page"},{"location":"methods/CorrespondenceAnalysis/","page":"Correspondence Analysis","title":"Correspondence Analysis","text":"r = vec(sum(P, dims = 2))","category":"page"},{"location":"methods/CorrespondenceAnalysis/","page":"Correspondence Analysis","title":"Correspondence Analysis","text":"20-element Vector{Float64}:\n 0.05\n 0.05\n 0.04999999999999999\n 0.049999999999999996\n 0.049999999999999996\n 0.049999999999999975\n 0.05\n 0.049999999999999996\n 0.04999999999999999\n 0.05\n 0.049999999999999996\n 0.049999999999999996\n 0.049999999999999996\n 0.049999999999999975\n 0.049999999999999996\n 0.04999999999999999\n 0.049999999999999996\n 0.04999999999999998\n 0.04999999999999998\n 0.04999999999999999","category":"page"},{"location":"methods/CorrespondenceAnalysis/","page":"Correspondence Analysis","title":"Correspondence Analysis","text":"c = vec(sum(P, dims = 1))","category":"page"},{"location":"methods/CorrespondenceAnalysis/","page":"Correspondence Analysis","title":"Correspondence Analysis","text":"30-element Vector{Float64}:\n 0.06242175930346598\n 0.030336689421837634\n 0.024417474841065736\n 0.011236333558953641\n 0.023256756434305484\n 0.02740591986283429\n 0.04329482947731683\n 0.0418674696871211\n 0.02205529997017692\n 0.05209312097873284\n ⋮\n 0.05144583704123703\n 0.009401856450938759\n 0.024337135096116916\n 0.03692637226439267\n 0.040825754385220035\n 0.02827244127586385\n 0.017112629450118814\n 0.028199086410775443\n 0.01790800682139619","category":"page"},{"location":"methods/CorrespondenceAnalysis/#A.3-Diagonal-matrices-of-row-and-column-masses","page":"Correspondence Analysis","title":"A.3 Diagonal matrices of row and column masses","text":"","category":"section"},{"location":"methods/CorrespondenceAnalysis/","page":"Correspondence Analysis","title":"Correspondence Analysis","text":"Dr = Diagonal(r)","category":"page"},{"location":"methods/CorrespondenceAnalysis/","page":"Correspondence Analysis","title":"Correspondence Analysis","text":"20×20 Diagonal{Float64, Vector{Float64}}:\n 0.05   ⋅     ⋅     ⋅     ⋅     ⋅    …   ⋅     ⋅     ⋅     ⋅     ⋅     ⋅ \n  ⋅    0.05   ⋅     ⋅     ⋅     ⋅        ⋅     ⋅     ⋅     ⋅     ⋅     ⋅ \n  ⋅     ⋅    0.05   ⋅     ⋅     ⋅        ⋅     ⋅     ⋅     ⋅     ⋅     ⋅ \n  ⋅     ⋅     ⋅    0.05   ⋅     ⋅        ⋅     ⋅     ⋅     ⋅     ⋅     ⋅ \n  ⋅     ⋅     ⋅     ⋅    0.05   ⋅        ⋅     ⋅     ⋅     ⋅     ⋅     ⋅ \n  ⋅     ⋅     ⋅     ⋅     ⋅    0.05  …   ⋅     ⋅     ⋅     ⋅     ⋅     ⋅ \n  ⋅     ⋅     ⋅     ⋅     ⋅     ⋅        ⋅     ⋅     ⋅     ⋅     ⋅     ⋅ \n  ⋅     ⋅     ⋅     ⋅     ⋅     ⋅        ⋅     ⋅     ⋅     ⋅     ⋅     ⋅ \n  ⋅     ⋅     ⋅     ⋅     ⋅     ⋅        ⋅     ⋅     ⋅     ⋅     ⋅     ⋅ \n  ⋅     ⋅     ⋅     ⋅     ⋅     ⋅        ⋅     ⋅     ⋅     ⋅     ⋅     ⋅ \n  ⋅     ⋅     ⋅     ⋅     ⋅     ⋅    …   ⋅     ⋅     ⋅     ⋅     ⋅     ⋅ \n  ⋅     ⋅     ⋅     ⋅     ⋅     ⋅        ⋅     ⋅     ⋅     ⋅     ⋅     ⋅ \n  ⋅     ⋅     ⋅     ⋅     ⋅     ⋅        ⋅     ⋅     ⋅     ⋅     ⋅     ⋅ \n  ⋅     ⋅     ⋅     ⋅     ⋅     ⋅        ⋅     ⋅     ⋅     ⋅     ⋅     ⋅ \n  ⋅     ⋅     ⋅     ⋅     ⋅     ⋅       0.05   ⋅     ⋅     ⋅     ⋅     ⋅ \n  ⋅     ⋅     ⋅     ⋅     ⋅     ⋅    …   ⋅    0.05   ⋅     ⋅     ⋅     ⋅ \n  ⋅     ⋅     ⋅     ⋅     ⋅     ⋅        ⋅     ⋅    0.05   ⋅     ⋅     ⋅ \n  ⋅     ⋅     ⋅     ⋅     ⋅     ⋅        ⋅     ⋅     ⋅    0.05   ⋅     ⋅ \n  ⋅     ⋅     ⋅     ⋅     ⋅     ⋅        ⋅     ⋅     ⋅     ⋅    0.05   ⋅ \n  ⋅     ⋅     ⋅     ⋅     ⋅     ⋅        ⋅     ⋅     ⋅     ⋅     ⋅    0.05","category":"page"},{"location":"methods/CorrespondenceAnalysis/","page":"Correspondence Analysis","title":"Correspondence Analysis","text":"Dc = Diagonal(c)","category":"page"},{"location":"methods/CorrespondenceAnalysis/","page":"Correspondence Analysis","title":"Correspondence Analysis","text":"30×30 Diagonal{Float64, Vector{Float64}}:\n 0.0624218   ⋅          ⋅         …   ⋅          ⋅          ⋅ \n  ⋅         0.0303367   ⋅             ⋅          ⋅          ⋅ \n  ⋅          ⋅         0.0244175      ⋅          ⋅          ⋅ \n  ⋅          ⋅          ⋅             ⋅          ⋅          ⋅ \n  ⋅          ⋅          ⋅             ⋅          ⋅          ⋅ \n  ⋅          ⋅          ⋅         …   ⋅          ⋅          ⋅ \n  ⋅          ⋅          ⋅             ⋅          ⋅          ⋅ \n  ⋅          ⋅          ⋅             ⋅          ⋅          ⋅ \n  ⋅          ⋅          ⋅             ⋅          ⋅          ⋅ \n  ⋅          ⋅          ⋅             ⋅          ⋅          ⋅ \n ⋮                                ⋱                        \n  ⋅          ⋅          ⋅             ⋅          ⋅          ⋅ \n  ⋅          ⋅          ⋅             ⋅          ⋅          ⋅ \n  ⋅          ⋅          ⋅             ⋅          ⋅          ⋅ \n  ⋅          ⋅          ⋅             ⋅          ⋅          ⋅ \n  ⋅          ⋅          ⋅         …   ⋅          ⋅          ⋅ \n  ⋅          ⋅          ⋅             ⋅          ⋅          ⋅ \n  ⋅          ⋅          ⋅            0.0171126   ⋅          ⋅ \n  ⋅          ⋅          ⋅             ⋅         0.0281991   ⋅ \n  ⋅          ⋅          ⋅             ⋅          ⋅         0.017908","category":"page"},{"location":"methods/CorrespondenceAnalysis/#A.4-Calculate-the-matrix-of-standardized-residuals","page":"Correspondence Analysis","title":"A.4 Calculate the matrix of standardized residuals","text":"","category":"section"},{"location":"methods/CorrespondenceAnalysis/","page":"Correspondence Analysis","title":"Correspondence Analysis","text":"$$\nSR = D_{r}^{-\\frac{1}{2}}(P - rc^{T})D_{c}^{-\\frac{1}{2}}\n$$ {#eq-standardized_residuals}","category":"page"},{"location":"methods/CorrespondenceAnalysis/","page":"Correspondence Analysis","title":"Correspondence Analysis","text":"SR = Dr^(-1/2) * (P - r * transpose(c)) * Dc^(-1/2)","category":"page"},{"location":"methods/CorrespondenceAnalysis/","page":"Correspondence Analysis","title":"Correspondence Analysis","text":"20×30 Named Matrix{Float64}\nReleve ╲ Species │    Species1     Species2  …    Species29    Species30\n─────────────────┼──────────────────────────────────────────────────────\nSiteA-1          │  -0.0558667   -0.0389466  …   -0.0375494   -0.0299232\nSiteA-2          │   0.0915037    0.0812969      -0.0375494   -0.0299232\nSiteA-3          │   0.0823245   -0.0389466      -0.0375494   -0.0299232\nSiteA-4          │  -0.0558667   -0.0389466      -0.0375494     0.116833\nSiteA-5          │  -0.0558667   -0.0389466        0.165278   -0.0299232\nSiteA-6          │  -0.0180895   -0.0389466      -0.0375494   -0.0299232\nSiteA-7          │    0.100103     0.158318      -0.0375494    0.0725425\nSiteA-8          │   0.0942865   -0.0389466      -0.0375494   -0.0299232\n⋮                            ⋮            ⋮  ⋱            ⋮            ⋮\nSiteA-13         │   0.0660223    0.0291375       0.0134215   -0.0299232\nSiteA-14         │  -0.0558667   -0.0389466        0.174363   -0.0299232\nSiteA-15         │  -0.0558667    0.0356537       0.0540185   -0.0186436\nSiteA-16         │  -0.0558667     0.130026      -0.0375494   -0.0299232\nSiteA-17         │  -0.0558667   -0.0389466      -0.0375494    0.0312211\nSiteA-18         │   -0.030692    0.0837433      -0.0375494     0.246896\nSiteA-19         │   0.0394428   -0.0389466      -0.0375494   -0.0299232\nSiteA-20         │  -0.0558667   -0.0389466  …   -0.0180221   -0.0299232","category":"page"},{"location":"methods/CorrespondenceAnalysis/#A.5-Calculate-the-Singular-Value-Decomposition-(SVD)-of-S","page":"Correspondence Analysis","title":"A.5 Calculate the Singular Value Decomposition (SVD) of S","text":"","category":"section"},{"location":"methods/CorrespondenceAnalysis/","page":"Correspondence Analysis","title":"Correspondence Analysis","text":"begin\n  svd = LinearAlgebra.svd(SR)\n  U = svd.U\n  S = svd.S\n  V = svd.V\n  Vt = svd.Vt\nend","category":"page"},{"location":"methods/CorrespondenceAnalysis/","page":"Correspondence Analysis","title":"Correspondence Analysis","text":"20×30 Matrix{Float64}:\n -0.00435365  -0.12054    -0.0103767   …  -0.2023       0.00578967\n  0.358463     0.254768   -0.165654       -0.353944     0.126832\n -0.0720393    0.0062444   0.0518127      -0.191196     0.279125\n -0.0308529    0.254494    0.107747       -0.00644227   0.339832\n -0.263297     0.192573   -0.0944804       0.0719118    0.0972595\n  0.102404     0.0225048  -0.0979738   …  -0.194209    -0.238853\n -0.038568    -0.0918263   0.168725       -0.245323     0.0508806\n -0.0516729   -0.0160058  -0.142925        0.180373    -0.125216\n  0.314991    -0.105272   -0.0403872       0.0870616   -0.196858\n  0.116631    -0.165536   -0.0781826       0.223346    -0.00198167\n -0.161451    -0.21706     0.0310513   …  -0.0589985   -0.078493\n -0.0374005    0.312827    0.0456166       0.110742    -0.0498213\n -0.124641    -0.0708134  -0.340622        0.133984     0.449057\n  0.415064     0.029204    0.0489769       0.0382038    0.204825\n  0.0804593    0.301285   -0.107038       -0.0797646   -0.19309\n  0.138842     0.311094    0.180097    …   0.247266    -0.0486915\n  0.192082    -0.0266423  -0.279959        0.0994312   -0.00289005\n  0.0745857    0.146279    0.125657       -0.138485    -0.234867\n  0.082795     0.0775415   0.178353       -0.255109    -0.169398\n -0.437329     0.0163395   0.00371575     -0.108152    -0.0401564","category":"page"},{"location":"methods/CorrespondenceAnalysis/#A.6-Standard-coordinates-*Φ*-of-rows","page":"Correspondence Analysis","title":"A.6 Standard coordinates Φ of rows","text":"","category":"section"},{"location":"methods/CorrespondenceAnalysis/","page":"Correspondence Analysis","title":"Correspondence Analysis","text":"$$\n\\Phi = D_{r}^{-\\frac{1}{2}} U\n$$ {#eq-standard_coordinates_rows}","category":"page"},{"location":"methods/CorrespondenceAnalysis/","page":"Correspondence Analysis","title":"Correspondence Analysis","text":"Φ = Dr^(-1/2) * U","category":"page"},{"location":"methods/CorrespondenceAnalysis/","page":"Correspondence Analysis","title":"Correspondence Analysis","text":"20×20 Matrix{Float64}:\n  1.81661    -0.138493   -1.01894    …  -0.421151   0.889969   -1.0\n -2.21335     2.33016    -0.740083      -0.814851  -0.0286263  -1.0\n  0.600871    0.348659    1.37218        0.807438  -1.03069    -1.0\n -0.388163   -0.119437    2.39351        1.02883    0.316485   -1.0\n -1.48442    -2.39152    -0.792373       1.01096   -0.0926924  -1.0\n  0.343341   -0.173452   -1.13129    …  -0.357901   0.358886   -1.0\n -0.359375    1.43896    -0.209854       0.299627   2.09798    -1.0\n  1.53567     0.620525   -0.589057      -0.868616  -0.618023   -1.0\n  0.621686    0.62441    -0.709749       0.577646  -1.1502     -1.0\n  1.6428      0.593474   -0.0576056      0.958925   0.641799   -1.0\n  0.36281    -0.814279   -0.454443   …   1.58578    1.03066    -1.0\n -1.18477    -0.304777   -0.699129       0.332015  -1.57356    -1.0\n -1.00795     0.79526    -0.814948       1.35917    0.576168   -1.0\n -0.0677419  -1.42207    -0.153033      -1.63988    1.4722     -1.0\n  0.318538   -0.85954    -1.13904       -0.546519  -1.7691     -1.0\n  0.194363   -0.0626394   1.07507    …   1.13555   -0.558194   -1.0\n -0.135962   -0.44786     1.1992        -0.710281   0.132342   -1.0\n  0.413197    0.804752    1.00301       -1.00316   -1.18272    -1.0\n -0.46758    -0.664653    1.29936       -1.68604    0.676605   -1.0\n -0.540583   -0.157474    0.167208      -1.04755   -0.189286   -1.0","category":"page"},{"location":"methods/CorrespondenceAnalysis/","page":"Correspondence Analysis","title":"Correspondence Analysis","text":"# NamedArrays.setnames!(NamedArray(Φ), names = vec(names(N)[1]))\n# NamedArray(Φ, names(N)[1])","category":"page"},{"location":"methods/CorrespondenceAnalysis/#A.7-Standard-coordinates-*Γ*-of-columns","page":"Correspondence Analysis","title":"A.7 Standard coordinates Γ of columns","text":"","category":"section"},{"location":"methods/CorrespondenceAnalysis/","page":"Correspondence Analysis","title":"Correspondence Analysis","text":"$$\n\\Gamma = D_{c}^{-\\frac{1}{2}} V\n$$ {#eq-standard_coordinates_columns}","category":"page"},{"location":"methods/CorrespondenceAnalysis/","page":"Correspondence Analysis","title":"Correspondence Analysis","text":"Γ = Dc^(-1/2) * V","category":"page"},{"location":"methods/CorrespondenceAnalysis/","page":"Correspondence Analysis","title":"Correspondence Analysis","text":"30×20 Matrix{Float64}:\n -0.0174255   1.43475   -0.288338   …   0.29853     0.331387    -1.75041\n -0.692068    1.46272    0.0358514      0.839845    0.445195     0.0938111\n -0.066406   -1.06011    0.331578       0.804149    1.14138      0.0237792\n -1.69431    -3.14307   -0.250222       3.18754    -0.17797     -0.267077\n -2.66229     2.44785   -1.36875        0.228709   -1.00011      0.680425\n  0.0178716   0.07299    0.347745   …   0.0323598   1.18018     -1.20084\n  0.717799    0.260525   0.41774        0.187601   -0.00338376  -0.879327\n -1.10762    -0.880795   0.561007      -0.794709    1.73408     -0.922313\n  1.06282    -1.21631   -1.00924       -2.20446     0.993067    -1.24745\n  0.5762     -0.238737   0.408488       0.845877   -0.857103    -1.09269\n  ⋮                                 ⋱                           \n  1.84852     0.8209    -0.151991      -0.196201   -0.122899    -0.937398\n  2.09437     0.689419  -1.01721       -2.88223    -1.58156      0.220693\n  0.0294073  -0.241848   2.73891       -0.3082     -1.08704     -0.514006\n -0.986255   -1.09768   -1.16051       -0.680982   -0.160503    -1.49739\n  0.0751799  -0.380309   1.84284    …  -1.33033     0.694979    -1.03796\n  0.267102   -1.46692   -1.37316        1.09894     0.268589    -1.27749\n -1.10736     0.826     -0.524398      -0.0201985   2.21024     -0.695068\n -1.2047     -2.10774   -1.13857       -0.824679   -1.51918     -0.644048\n  0.0432644   0.947772   2.08581       -1.75508    -1.26586     -0.300076","category":"page"},{"location":"methods/CorrespondenceAnalysis/#A.8-Principal-coordinates-F-of-rows","page":"Correspondence Analysis","title":"A.8 Principal coordinates F of rows","text":"","category":"section"},{"location":"methods/CorrespondenceAnalysis/","page":"Correspondence Analysis","title":"Correspondence Analysis","text":"$$\nF = D_{r}^{-\\frac{1}{2}} U D_{\\alpha} = \\Phi D_{\\alpha}\n$$ {#eq-principal_coordinates_rows}","category":"page"},{"location":"methods/CorrespondenceAnalysis/","page":"Correspondence Analysis","title":"Correspondence Analysis","text":"F = Φ * Diagonal(S)","category":"page"},{"location":"methods/CorrespondenceAnalysis/","page":"Correspondence Analysis","title":"Correspondence Analysis","text":"20×20 Matrix{Float64}:\n  1.11354    -0.0770602  -0.545181   -0.236412   …   0.0914481   -1.78061e-16\n -1.35672     1.29655    -0.395978   -0.624042      -0.00294147  -1.78061e-16\n  0.368318    0.194001    0.734179   -0.594072      -0.105908    -1.78061e-16\n -0.237934   -0.0664573   1.28064    -0.317895       0.0325202   -1.78061e-16\n -0.909911   -1.33069    -0.423955   -0.211541      -0.00952453  -1.78061e-16\n  0.210459   -0.0965124  -0.605294    0.0789769  …   0.036877    -1.78061e-16\n -0.220288    0.800667   -0.112282    0.987349       0.215576    -1.78061e-16\n  0.941323    0.345273   -0.315172   -0.532089      -0.0635045   -1.78061e-16\n  0.381077    0.347435   -0.379748    0.501673      -0.118188    -1.78061e-16\n  1.007       0.330222   -0.0308216  -0.679721       0.0659475   -1.78061e-16\n  0.222393   -0.453082   -0.243148    0.481718   …   0.105905    -1.78061e-16\n -0.726233   -0.169585   -0.374066    0.276225      -0.16169     -1.78061e-16\n -0.617845    0.4425     -0.436034   -0.20976        0.0592037   -1.78061e-16\n -0.041524   -0.791269   -0.0818798  -0.0444038      0.151274    -1.78061e-16\n  0.195256   -0.478266   -0.609438    0.213182      -0.181783    -1.78061e-16\n  0.11914    -0.0348539   0.575213    0.131569   …  -0.0573568   -1.78061e-16\n -0.0833413  -0.249199    0.641629    0.323233       0.0135987   -1.78061e-16\n  0.253279    0.447781    0.536655    1.10663       -0.121529    -1.78061e-16\n -0.286615   -0.369827    0.695218   -0.0418613      0.069524    -1.78061e-16\n -0.331363   -0.0876216   0.0894637  -0.608756      -0.0194499   -1.78061e-16","category":"page"},{"location":"methods/CorrespondenceAnalysis/#A.9-Principal-coordinates-G-of-columns","page":"Correspondence Analysis","title":"A.9 Principal coordinates G of columns","text":"","category":"section"},{"location":"methods/CorrespondenceAnalysis/","page":"Correspondence Analysis","title":"Correspondence Analysis","text":"$$\nG = D_{c}^{-\\frac{1}{2}} V D_{\\alpha} = \\Gamma D_{\\alpha}\n$$ {#eq-principal_coordinates_rows}","category":"page"},{"location":"methods/CorrespondenceAnalysis/","page":"Correspondence Analysis","title":"Correspondence Analysis","text":"G = Γ * Diagonal(S)","category":"page"},{"location":"methods/CorrespondenceAnalysis/","page":"Correspondence Analysis","title":"Correspondence Analysis","text":"30×20 Matrix{Float64}:\n -0.0106814   0.798325   -0.154274   …   0.0340515    -3.1168e-16\n -0.42422     0.813887    0.0191821      0.0457457     1.67041e-17\n -0.0407051  -0.58987     0.177409       0.117282      4.23414e-18\n -1.03857    -1.74887    -0.13388       -0.0182872    -4.75559e-17\n -1.63191     1.36204    -0.732344      -0.102765      1.21157e-16\n  0.0109548   0.0406132   0.186059   …   0.121269     -2.13823e-16\n  0.439992    0.144962    0.22351       -0.000347696  -1.56574e-16\n -0.678944   -0.490093    0.300164       0.178185     -1.64228e-16\n  0.651482   -0.676781   -0.539989       0.102042     -2.22123e-16\n  0.353195   -0.132838    0.21856       -0.088071     -1.94566e-16\n  ⋮                                  ⋱                \n  1.13309     0.456766   -0.0813218     -0.0126284    -1.66914e-16\n  1.28379     0.383607   -0.544254      -0.162512      3.92968e-17\n  0.0180259  -0.134569    1.46544       -0.111698     -9.15242e-17\n -0.604548   -0.610772   -0.620924      -0.0164923    -2.66627e-16\n  0.0460833  -0.211612    0.986004   …   0.0714121    -1.84819e-16\n  0.163727   -0.816226   -0.734704       0.0275986    -2.2747e-16\n -0.678782    0.459604   -0.280577       0.227112     -1.23764e-16\n -0.738449   -1.17279    -0.609189      -0.156102     -1.1468e-16\n  0.0265199   0.52736     1.116         -0.130072     -5.34317e-17","category":"page"},{"location":"methods/CorrespondenceAnalysis/#A.10-Principal-inertias-*λ*sub*k*/sub","page":"Correspondence Analysis","title":"A.10 Principal inertias λ<sub>k</sub>","text":"","category":"section"},{"location":"methods/CorrespondenceAnalysis/","page":"Correspondence Analysis","title":"Correspondence Analysis","text":"$$\n\\lambda_{k} = \\alpha_{k}^{2}, k = 1,2,...,\\space where \\space k = min\\{I-1,J-1\\}\n$$ {#eq-principal_inertias}","category":"page"},{"location":"methods/CorrespondenceAnalysis/","page":"Correspondence Analysis","title":"Correspondence Analysis","text":"F * Dr * transpose(F)","category":"page"},{"location":"methods/CorrespondenceAnalysis/","page":"Correspondence Analysis","title":"Correspondence Analysis","text":"20×20 Matrix{Float64}:\n  0.176253    -0.0454704   -0.0105812   …  -0.05        -0.0256362\n -0.0454704    0.23503     -0.0260535      -0.0208237    0.0135401\n -0.0105812   -0.0260535    0.11912         0.00985987   0.00639501\n -0.0147665    0.00195209   0.0284484       0.0414594    0.0085983\n -0.0378862   -0.00392637  -0.0291341       0.00908341   0.00904514\n  0.00940733  -0.0156465    0.00628911  …  -0.0234246   -0.00179829\n -0.0358464    0.0121606   -0.00625708     -0.0171513   -0.0126337\n  0.0296712   -0.0226316    0.0236612      -0.0227864   -0.0217639\n -0.00171182  -0.0132764   -0.0196894       0.00764449  -0.0221735\n  0.0318926   -0.028182     0.0293717      -0.021659     0.0107294\n -0.00807035  -0.0359453   -0.0402731   …   0.0198137   -0.00487048\n -0.0167785    0.0177558   -0.0352565      -0.00541133   0.00605225\n -0.0183492    0.0720551   -0.0108305      -0.0183123   -0.00224457\n  0.0050594   -0.0429869   -0.00914798     -0.0193381   -0.0168132\n  0.033175    -0.0381485   -0.0373476      -0.00668456  -0.00511196\n  0.0244796   -0.0114368   -0.0125286   …   0.0055519    0.00136159\n -0.0436804   -0.0298107    0.02781         0.0140449   -0.0221752\n -0.00116046  -0.0181548   -0.0138556      -0.0260911   -0.0443216\n -0.05        -0.0208237    0.00985987      0.108656     0.0155683\n -0.0256362    0.0135401    0.00639501      0.0155683    0.108252","category":"page"},{"location":"methods/CorrespondenceAnalysis/","page":"Correspondence Analysis","title":"Correspondence Analysis","text":"G * Dr * transpose(G)","category":"page"},{"location":"methods/CorrespondenceAnalysis/","page":"Correspondence Analysis","title":"Correspondence Analysis","text":"30×30 Matrix{Float64}:\n  0.0703593     0.0187961   -0.0211723   …  -0.0425959   -0.0156783\n  0.0187961     0.127854    -0.0139671      -0.0243274    0.0680213\n -0.0211723    -0.0139671    0.0734397       0.00732181   0.0124624\n -0.05         -0.05         0.0733391       0.130781    -0.0162191\n  0.0497339     0.0601621   -0.05            0.0096195   -0.05\n -0.0181222     0.0235135    0.0491405   …  -0.00177475   0.124752\n  0.00580183   -0.0439472   -0.00865425     -0.0299118   -0.0344922\n -0.0139402    -0.0239749    0.0259024       0.0213263   -0.0128525\n -0.05          0.00592816  -0.0150466       0.0462687   -0.0458599\n -0.0139797    -0.00873938  -0.0108794      -0.0273272   -0.0204895\n  ⋮                                      ⋱               \n  0.0139957    -0.0221852   -0.0120665      -0.05         0.0104504\n  0.0369838    -0.0221338   -0.0420271      -0.0450191   -0.05\n  0.000500339  -0.0406282    0.0179369      -0.0357769    0.0570096\n -0.0206885    -0.0168495    0.00873939      0.10958     -0.043624\n -0.0167013     0.00539142   0.0110833   …  -0.0209499    0.0405095\n -0.020262     -0.0338295    0.0495302       0.0427188   -0.0468177\n  0.00735394    0.06883     -0.0476658       0.0387278    0.0289702\n -0.0425959    -0.0243274    0.00732181      0.176513    -0.0477019\n -0.0156783     0.0680213    0.0124624      -0.0477019    0.264192","category":"page"},{"location":"methods/CorrespondenceAnalysis/#Create-Correspondence-Analysis-Function","page":"Correspondence Analysis","title":"Create Correspondence Analysis Function","text":"","category":"section"},{"location":"methods/CorrespondenceAnalysis/","page":"Correspondence Analysis","title":"Correspondence Analysis","text":"function correspondence_analysis(N::NamedMatrix)\n  \n  # A.1 Create the correspondence matrix\n  P = N / sum(N)\n\n  # A.2 Calculate column and row masses\n  r = vec(sum(P, dims = 2))\n  c = vec(sum(P, dims = 1))\n\n  # A.3 Diagonal matrices of row and column masses\n  Dr = Diagonal(r)\n  Dc = Diagonal(c)\n\n  # A.4 Calculate the matrix of standardized residuals\n  SR = Dr^(-1/2) * (P - r * transpose(c)) * Dc^(-1/2)\n\n  # A.5 Calculate the Singular Value Decomposition (SVD) of S\n  svd = LinearAlgebra.svd(SR)\n  U = svd.U\n  V = svd.V\n  S = svd.S\n  D = Diagonal(S)\n\n  # A.6 Standard coordinates Φ of rows\n  Φ_rownames = names(N)[1]\n  Φ_colnames = vec([\"Dim\"].*string.([1:1:size(N,1);]))\n  Φ = NamedArray(Dr^(-1/2) * U, names = (Φ_rownames, Φ_colnames), dimnames = (\"Plot\", \"Dimension\"))\n  \n  # A.7 Standard coordinates Γ of columns\n  Γ_rownames = names(N)[2]\n  Γ_colnames = vec([\"Dim\"].*string.([1:1:size(N,1);]))\n  Γ = NamedArray(Dc^(-1/2) * V, names = (Γ_rownames, Γ_colnames), dimnames = (\"Species\", \"Dimension\"))\n  \n  # A.8 Principal coordinates F of rows\n  # F = Φ * D\n  F = Dr^(-1/2) * U * D\n  \n  # A.9 Principal coordinates G of columns\n  # G = Γ * D\n  G = Dc^(-1/2) * V * D\n\n  # [1:end, 1:end .∉ [[20]]]\n\n  results = (sv = D, # Singular values\n             rownames = names(N)[1], # Row names\n             rowmass = r, # Row masses\n            #  rowdist = , # Row chi-square distances to centroid\n            #  rowinertia = , # Row inertias\n             rowcoord = Φ, # Row standard coordinates\n            #  rowsup = , # Indicies of row supplementary points\n             colnames = names(N)[2], # Column names\n             colmass = c, # Column masses\n            #  coldist = , # Column chi-square distances to centroid\n            #  colinertia = , # Column inertias\n             colcoord = Γ, # Column standard coordinates\n            #  colsup = , # Indices of column supplementary points\n            N = N # The frequency table\n            )\n\n  return results\n\nend","category":"page"},{"location":"methods/CorrespondenceAnalysis/","page":"Correspondence Analysis","title":"Correspondence Analysis","text":"correspondence_analysis (generic function with 1 method)","category":"page"},{"location":"methods/CorrespondenceAnalysis/#Test-Function","page":"Correspondence Analysis","title":"Test Function","text":"","category":"section"},{"location":"methods/CorrespondenceAnalysis/","page":"Correspondence Analysis","title":"Correspondence Analysis","text":"ca_results = correspondence_analysis(N)","category":"page"},{"location":"methods/CorrespondenceAnalysis/","page":"Correspondence Analysis","title":"Correspondence Analysis","text":"(sv = [0.6129739490525447 0.0 … 0.0 0.0; 0.0 0.5564212400123917 … 0.0 0.0; … ; 0.0 0.0 … 0.10275423676403479 0.0; 0.0 0.0 … 0.0 1.7806076093874553e-16], rownames = [\"SiteA-1\", \"SiteA-2\", \"SiteA-3\", \"SiteA-4\", \"SiteA-5\", \"SiteA-6\", \"SiteA-7\", \"SiteA-8\", \"SiteA-9\", \"SiteA-10\", \"SiteA-11\", \"SiteA-12\", \"SiteA-13\", \"SiteA-14\", \"SiteA-15\", \"SiteA-16\", \"SiteA-17\", \"SiteA-18\", \"SiteA-19\", \"SiteA-20\"], rowmass = [0.05, 0.05, 0.04999999999999999, 0.049999999999999996, 0.049999999999999996, 0.049999999999999975, 0.05, 0.049999999999999996, 0.04999999999999999, 0.05, 0.049999999999999996, 0.049999999999999996, 0.049999999999999996, 0.049999999999999975, 0.049999999999999996, 0.04999999999999999, 0.049999999999999996, 0.04999999999999998, 0.04999999999999998, 0.04999999999999999], rowcoord = [1.8166144123541197 -0.13849250719179576 … 0.8899688488193661 -0.9999999999999999; -2.2133481188635744 2.3301565201989045 … -0.028626295379941775 -1.0000000000000007; … ; -0.46758048803987456 -0.6646526282674122 … 0.6766050054032159 -0.9999999999999983; -0.540582877993106 -0.15747352141916915 … -0.18928550199583283 -0.9999999999999999], colnames = [\"Species1\", \"Species2\", \"Species3\", \"Species4\", \"Species5\", \"Species6\", \"Species7\", \"Species8\", \"Species9\", \"Species10\"  …  \"Species21\", \"Species22\", \"Species23\", \"Species24\", \"Species25\", \"Species26\", \"Species27\", \"Species28\", \"Species29\", \"Species30\"], colmass = [0.06242175930346598, 0.030336689421837634, 0.024417474841065736, 0.011236333558953641, 0.023256756434305484, 0.02740591986283429, 0.04329482947731683, 0.0418674696871211, 0.02205529997017692, 0.05209312097873284  …  0.025759260841475992, 0.05144583704123703, 0.009401856450938759, 0.024337135096116916, 0.03692637226439267, 0.040825754385220035, 0.02827244127586385, 0.017112629450118814, 0.028199086410775443, 0.01790800682139619], colcoord = [-0.017425518201538735 1.4347495282213645 … 0.33138731443973585 -1.7504124145267335; -0.6920677954506225 1.4627168584763466 … 0.4451950502466801 0.09381111444515973; … ; -1.204698348017798 -2.107741047756947 … -1.5191755409156609 -0.6440476860846754; 0.04326438705287024 0.9477720028495215 … -1.2658585618213798 -0.3000758730534765], N = [0.0 0.0 … 0.0 0.0; 0.16466200290071414 0.09366135428474028 … 0.0 0.0; … ; 0.10649256780454618 0.0 … 0.0 0.0; 0.0 0.0 … 0.014664730921840953 0.0])","category":"page"},{"location":"methods/CorrespondenceAnalysis/#Plot-Test-Results","page":"Correspondence Analysis","title":"Plot Test Results","text":"","category":"section"},{"location":"methods/CorrespondenceAnalysis/","page":"Correspondence Analysis","title":"Correspondence Analysis","text":"begin\n  plots_x = ca_results.rowcoord[:,\"Dim1\"]\n  plots_y = ca_results.rowcoord[:,\"Dim2\"]\n\n  species_x = ca_results.colcoord[:,\"Dim1\"]\n  species_y = ca_results.colcoord[:,\"Dim2\"]\n\n  # scatter(species_x, species_y, series_annotations = text.(ca_results.colnames, 8, :right, :bottom), framestyle=:origin, label = \"Species\")\n  # scatter!(plots_x, plots_y, series_annotations = text.(ca_results.rownames, 8, :right, :bottom), label = \"Plots\")\nend","category":"page"},{"location":"methods/CorrespondenceAnalysis/","page":"Correspondence Analysis","title":"Correspondence Analysis","text":"30-element Named Vector{Float64}\nSpecies   │ \n──────────┼──────────\nSpecies1  │   1.43475\nSpecies2  │   1.46272\nSpecies3  │  -1.06011\nSpecies4  │  -3.14307\nSpecies5  │   2.44785\nSpecies6  │   0.07299\nSpecies7  │  0.260525\nSpecies8  │ -0.880795\n⋮                   ⋮\nSpecies23 │  0.689419\nSpecies24 │ -0.241848\nSpecies25 │  -1.09768\nSpecies26 │ -0.380309\nSpecies27 │  -1.46692\nSpecies28 │     0.826\nSpecies29 │  -2.10774\nSpecies30 │  0.947772","category":"page"},{"location":"methods/CorrespondenceAnalysis/#R-vs-Julia-Dune-Data","page":"Correspondence Analysis","title":"R vs Julia Dune Data","text":"","category":"section"},{"location":"methods/CorrespondenceAnalysis/","page":"Correspondence Analysis","title":"Correspondence Analysis","text":"Let’s see how the R function ca::ca() compares to the Julia function correspondence_analysis() defined above.","category":"page"},{"location":"methods/CorrespondenceAnalysis/","page":"Correspondence Analysis","title":"Correspondence Analysis","text":"First load the dune dataset bundled in {vegan}.","category":"page"},{"location":"methods/CorrespondenceAnalysis/#Julia-2","page":"Correspondence Analysis","title":"Julia","text":"","category":"section"},{"location":"methods/CorrespondenceAnalysis/","page":"Correspondence Analysis","title":"Correspondence Analysis","text":"begin\n    dune_df = CSV.read(\"../data/dune.csv\", DataFrame, header = 1)\n    dune_na = NamedArray(Array(dune_df))\n    NamedArrays.setnames!(dune_na, names(dune_df), 2)\nend","category":"page"},{"location":"methods/CorrespondenceAnalysis/","page":"Correspondence Analysis","title":"Correspondence Analysis","text":"(OrderedCollections.OrderedDict{Any, Int64}(\"1\" => 1, \"2\" => 2, \"3\" => 3, \"4\" => 4, \"5\" => 5, \"6\" => 6, \"7\" => 7, \"8\" => 8, \"9\" => 9, \"10\" => 10…), OrderedCollections.OrderedDict{Any, Int64}(\"Achimill\" => 1, \"Agrostol\" => 2, \"Airaprae\" => 3, \"Alopgeni\" => 4, \"Anthodor\" => 5, \"Bellpere\" => 6, \"Bromhord\" => 7, \"Chenalbu\" => 8, \"Cirsarve\" => 9, \"Comapalu\" => 10…))","category":"page"},{"location":"methods/CorrespondenceAnalysis/#R-2","page":"Correspondence Analysis","title":"R","text":"","category":"section"},{"location":"methods/CorrespondenceAnalysis/","page":"Correspondence Analysis","title":"Correspondence Analysis","text":"dune <- as.matrix(read.csv(file = \"../data/dune.csv\"))","category":"page"},{"location":"methods/CorrespondenceAnalysis/#Run-CA-in-Julia-on-Dune-data","page":"Correspondence Analysis","title":"Run CA in Julia on Dune data","text":"","category":"section"},{"location":"methods/CorrespondenceAnalysis/","page":"Correspondence Analysis","title":"Correspondence Analysis","text":"dune_ca_julia = correspondence_analysis(dune_na)","category":"page"},{"location":"methods/CorrespondenceAnalysis/","page":"Correspondence Analysis","title":"Correspondence Analysis","text":"(sv = [0.7321237072731497 0.0 … 0.0 0.0; 0.0 0.6325690627910964 … 0.0 0.0; … ; 0.0 0.0 … 0.05896537573383853 0.0; 0.0 0.0 … 0.0 7.091790502929597e-17], rownames = [\"1\", \"2\", \"3\", \"4\", \"5\", \"6\", \"7\", \"8\", \"9\", \"10\", \"11\", \"12\", \"13\", \"14\", \"15\", \"16\", \"17\", \"18\", \"19\", \"20\"], rowmass = [0.02627737226277372, 0.06131386861313868, 0.05839416058394161, 0.0656934306569343, 0.06277372262773723, 0.07007299270072993, 0.05839416058394161, 0.05839416058394161, 0.06131386861313869, 0.06277372262773723, 0.04671532846715329, 0.051094890510948905, 0.04817518248175183, 0.03503649635036496, 0.03357664233576642, 0.04817518248175183, 0.0218978102189781, 0.03941605839416058, 0.04525547445255475, 0.04525547445255475], rowcoord = [0.8116737226994164 1.0826713631197626 … 2.417299499470586 0.9999999999999976; 0.6326772260449806 0.6958357017624843 … -0.049159624022002205 0.9999999999999993; … ; 0.6902687683328907 -3.2642026272615623 … 0.014843350243563693 1.0; -1.9443804612344018 -1.0688808878703615 … -1.087127732821526 1.0000000000000004], colnames = [\"Achimill\", \"Agrostol\", \"Airaprae\", \"Alopgeni\", \"Anthodor\", \"Bellpere\", \"Bromhord\", \"Chenalbu\", \"Cirsarve\", \"Comapalu\"  …  \"Ranuflam\", \"Rumeacet\", \"Sagiproc\", \"Salirepe\", \"Scorautu\", \"Trifprat\", \"Trifrepe\", \"Vicilath\", \"Bracruta\", \"Callcusp\"], colmass = [0.02335766423357664, 0.07007299270072993, 0.0072992700729927005, 0.05255474452554745, 0.030656934306569343, 0.01897810218978102, 0.021897810218978103, 0.00145985401459854, 0.00291970802919708, 0.00583941605839416  …  0.020437956204379562, 0.026277372262773723, 0.029197080291970802, 0.016058394160583942, 0.07883211678832117, 0.01313868613138686, 0.06861313868613139, 0.00583941605839416, 0.07153284671532847, 0.014598540145985401], colcoord = [1.2410388912758308 -0.13374974813501736 … 1.0922556626083908 0.5378610945054166; -1.275443784762892 0.3264688587581394 … -1.3054088243241777 0.6482522649395861; … ; -0.2488978439865396 -0.4185696756019523 … -0.01770675187655213 -0.49012289845882706; -2.6661966956330643 -0.8970175654454415 … -0.22298366681774884 -0.2585309105382417], N = [1 0 … 0 0; 3 0 … 0 0; … ; 0 0 … 3 0; 0 5 … 4 3])","category":"page"},{"location":"methods/CorrespondenceAnalysis/#Run-CA-in-R-using-Dune-data","page":"Correspondence Analysis","title":"Run CA in R using Dune data","text":"","category":"section"},{"location":"methods/CorrespondenceAnalysis/","page":"Correspondence Analysis","title":"Correspondence Analysis","text":"dune_ca_r <- ca::ca(dune)","category":"page"},{"location":"methods/CorrespondenceAnalysis/","page":"Correspondence Analysis","title":"Correspondence Analysis","text":"dune_ca_coords_r <- ca::cacoord(dune_ca_r)\ndune_ca_r_rowcoord <- dune_ca_coords_r$rows\ndune_ca_r_colcoord <- dune_ca_coords_r$columns","category":"page"},{"location":"methods/CorrespondenceAnalysis/#Check-equality-of-R-and-Julia-CA-results","page":"Correspondence Analysis","title":"Check equality of R and Julia CA results","text":"","category":"section"},{"location":"methods/CorrespondenceAnalysis/","page":"Correspondence Analysis","title":"Correspondence Analysis","text":"Check whether the standard row (plot) and column (species) coordinates produced by the Julia function correspondence_analaysis() the R function ca::ca() are identical.","category":"page"},{"location":"methods/CorrespondenceAnalysis/","page":"Correspondence Analysis","title":"Correspondence Analysis","text":"First retrieve the Julia results in R.","category":"page"},{"location":"methods/CorrespondenceAnalysis/","page":"Correspondence Analysis","title":"Correspondence Analysis","text":"dune_ca_julia <- JuliaCall::julia_eval(\"dune_ca_julia\")\ndune_ca_julia_rowcoord <- dune_ca_julia$rowcoord\ndune_ca_julia_colcoord <- dune_ca_julia$colcoord","category":"page"},{"location":"methods/CorrespondenceAnalysis/","page":"Correspondence Analysis","title":"Correspondence Analysis","text":"Then check for equivalence. Note that there are two differences in R and Julia data structure:","category":"page"},{"location":"methods/CorrespondenceAnalysis/","page":"Correspondence Analysis","title":"Correspondence Analysis","text":"Row and column names are stripped from the Julia results when  calling JuliaCall::julia_eval(\"dune_ca_julia\"), so the R results  are also unnamed.\nThe Julia results contain an additional dimension, populated with  1.0 values.","category":"page"},{"location":"methods/CorrespondenceAnalysis/","page":"Correspondence Analysis","title":"Correspondence Analysis","text":"These differences are corrected below whilst checking for equivalence.","category":"page"},{"location":"methods/CorrespondenceAnalysis/","page":"Correspondence Analysis","title":"Correspondence Analysis","text":"The R function all.equal is used rather than identical as the Julia implementation returns results with higher precision.","category":"page"},{"location":"methods/CorrespondenceAnalysis/","page":"Correspondence Analysis","title":"Correspondence Analysis","text":"plots_allequal <- all.equal(dune_ca_julia_rowcoord[,-20], unname(dune_ca_r_rowcoord))\nspecies_allequal <- all.equal(dune_ca_julia_colcoord[,-20], unname(dune_ca_r_colcoord))\nisTRUE(all(plots_allequal, species_allequal))","category":"page"},{"location":"methods/CorrespondenceAnalysis/","page":"Correspondence Analysis","title":"Correspondence Analysis","text":"[1] TRUE","category":"page"},{"location":"methods/CorrespondenceAnalysis/","page":"Correspondence Analysis","title":"Correspondence Analysis","text":"Let’s view the first two dimensions of the Julia and R results side-by-side.","category":"page"},{"location":"methods/CorrespondenceAnalysis/#Visualise-standard-coordinates","page":"Correspondence Analysis","title":"Visualise standard coordinates","text":"","category":"section"},{"location":"methods/CorrespondenceAnalysis/","page":"Correspondence Analysis","title":"Correspondence Analysis","text":"(Image: )","category":"page"},{"location":"methods/CorrespondenceAnalysis/#Benchmark-Functions","page":"Correspondence Analysis","title":"Benchmark Functions","text":"","category":"section"},{"location":"methods/CorrespondenceAnalysis/","page":"Correspondence Analysis","title":"Correspondence Analysis","text":"@benchmark correspondence_analysis(dune_na)","category":"page"},{"location":"methods/CorrespondenceAnalysis/","page":"Correspondence Analysis","title":"Correspondence Analysis","text":"BenchmarkTools.Trial: 10000 samples with 1 evaluation.\n Range (min … max):  105.176 μs …  2.254 ms  ┊ GC (min … max): 0.00% … 86.83%\n Time  (median):     109.984 μs              ┊ GC (median):    0.00%\n Time  (mean ± σ):   114.870 μs ± 77.805 μs  ┊ GC (mean ± σ):  2.70% ±  3.79%\n\n      ▆█▁                                                       \n  ▂▅▇▆███▄▃▃▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▁▂▂▂▂▂▂▂▂▂▂▂▂▂ ▃\n  105 μs          Histogram: frequency by time          162 μs <\n\n Memory estimate: 88.81 KiB, allocs estimate: 316.","category":"page"},{"location":"methods/CorrespondenceAnalysis/","page":"Correspondence Analysis","title":"Correspondence Analysis","text":"microbenchmark::microbenchmark(ca::ca(dune))","category":"page"},{"location":"methods/CorrespondenceAnalysis/","page":"Correspondence Analysis","title":"Correspondence Analysis","text":"Unit: microseconds\n         expr    min       lq     mean   median       uq     max neval\n ca::ca(dune) 440.68 446.6775 453.7794 450.4425 454.9535 574.284   100","category":"page"},{"location":"methods/CorrespondenceAnalysis/#References","page":"Correspondence Analysis","title":"References","text":"","category":"section"},{"location":"methods/CorrespondenceAnalysis/","page":"Correspondence Analysis","title":"Correspondence Analysis","text":"Greenacre, Michael. 2017. Correspondence Analysis in Practice, Third Edition. CRC Press.","category":"page"},{"location":"methods/CorrespondenceAnalysis/","page":"Correspondence Analysis","title":"Correspondence Analysis","text":"Nenadic, Oleg, and Michael Greenacre. 2007. “Correspondence Analysis in R, with Two- and <span class=\"nocase\">Three-dimensional Graphics</span>: The Ca Package.” Journal of Statistical Software 20 (February): 1–13. https://doi.org/10.18637/jss.v020.i03.","category":"page"},{"location":"reference/","page":"Reference","title":"Reference","text":"CurrentModule = EcoVeg","category":"page"},{"location":"reference/#Reference","page":"Reference","title":"Reference","text":"","category":"section"},{"location":"reference/#Content","page":"Reference","title":"Content","text":"","category":"section"},{"location":"reference/","page":"Reference","title":"Reference","text":"Pages = [\"_reference.md\"]","category":"page"},{"location":"reference/#Index","page":"Reference","title":"Index","text":"","category":"section"},{"location":"reference/","page":"Reference","title":"Reference","text":"","category":"page"},{"location":"reference/#Public-Interface","page":"Reference","title":"Public Interface","text":"","category":"section"},{"location":"reference/","page":"Reference","title":"Reference","text":"Modules = [\n    EcoVeg,\n]\nPrivate = false","category":"page"},{"location":"reference/#EcoVeg.binary_similarity","page":"Reference","title":"EcoVeg.binary_similarity","text":"binary_similarity(x::NamedArray, eq::AbstractString)\n\nCreate a personalised greeting for EcoVeg using a name.\n\n...\n\nArguments\n\nx::NamedArray: A site by species \neq::AbstractString: A representing an equation using the terms a, b, and c. The Jaccard similarity by default. \"(a ./ (a .+ b .+ c)) + I\".\n\n...\n\nExamples\n\nx = generatetestarray(rown = 10, coln = 10)\njulia>binarysimilarity(x, \"(a ./ (a .+ b .+ c)) + I\")\n\n\n\n\n\n","category":"function"},{"location":"reference/#EcoVeg.generate_test_array-Tuple{}","page":"Reference","title":"EcoVeg.generate_test_array","text":"greet_your_package_name(name)\n\nCreate a rown by coln NamedArray object containing random values.\n\n...\n\nArguments\n\nrown::Int64: The number of rows in the array.\ncoln::Int64: The number of columns in the array.\nmeancoloccs::Int64: The mean number of non-zero elements in the array.\nrowprefix::String: The prefix to the row number. \"Releve\" by default.\ncolprefix::String: The prefix to the column number. \"Species\" by default.\nrowdim::String: The row dimension name. \"Releve\" by default.\ncoldim::String: The column dimension name. \"Species\" by default.\n\n...\n\nExamples\n\njulia>generate_test_array(rown = 10, coln = 10, meancoloccs = 5, rowprefix = \"Releve\", colprefix = \"Species\")\n\n\n\n\n\n","category":"method"},{"location":"reference/#EcoVeg.nzfunc-Tuple{Function, NamedArrays.NamedArray}","page":"Reference","title":"EcoVeg.nzfunc","text":"Draws heavily from the function outlines here: https://discourse.julialang.org/t/nanmean-options/4994/17\n\n\n\n\n\n","category":"method"},{"location":"reference/#Internal-functions","page":"Reference","title":"Internal functions","text":"","category":"section"},{"location":"reference/","page":"Reference","title":"Reference","text":"Modules = [\n    EcoVeg,\n]\nPublic = false","category":"page"},{"location":"","page":"Home","title":"Home","text":"CurrentModule = EcoVeg","category":"page"},{"location":"","page":"Home","title":"Home","text":"Documentation for EcoVeg.jl.","category":"page"},{"location":"#EcoVeg","page":"Home","title":"EcoVeg","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"Tools for vegetation science.","category":"page"},{"location":"#Background","page":"Home","title":"Background","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"EcoVeg.jl contains tools for vegetation science using the Julia programming language [@bezanson2017].","category":"page"},{"location":"","page":"Home","title":"Home","text":"Solves two language problem [@roesch2023]","category":"page"},{"location":"","page":"Home","title":"Home","text":"Aims to collate functionality found in JUICE, vegan, MAVIS into a single location with a user-friendly API and transparent methodologies. With the aim of assisting in the creation of reproducible analysis [@sperandii2024].","category":"page"},{"location":"","page":"Home","title":"Home","text":"Nomenclature follows @theurillat2021.","category":"page"},{"location":"#Installation","page":"Home","title":"Installation","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"To install the latest stable release of EcoVeg:","category":"page"},{"location":"","page":"Home","title":"Home","text":"using Pkg\nPkg.add(\"EcoVeg\")","category":"page"},{"location":"","page":"Home","title":"Home","text":"To install the development version of Ecoveg:","category":"page"},{"location":"","page":"Home","title":"Home","text":"using Pkg\nPkg.add(url=\"https://github.com/ZekeMarshall/EcoVeg.jl\", rev = \"develop\")","category":"page"},{"location":"#Usage-Example","page":"Home","title":"Usage Example","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"To demonstrate…","category":"page"},{"location":"","page":"Home","title":"Home","text":"First we begin with generating two example plot by species NamedArrays.NamedMatrix object using the function EcoVeg.generate_test_array as test data.","category":"page"},{"location":"","page":"Home","title":"Home","text":"x = generate_test_array(rown = 20, coln = 30, meancoloccs = 10, rowprefix = \"SiteA-\", colprefix = \"Species\")","category":"page"},{"location":"","page":"Home","title":"Home","text":"20×30 Named Matrix{Float64}\nReleve ╲ Species │   Species1    Species2  …   Species29   Species30\n─────────────────┼──────────────────────────────────────────────────\nSiteA-1          │        0.0         0.0  …         0.0         0.0\nSiteA-2          │        0.0         0.0            0.0   0.0742907\nSiteA-3          │  0.0704807   0.0369201            0.0         0.0\nSiteA-4          │        0.0         0.0            0.0         0.0\nSiteA-5          │        0.0         0.0       0.065016    0.114198\nSiteA-6          │        0.0         0.0     0.00555444         0.0\nSiteA-7          │        0.0   0.0550128            0.0   0.0563497\nSiteA-8          │        0.0         0.0            0.0   0.0475957\nSiteA-9          │        0.0   0.0139922            0.0         0.0\nSiteA-10         │   0.048195    0.058435      0.0296611         0.0\nSiteA-11         │        0.0         0.0            0.0         0.0\nSiteA-12         │        0.0         0.0            0.0   0.0508891\nSiteA-13         │        0.0   0.0798633            0.0    0.131321\nSiteA-14         │        0.0         0.0            0.0    0.183577\nSiteA-15         │        0.0         0.0       0.140305   0.0119757\nSiteA-16         │  0.0752609    0.067526      0.0843943         0.0\nSiteA-17         │  0.0864513         0.0            0.0         0.0\nSiteA-18         │ 0.00308486         0.0            0.0    0.147017\nSiteA-19         │        0.0    0.133836            0.0         0.0\nSiteA-20         │        0.0         0.0  …         0.0         0.0","category":"page"},{"location":"#Classification","page":"Home","title":"Classification","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"Let’s artifically create some clusters for now…","category":"page"},{"location":"","page":"Home","title":"Home","text":"cluster1 = [\"SiteA-1\", \"SiteA-2\", \"SiteA-4\", \"SiteA-7\", \"SiteA-10\", \"SiteA-11\", \"SiteA-12\", \"SiteA-15\", \"SiteA-18\", \"SiteA-19\"]\ncluster2 = [\"SiteA-3\", \"SiteA-5\", \"SiteA-6\", \"SiteA-8\", \"SiteA-9\", \"SiteA-13\", \"SiteA-14\", \"SiteA-16\", \"SiteA-17\", \"SiteA-20\"]","category":"page"},{"location":"","page":"Home","title":"Home","text":"10-element Vector{String}:\n \"SiteA-3\"\n \"SiteA-5\"\n \"SiteA-6\"\n \"SiteA-8\"\n \"SiteA-9\"\n \"SiteA-13\"\n \"SiteA-14\"\n \"SiteA-16\"\n \"SiteA-17\"\n \"SiteA-20\"","category":"page"},{"location":"#Creation-of-Syntopic-Tables","page":"Home","title":"Creation of Syntopic Tables","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"Once the plots have been grouped into clusters, we can proceed to summarise their composition via the creation of SyntopicTable objects.","category":"page"},{"location":"","page":"Home","title":"Home","text":"syn_1 = EcoVeg.compose_syntopic_table_object(\"Syn1\", x[cluster1,:])\nsyn_2 = EcoVeg.compose_syntopic_table_object(\"Syn2\", x[cluster2,:])\nprint_summary_syntopic_table(syn_2)","category":"page"},{"location":"","page":"Home","title":"Home","text":"Community Name: Syn2\nReleves: n = 10\nSpecies: n = 30\n╭───────────┬───────────────────┬─────────────────╮\n│   Species │ RelativeFrequency │       Abundance │\n├───────────┼───────────────────┼─────────────────┤\n│  Species8 │          0.116874 │ 0.1 (0.1 - 0.3) │\n│ Species15 │         0.0623607 │ 0.1 (0.0 - 0.2) │\n│ Species19 │         0.0584902 │ 0.1 (0.1 - 0.2) │\n│ Species11 │         0.0523788 │ 0.1 (0.1 - 0.2) │\n│ Species28 │         0.0513153 │ 0.2 (0.0 - 0.2) │\n│ Species26 │         0.0478617 │ 0.1 (0.1 - 0.2) │\n│ Species30 │         0.0476692 │ 0.1 (0.0 - 0.2) │\n│ Species14 │         0.0445658 │ 0.1 (0.0 - 0.2) │\n│ Species18 │         0.0403507 │ 0.1 (0.1 - 0.3) │\n│ Species21 │         0.0364615 │ 0.1 (0.1 - 0.2) │\n│ Species12 │         0.0343615 │ 0.1 (0.0 - 0.2) │\n│ Species17 │         0.0325703 │ 0.1 (0.0 - 0.1) │\n│ Species16 │         0.0315202 │ 0.1 (0.0 - 0.1) │\n│ Species23 │         0.0300857 │ 0.1 (0.0 - 0.1) │\n│  Species4 │         0.0298907 │ 0.1 (0.1 - 0.2) │\n│ Species13 │         0.0284227 │ 0.1 (0.0 - 0.1) │\n│  Species5 │         0.0275004 │ 0.1 (0.0 - 0.1) │\n│ Species22 │         0.0267309 │ 0.1 (0.0 - 0.1) │\n│  Species1 │         0.0232193 │ 0.1 (0.1 - 0.1) │\n│ Species27 │         0.0223382 │ 0.1 (0.1 - 0.1) │\n│  Species2 │         0.0198302 │ 0.1 (0.0 - 0.1) │\n│  Species7 │         0.0198162 │ 0.1 (0.1 - 0.1) │\n│  Species6 │          0.017789 │ 0.1 (0.1 - 0.1) │\n│ Species20 │         0.0175654 │ 0.1 (0.1 - 0.1) │\n│ Species25 │         0.0160109 │ 0.1 (0.0 - 0.1) │\n│  Species9 │         0.0156659 │ 0.1 (0.0 - 0.1) │\n│ Species29 │         0.0154965 │ 0.1 (0.0 - 0.1) │\n│ Species10 │         0.0115231 │ 0.1 (0.0 - 0.1) │\n│  Species3 │         0.0113954 │ 0.1 (0.0 - 0.1) │\n│ Species24 │        0.00993922 │ 0.0 (0.0 - 0.1) │\n╰───────────┴───────────────────┴─────────────────╯","category":"page"},{"location":"#Identification-of-High-Fidelity-Species","page":"Home","title":"Identification of High-Fidelity Species","text":"","category":"section"},{"location":"#Generation-of-Pseudo-Releves","page":"Home","title":"Generation of Pseudo-Releves","text":"","category":"section"},{"location":"#Assignment-of-Releves-to-Vegetation-Classes","page":"Home","title":"Assignment of Releves to Vegetation Classes","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"Let’s generate a second example matrix, consisting of sample 5 releves, against which we want to calculate the similarity.","category":"page"},{"location":"","page":"Home","title":"Home","text":"y = generate_test_array(rown = 5, coln = 30, meancoloccs = 10, rowprefix = \"SiteB-\", colprefix = \"Species\")","category":"page"},{"location":"","page":"Home","title":"Home","text":"5×30 Named Matrix{Float64}\nReleve ╲ Species │    Species1     Species2  …    Species29    Species30\n─────────────────┼──────────────────────────────────────────────────────\nSiteB-1          │         0.0     0.267636  …          0.0          0.0\nSiteB-2          │    0.149368    0.0515994             0.0     0.135862\nSiteB-3          │         0.0    0.0404588             0.0     0.108958\nSiteB-4          │         0.0          0.0        0.012553    0.0916869\nSiteB-5          │         0.0          0.0  …          0.0          0.0","category":"page"},{"location":"","page":"Home","title":"Home","text":"Three methods will be demonstrated.","category":"page"},{"location":"#Jaccard-Similarity","page":"Home","title":"Jaccard Similarity","text":"","category":"section"},{"location":"#Czekanowski-Index","page":"Home","title":"Czekanowski Index","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"First, let’s compose a syntopic table object from the “y” sample data and extract the syntopic tables in matrix format.","category":"page"},{"location":"","page":"Home","title":"Home","text":"syn_y = EcoVeg.compose_syntopic_table_object(\"Sample\", y)\nsyn_y_mat = extract_syntopic_matrix(syn_y)\nsyn_1_mat = extract_syntopic_matrix(syn_1)\nsyn_2_mat = extract_syntopic_matrix(syn_2)","category":"page"},{"location":"","page":"Home","title":"Home","text":"1×30 Named Matrix{Float64}\nA ╲ B │   Species8   Species15  …    Species3   Species24\n──────┼──────────────────────────────────────────────────\nSyn2  │   0.116874   0.0623607  …   0.0113954  0.00993922","category":"page"},{"location":"","page":"Home","title":"Home","text":"Now we have three matrices, containg the relative frequencies of each species present in the sample releves which constitute the phytocoenosis’. However, each of the phytocoenosis is composed of a different set of species, in Julia we need a helper function to ensure all columns are present in each of the matrices before joining.","category":"page"},{"location":"","page":"Home","title":"Home","text":"# align_array_columns(syn_y_mat, syn_2_mat)\n# align_array_columns(syn_y_mat, syn_1_mat)","category":"page"},{"location":"#Multivariate-Analysis","page":"Home","title":"Multivariate Analysis","text":"","category":"section"},{"location":"#Ecological-Trajectory-Analysis","page":"Home","title":"Ecological Trajectory Analysis","text":"","category":"section"},{"location":"#External-Resources","page":"Home","title":"External Resources","text":"","category":"section"},{"location":"#Implemented-Methodologies","page":"Home","title":"Implemented Methodologies","text":"","category":"section"},{"location":"#Contribute","page":"Home","title":"Contribute","text":"","category":"section"},{"location":"#Acknowledgements","page":"Home","title":"Acknowledgements","text":"","category":"section"},{"location":"#References","page":"Home","title":"References","text":"","category":"section"}]
}

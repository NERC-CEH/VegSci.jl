var documenterSearchIndex = {"docs":
[{"location":"methods/CorrespondenceAnalysis/#Correspondence-Analysis","page":"Correspondence Analysis","title":"Correspondence Analysis","text":"","category":"section"},{"location":"methods/CorrespondenceAnalysis/#Outline","page":"Correspondence Analysis","title":"Outline","text":"","category":"section"},{"location":"methods/CorrespondenceAnalysis/","page":"Correspondence Analysis","title":"Correspondence Analysis","text":"This page details how to perform correspondence analysis in Julia following the computational algorithm outlined in appendix A of Greenacre (2017) and implemented in the R package ca (Nenadic and Greenacre 2007).","category":"page"},{"location":"methods/CorrespondenceAnalysis/","page":"Correspondence Analysis","title":"Correspondence Analysis","text":"The Julia package MultivariateStats.jl does not currently contain an implementation of correspondence analysis.","category":"page"},{"location":"methods/CorrespondenceAnalysis/#Import-Required-Packages","page":"Correspondence Analysis","title":"Import Required Packages","text":"","category":"section"},{"location":"methods/CorrespondenceAnalysis/","page":"Correspondence Analysis","title":"Correspondence Analysis","text":"using VegSci\nusing NamedArrays\nusing LinearAlgebra\nusing CSV\nusing BenchmarkTools\nusing DataFrames\nusing Plots","category":"page"},{"location":"methods/CorrespondenceAnalysis/#Create-example-data","page":"Correspondence Analysis","title":"Create example data","text":"","category":"section"},{"location":"methods/CorrespondenceAnalysis/","page":"Correspondence Analysis","title":"Correspondence Analysis","text":"Create example data in the form of a releve by species named matrix, N.","category":"page"},{"location":"methods/CorrespondenceAnalysis/","page":"Correspondence Analysis","title":"Correspondence Analysis","text":"N = VegSci.generate_test_array(rown = 20, coln = 30, meancoloccs = 10, rowprefix = \"SiteA-\", colprefix = \"Species\")","category":"page"},{"location":"methods/CorrespondenceAnalysis/","page":"Correspondence Analysis","title":"Correspondence Analysis","text":"20×30 Named Matrix{Float64}\nReleve ╲ Species │    Species1     Species2  …    Species29    Species30\n─────────────────┼──────────────────────────────────────────────────────\nSiteA-1          │         0.0    0.0194353  …          0.0          0.0\nSiteA-2          │         0.0          0.0       0.0696649          0.0\nSiteA-3          │         0.0          0.0             0.0          0.0\nSiteA-4          │ 0.000427213     0.134477       0.0178963          0.0\nSiteA-5          │         0.0          0.0             0.0     0.148943\nSiteA-6          │         0.0          0.0      0.00461977          0.0\nSiteA-7          │         0.0          0.0        0.143256          0.0\nSiteA-8          │         0.0     0.195227             0.0          0.0\nSiteA-9          │         0.0          0.0             0.0          0.0\nSiteA-10         │         0.0     0.058075       0.0899067     0.035945\nSiteA-11         │         0.0          0.0        0.106392          0.0\nSiteA-12         │   0.0901935          0.0             0.0    0.0314749\nSiteA-13         │         0.0     0.142555             0.0    0.0429764\nSiteA-14         │         0.0     0.053224       0.0811444          0.0\nSiteA-15         │         0.0          0.0        0.227249          0.0\nSiteA-16         │    0.124641    0.0667531        0.117698     0.174523\nSiteA-17         │         0.0          0.0             0.0          0.0\nSiteA-18         │  0.00510619          0.0             0.0      0.13201\nSiteA-19         │         0.0          0.0       0.0552819   8.90951e-5\nSiteA-20         │   0.0720213    0.0320998  …          0.0    0.0534477","category":"page"},{"location":"methods/CorrespondenceAnalysis/#A.1-Create-the-correspondence-matrix","page":"Correspondence Analysis","title":"A.1 Create the correspondence matrix","text":"","category":"section"},{"location":"methods/CorrespondenceAnalysis/","page":"Correspondence Analysis","title":"Correspondence Analysis","text":"Calculate the correspondence matrix P following.","category":"page"},{"location":"methods/CorrespondenceAnalysis/","page":"Correspondence Analysis","title":"Correspondence Analysis","text":"P = frac1nN","category":"page"},{"location":"methods/CorrespondenceAnalysis/","page":"Correspondence Analysis","title":"Correspondence Analysis","text":"begin\n  n = sum(N)\n  P = N / n\nend","category":"page"},{"location":"methods/CorrespondenceAnalysis/","page":"Correspondence Analysis","title":"Correspondence Analysis","text":"20×30 Named Matrix{Float64}\nReleve ╲ Species │    Species1     Species2  …    Species29    Species30\n─────────────────┼──────────────────────────────────────────────────────\nSiteA-1          │         0.0  0.000971766  …          0.0          0.0\nSiteA-2          │         0.0          0.0      0.00348324          0.0\nSiteA-3          │         0.0          0.0             0.0          0.0\nSiteA-4          │  2.13607e-5   0.00672387     0.000894816          0.0\nSiteA-5          │         0.0          0.0             0.0   0.00744713\nSiteA-6          │         0.0          0.0     0.000230988          0.0\nSiteA-7          │         0.0          0.0      0.00716281          0.0\nSiteA-8          │         0.0   0.00976134             0.0          0.0\nSiteA-9          │         0.0          0.0             0.0          0.0\nSiteA-10         │         0.0   0.00290375      0.00449534   0.00179725\nSiteA-11         │         0.0          0.0      0.00531959          0.0\nSiteA-12         │  0.00450967          0.0             0.0   0.00157374\nSiteA-13         │         0.0   0.00712775             0.0   0.00214882\nSiteA-14         │         0.0    0.0026612      0.00405722          0.0\nSiteA-15         │         0.0          0.0       0.0113625          0.0\nSiteA-16         │  0.00623204   0.00333766      0.00588489   0.00872613\nSiteA-17         │         0.0          0.0             0.0          0.0\nSiteA-18         │  0.00025531          0.0             0.0   0.00660048\nSiteA-19         │         0.0          0.0       0.0027641   4.45475e-6\nSiteA-20         │  0.00360107   0.00160499  …          0.0   0.00267238","category":"page"},{"location":"methods/CorrespondenceAnalysis/#A.2-Calculate-column-and-row-masses","page":"Correspondence Analysis","title":"A.2 Calculate column and row masses","text":"","category":"section"},{"location":"methods/CorrespondenceAnalysis/","page":"Correspondence Analysis","title":"Correspondence Analysis","text":"Calculate the row and and column masses.","category":"page"},{"location":"methods/CorrespondenceAnalysis/","page":"Correspondence Analysis","title":"Correspondence Analysis","text":"r = P1 space space\nr_i = sum^J_j = 1 P_ij","category":"page"},{"location":"methods/CorrespondenceAnalysis/","page":"Correspondence Analysis","title":"Correspondence Analysis","text":"c = P^t1 space space\nc_j = sum^I_i = 1 P_ij","category":"page"},{"location":"methods/CorrespondenceAnalysis/","page":"Correspondence Analysis","title":"Correspondence Analysis","text":"r = vec(sum(P, dims = 2))","category":"page"},{"location":"methods/CorrespondenceAnalysis/","page":"Correspondence Analysis","title":"Correspondence Analysis","text":"20-element Vector{Float64}:\n 0.04999999999999999\n 0.05\n 0.049999999999999996\n 0.05\n 0.05\n 0.05000000000000001\n 0.049999999999999996\n 0.05000000000000002\n 0.049999999999999996\n 0.049999999999999996\n 0.05\n 0.05\n 0.04999999999999999\n 0.05\n 0.05\n 0.049999999999999996\n 0.049999999999999996\n 0.05000000000000001\n 0.05\n 0.05000000000000001","category":"page"},{"location":"methods/CorrespondenceAnalysis/","page":"Correspondence Analysis","title":"Correspondence Analysis","text":"c = vec(sum(P, dims = 1))","category":"page"},{"location":"methods/CorrespondenceAnalysis/","page":"Correspondence Analysis","title":"Correspondence Analysis","text":"30-element Vector{Float64}:\n 0.014619445973046706\n 0.03509231182945023\n 0.03589283669337291\n 0.029367840998973965\n 0.04947051366778396\n 0.06064577028960117\n 0.04090819345813372\n 0.04564169444902769\n 0.02373947255221797\n 0.021093922253387326\n 0.020449717016982328\n 0.03207210004060173\n 0.03702455282540353\n ⋮\n 0.022111797383714542\n 0.03073095440896969\n 0.037631473465615455\n 0.03458500369347802\n 0.034051447448272584\n 0.03175179212980403\n 0.04626555592464588\n 0.017683122018486937\n 0.05163712647655302\n 0.02333155190680658\n 0.04565546279942191\n 0.030970392169786434","category":"page"},{"location":"methods/CorrespondenceAnalysis/#A.3-Diagonal-matrices-of-row-and-column-masses","page":"Correspondence Analysis","title":"A.3 Diagonal matrices of row and column masses","text":"","category":"section"},{"location":"methods/CorrespondenceAnalysis/","page":"Correspondence Analysis","title":"Correspondence Analysis","text":"Dr = Diagonal(r)","category":"page"},{"location":"methods/CorrespondenceAnalysis/","page":"Correspondence Analysis","title":"Correspondence Analysis","text":"20×20 Diagonal{Float64, Vector{Float64}}:\n 0.05   ⋅     ⋅     ⋅     ⋅     ⋅    …   ⋅     ⋅     ⋅     ⋅     ⋅     ⋅ \n  ⋅    0.05   ⋅     ⋅     ⋅     ⋅        ⋅     ⋅     ⋅     ⋅     ⋅     ⋅ \n  ⋅     ⋅    0.05   ⋅     ⋅     ⋅        ⋅     ⋅     ⋅     ⋅     ⋅     ⋅ \n  ⋅     ⋅     ⋅    0.05   ⋅     ⋅        ⋅     ⋅     ⋅     ⋅     ⋅     ⋅ \n  ⋅     ⋅     ⋅     ⋅    0.05   ⋅        ⋅     ⋅     ⋅     ⋅     ⋅     ⋅ \n  ⋅     ⋅     ⋅     ⋅     ⋅    0.05  …   ⋅     ⋅     ⋅     ⋅     ⋅     ⋅ \n  ⋅     ⋅     ⋅     ⋅     ⋅     ⋅        ⋅     ⋅     ⋅     ⋅     ⋅     ⋅ \n  ⋅     ⋅     ⋅     ⋅     ⋅     ⋅        ⋅     ⋅     ⋅     ⋅     ⋅     ⋅ \n  ⋅     ⋅     ⋅     ⋅     ⋅     ⋅        ⋅     ⋅     ⋅     ⋅     ⋅     ⋅ \n  ⋅     ⋅     ⋅     ⋅     ⋅     ⋅        ⋅     ⋅     ⋅     ⋅     ⋅     ⋅ \n  ⋅     ⋅     ⋅     ⋅     ⋅     ⋅    …   ⋅     ⋅     ⋅     ⋅     ⋅     ⋅ \n  ⋅     ⋅     ⋅     ⋅     ⋅     ⋅        ⋅     ⋅     ⋅     ⋅     ⋅     ⋅ \n  ⋅     ⋅     ⋅     ⋅     ⋅     ⋅        ⋅     ⋅     ⋅     ⋅     ⋅     ⋅ \n  ⋅     ⋅     ⋅     ⋅     ⋅     ⋅        ⋅     ⋅     ⋅     ⋅     ⋅     ⋅ \n  ⋅     ⋅     ⋅     ⋅     ⋅     ⋅       0.05   ⋅     ⋅     ⋅     ⋅     ⋅ \n  ⋅     ⋅     ⋅     ⋅     ⋅     ⋅    …   ⋅    0.05   ⋅     ⋅     ⋅     ⋅ \n  ⋅     ⋅     ⋅     ⋅     ⋅     ⋅        ⋅     ⋅    0.05   ⋅     ⋅     ⋅ \n  ⋅     ⋅     ⋅     ⋅     ⋅     ⋅        ⋅     ⋅     ⋅    0.05   ⋅     ⋅ \n  ⋅     ⋅     ⋅     ⋅     ⋅     ⋅        ⋅     ⋅     ⋅     ⋅    0.05   ⋅ \n  ⋅     ⋅     ⋅     ⋅     ⋅     ⋅        ⋅     ⋅     ⋅     ⋅     ⋅    0.05","category":"page"},{"location":"methods/CorrespondenceAnalysis/","page":"Correspondence Analysis","title":"Correspondence Analysis","text":"Dc = Diagonal(c)","category":"page"},{"location":"methods/CorrespondenceAnalysis/","page":"Correspondence Analysis","title":"Correspondence Analysis","text":"30×30 Diagonal{Float64, Vector{Float64}}:\n 0.0146194   ⋅          ⋅         …   ⋅          ⋅          ⋅ \n  ⋅         0.0350923   ⋅             ⋅          ⋅          ⋅ \n  ⋅          ⋅         0.0358928      ⋅          ⋅          ⋅ \n  ⋅          ⋅          ⋅             ⋅          ⋅          ⋅ \n  ⋅          ⋅          ⋅             ⋅          ⋅          ⋅ \n  ⋅          ⋅          ⋅         …   ⋅          ⋅          ⋅ \n  ⋅          ⋅          ⋅             ⋅          ⋅          ⋅ \n  ⋅          ⋅          ⋅             ⋅          ⋅          ⋅ \n  ⋅          ⋅          ⋅             ⋅          ⋅          ⋅ \n  ⋅          ⋅          ⋅             ⋅          ⋅          ⋅ \n  ⋅          ⋅          ⋅         …   ⋅          ⋅          ⋅ \n  ⋅          ⋅          ⋅             ⋅          ⋅          ⋅ \n  ⋅          ⋅          ⋅             ⋅          ⋅          ⋅ \n ⋮                                ⋱                        \n  ⋅          ⋅          ⋅             ⋅          ⋅          ⋅ \n  ⋅          ⋅          ⋅             ⋅          ⋅          ⋅ \n  ⋅          ⋅          ⋅         …   ⋅          ⋅          ⋅ \n  ⋅          ⋅          ⋅             ⋅          ⋅          ⋅ \n  ⋅          ⋅          ⋅             ⋅          ⋅          ⋅ \n  ⋅          ⋅          ⋅             ⋅          ⋅          ⋅ \n  ⋅          ⋅          ⋅             ⋅          ⋅          ⋅ \n  ⋅          ⋅          ⋅         …   ⋅          ⋅          ⋅ \n  ⋅          ⋅          ⋅             ⋅          ⋅          ⋅ \n  ⋅          ⋅          ⋅            0.0233316   ⋅          ⋅ \n  ⋅          ⋅          ⋅             ⋅         0.0456555   ⋅ \n  ⋅          ⋅          ⋅             ⋅          ⋅         0.0309704","category":"page"},{"location":"methods/CorrespondenceAnalysis/#A.4-Calculate-the-matrix-of-standardized-residuals","page":"Correspondence Analysis","title":"A.4 Calculate the matrix of standardized residuals","text":"","category":"section"},{"location":"methods/CorrespondenceAnalysis/","page":"Correspondence Analysis","title":"Correspondence Analysis","text":"SR = D_r^-frac12(P - rc^T)D_c^-frac12","category":"page"},{"location":"methods/CorrespondenceAnalysis/","page":"Correspondence Analysis","title":"Correspondence Analysis","text":"SR = Dr^(-1/2) * (P - r * transpose(c)) * Dc^(-1/2)","category":"page"},{"location":"methods/CorrespondenceAnalysis/","page":"Correspondence Analysis","title":"Correspondence Analysis","text":"20×30 Named Matrix{Float64}\nReleve ╲ Species │    Species1     Species2  …    Species29    Species30\n─────────────────┼──────────────────────────────────────────────────────\nSiteA-1          │  -0.0270365    -0.018689  …   -0.0477784   -0.0393512\nSiteA-2          │  -0.0270365   -0.0418881       0.0251258   -0.0393512\nSiteA-3          │  -0.0270365   -0.0418881      -0.0477784   -0.0393512\nSiteA-4          │  -0.0262464     0.118631      -0.0290499   -0.0393512\nSiteA-5          │  -0.0270365   -0.0418881      -0.0477784     0.149897\nSiteA-6          │  -0.0270365   -0.0418881      -0.0429438   -0.0393512\nSiteA-7          │  -0.0270365   -0.0418881        0.102139   -0.0393512\nSiteA-8          │  -0.0270365     0.191145      -0.0477784   -0.0393512\nSiteA-9          │  -0.0270365   -0.0418881      -0.0477784   -0.0393512\nSiteA-10         │  -0.0270365    0.0274334       0.0463089   0.00632074\nSiteA-11         │  -0.0270365   -0.0418881       0.0635605   -0.0393512\nSiteA-12         │    0.139763   -0.0418881      -0.0477784  0.000641028\nSiteA-13         │  -0.0270365     0.128273      -0.0477784    0.0152549\nSiteA-14         │  -0.0270365     0.021643       0.0371391   -0.0393512\nSiteA-15         │  -0.0270365   -0.0418881        0.190038   -0.0393512\nSiteA-16         │    0.203468    0.0377921       0.0753923     0.182398\nSiteA-17         │  -0.0270365   -0.0418881      -0.0477784   -0.0393512\nSiteA-18         │  -0.0175933   -0.0418881      -0.0477784     0.128381\nSiteA-19         │  -0.0270365   -0.0418881       0.0100741    -0.039238\nSiteA-20         │    0.106156  -0.00357207  …   -0.0477784    0.0285598","category":"page"},{"location":"methods/CorrespondenceAnalysis/#A.5-Calculate-the-Singular-Value-Decomposition-(SVD)-of-S","page":"Correspondence Analysis","title":"A.5 Calculate the Singular Value Decomposition (SVD) of S","text":"","category":"section"},{"location":"methods/CorrespondenceAnalysis/","page":"Correspondence Analysis","title":"Correspondence Analysis","text":"begin\n  svd = LinearAlgebra.svd(SR)\n  U = svd.U\n  S = svd.S\n  V = svd.V\n  Vt = svd.Vt\nend","category":"page"},{"location":"methods/CorrespondenceAnalysis/","page":"Correspondence Analysis","title":"Correspondence Analysis","text":"20×30 Matrix{Float64}:\n -0.0834667   -0.0826961   0.00682271  …   0.251056    -0.144487\n -0.17851     -0.0465884   0.151652        0.212316    -0.243443\n -0.00796133  -0.0844173  -0.373164        0.160262    -0.0153378\n  0.116301    -0.409847   -0.136538        0.0489854    0.00988207\n  0.23395      0.0221703  -0.263783        0.281148     0.247465\n -0.349158     0.137912   -0.075029    …  -0.0403012   -0.151495\n -0.0515929   -0.100843   -0.111047       -0.0609628   -0.327441\n -0.0593648   -0.288053    0.138508       -0.0758089    0.124046\n  0.176908     0.0198735   0.00436814      0.213754     0.19303\n -0.231456    -0.249872    0.289406        0.0298204    0.0491983\n -0.249211    -0.0160094  -0.241274    …   0.170187     0.167615\n -0.0592155   -0.140334   -0.305935       -0.0888456    0.20524\n -0.0869345   -0.0110949   0.199427       -0.0853508    0.0366431\n  0.0478385    0.12772     0.159512       -0.0652945    0.211217\n -0.276144    -0.385785    0.0301642      -0.0313485    0.084354\n  0.11944     -0.105737    0.191683    …   0.00969266   0.253721\n  0.0468818    0.0164498  -0.111568        0.0814418    0.0388592\n -0.0622224    0.0127261  -0.118384       -0.44975      0.0350071\n  0.140203     0.234735    0.171128        0.0814814   -0.404583\n -0.0701122    0.225564    0.284214        0.441865     0.0570733","category":"page"},{"location":"methods/CorrespondenceAnalysis/#A.6-Standard-coordinates-*Φ*-of-rows","page":"Correspondence Analysis","title":"A.6 Standard coordinates Φ of rows","text":"","category":"section"},{"location":"methods/CorrespondenceAnalysis/","page":"Correspondence Analysis","title":"Correspondence Analysis","text":"Phi = D_r^-frac12 U","category":"page"},{"location":"methods/CorrespondenceAnalysis/","page":"Correspondence Analysis","title":"Correspondence Analysis","text":"Φ = Dr^(-1/2) * U","category":"page"},{"location":"methods/CorrespondenceAnalysis/","page":"Correspondence Analysis","title":"Correspondence Analysis","text":"20×20 Matrix{Float64}:\n  0.486723   -0.442572   -0.876122  …   0.254046   0.489505   -1.0\n -0.75182     1.39466    -0.596616      0.32767   -0.267702   -1.0\n  0.0795586   1.44857    -2.18556      -0.199978   0.31754    -1.0\n -0.393176   -0.463732    0.15696      -0.781441   0.038266   -1.0\n -1.46177    -0.101574   -0.591401      0.13674   -1.14578    -1.0\n -0.67707     0.969288    2.40662   …   1.39513    1.22287    -1.0\n -0.701642    1.61909     1.31315      -1.6185    -0.879744   -1.0\n -0.467516    0.545734   -0.835668      0.30908    0.601337   -1.0\n -0.414175   -0.225166    0.107186     -0.861464   0.22724    -1.0\n  0.875493   -1.13052     0.800475     -0.266995   0.532126   -1.0\n  0.66402     0.418495    1.89313   …   0.970445  -0.643278   -1.0\n -0.959926   -0.751598   -0.347087     -0.959162   0.0138849  -1.0\n -1.10606    -0.0296146  -0.596756      0.809426   0.219009   -1.0\n  1.27339     0.395968    0.159079     -1.32021   -2.58616    -1.0\n  2.82424     1.5375     -0.477013      0.518197   0.754764   -1.0\n -0.282905   -0.916899    0.45193   …  -1.07454    1.12809    -1.0\n  1.52947    -1.63457    -0.164203     -0.516428   0.529459   -1.0\n -0.0205451  -1.65816     0.106549      0.316625  -0.87736    -1.0\n -0.430282   -0.0697537  -0.220638     -0.194717   1.77731    -1.0\n -0.0660135  -0.905134   -0.504006      2.75608   -1.45138    -1.0","category":"page"},{"location":"methods/CorrespondenceAnalysis/#A.7-Standard-coordinates-*Γ*-of-columns","page":"Correspondence Analysis","title":"A.7 Standard coordinates Γ of columns","text":"","category":"section"},{"location":"methods/CorrespondenceAnalysis/","page":"Correspondence Analysis","title":"Correspondence Analysis","text":"Gamma = D_c^-frac12 V","category":"page"},{"location":"methods/CorrespondenceAnalysis/","page":"Correspondence Analysis","title":"Correspondence Analysis","text":"Γ = Dc^(-1/2) * V","category":"page"},{"location":"methods/CorrespondenceAnalysis/","page":"Correspondence Analysis","title":"Correspondence Analysis","text":"30×20 Matrix{Float64}:\n -0.690316   -1.47638   -0.0658446  …  -0.514614     1.15956    -0.579867\n -0.441448   -0.248698  -0.450636       0.0679344    1.25306     1.2041\n  0.0360125   0.800466  -1.96968       -0.624867     0.903268    1.50017\n -0.458192    1.08069    1.87546        0.629929    -1.3847      0.636856\n  1.26913    -1.2583    -0.0535878     -0.809565    -1.17589     0.447258\n  2.41248     0.630102  -0.215581   …   1.25435     -0.267925    0.155701\n -0.855116    1.09385   -0.955893       2.12418     -0.722948    1.87374\n  0.697508   -0.677056   0.717372       0.0196432   -0.165995    0.14723\n  1.23402    -2.39757   -0.343688      -1.0227       0.655229    1.19321\n -0.910015   -0.668957  -0.552071      -1.59604      0.25326     2.40986\n -1.40475     0.020469  -0.870045   …   0.473242     0.778746    1.20241\n -1.30723     1.04309    1.92068        0.688503     1.75375     1.31986\n -0.821187   -0.668616  -0.742893       0.957371     0.680027   -0.403676\n  ⋮                                 ⋱                           \n  0.164857   -1.4516    -0.229982       0.733327     2.02525    -0.400124\n -0.324777    0.614072   2.07192        0.439287    -0.0821405   0.137366\n -0.714961   -0.917316  -0.429153   …  -0.366773     0.127898    0.315558\n -0.539514    0.186602  -0.453321       0.00484725  -0.142605    0.0371357\n -0.083021   -0.812517  -0.698511       0.745157     0.761952   -0.683067\n  1.52358     2.16096   -1.90084       -0.15332      0.594512   -0.581155\n  0.190259    0.024423   1.29748        0.309493     0.299518    0.796723\n -1.24196    -0.624012  -0.794164   …  -0.621717    -1.98432     0.76939\n -0.853565    1.06668   -0.512272      -1.05909     -0.879741   -0.641752\n  0.130569   -0.645774  -0.274613       2.30872     -0.302089    0.99442\n  1.17496     0.993658   0.750042      -2.10487      0.38134     2.06796\n -0.821024   -1.38332   -0.0871545      0.198922    -2.29897     0.32431","category":"page"},{"location":"methods/CorrespondenceAnalysis/#A.8-Principal-coordinates-F-of-rows","page":"Correspondence Analysis","title":"A.8 Principal coordinates F of rows","text":"","category":"section"},{"location":"methods/CorrespondenceAnalysis/","page":"Correspondence Analysis","title":"Correspondence Analysis","text":"F = D_r^-frac12 U D_alpha = Phi D_alpha","category":"page"},{"location":"methods/CorrespondenceAnalysis/","page":"Correspondence Analysis","title":"Correspondence Analysis","text":"F = Φ * Diagonal(S)","category":"page"},{"location":"methods/CorrespondenceAnalysis/","page":"Correspondence Analysis","title":"Correspondence Analysis","text":"20×20 Matrix{Float64}:\n  0.305932   -0.262386   -0.485301   …   0.0474502   -1.34177e-16\n -0.472559    0.826844   -0.330477      -0.0259497   -1.34177e-16\n  0.0500069   0.858809   -1.21062        0.0307808   -1.34177e-16\n -0.247132   -0.274931    0.0869433      0.00370932  -1.34177e-16\n -0.918801   -0.0602196  -0.327588      -0.111066    -1.34177e-16\n -0.425575    0.574658    1.33307    …   0.118539    -1.34177e-16\n -0.44102     0.959901    0.727378      -0.0852781   -1.34177e-16\n -0.293859    0.323547   -0.462893       0.0582907   -1.34177e-16\n -0.260331   -0.133493    0.0593724      0.0220275   -1.34177e-16\n  0.550295   -0.670248    0.443398       0.0515817   -1.34177e-16\n  0.417372    0.248111    1.04864    …  -0.0623563   -1.34177e-16\n -0.603365   -0.445597   -0.192258       0.00134593  -1.34177e-16\n -0.695217   -0.0175575  -0.330555       0.0212297   -1.34177e-16\n  0.800394    0.234756    0.0881171     -0.25069     -1.34177e-16\n  1.77519     0.911532   -0.264227       0.0731632   -1.34177e-16\n -0.177821   -0.543598    0.250333   …   0.109352    -1.34177e-16\n  0.961354   -0.96908    -0.0909551      0.0513232   -1.34177e-16\n -0.0129137  -0.983069    0.0590197     -0.0850471   -1.34177e-16\n -0.270455   -0.0413546  -0.122215       0.172284    -1.34177e-16\n -0.041493   -0.536623   -0.279179      -0.14069     -1.34177e-16","category":"page"},{"location":"methods/CorrespondenceAnalysis/#A.9-Principal-coordinates-G-of-columns","page":"Correspondence Analysis","title":"A.9 Principal coordinates G of columns","text":"","category":"section"},{"location":"methods/CorrespondenceAnalysis/","page":"Correspondence Analysis","title":"Correspondence Analysis","text":"G = D_c^-frac12 V D_alpha = Gamma D_alpha","category":"page"},{"location":"methods/CorrespondenceAnalysis/","page":"Correspondence Analysis","title":"Correspondence Analysis","text":"G = Γ * Diagonal(S)","category":"page"},{"location":"methods/CorrespondenceAnalysis/","page":"Correspondence Analysis","title":"Correspondence Analysis","text":"30×20 Matrix{Float64}:\n -0.433901   -0.875294   -0.0364726   0.502468   …   0.112402   -7.7805e-17\n -0.277474   -0.147445   -0.249616   -1.14289        0.121465    1.61563e-16\n  0.0226358   0.474569   -1.09104    -0.376479       0.0875584   2.01289e-16\n -0.287998    0.640706    1.03885     0.690969      -0.134226    8.54516e-17\n  0.797714   -0.746005   -0.0296833  -0.0171083     -0.113985    6.00119e-17\n  1.51637     0.373566   -0.119415    0.259734   …  -0.0259713   2.08915e-17\n -0.537486    0.648504   -0.529488    0.309184      -0.070079    2.51413e-16\n  0.438421   -0.401403    0.397366   -0.528006      -0.0160907   1.97549e-17\n  0.775645   -1.42144    -0.190375    0.906115       0.0635147   1.60102e-16\n -0.571994   -0.396602   -0.305803    0.590528       0.0245497   3.23349e-16\n -0.882961    0.0121354  -0.481935   -0.528949   …   0.0754879   1.61335e-16\n -0.821663    0.618414    1.0639      0.327517       0.17        1.77095e-16\n -0.51616    -0.396399   -0.411503    0.0290026      0.0659186  -5.41642e-17\n  ⋮                                              ⋱              \n  0.103622   -0.860604   -0.127391   -0.128968       0.196318   -5.36876e-17\n -0.20414     0.364063    1.14768     0.212689      -0.0079623   1.84314e-17\n -0.449391   -0.543845   -0.237716    0.536383   …   0.0123978   4.23407e-17\n -0.339114    0.11063    -0.251103    0.543679      -0.0138234   4.98277e-18\n -0.0521832  -0.481714   -0.386919    0.710026       0.0738599  -9.16521e-17\n  0.957651    1.28116    -1.05291     0.14797        0.0576291  -7.79778e-17\n  0.119588    0.0144796   0.718701    0.125351       0.0290339   1.06902e-16\n -0.78064    -0.369955   -0.439903    0.710685   …  -0.19235     1.03235e-16\n -0.536512    0.632398   -0.283758   -0.383387      -0.0852779  -8.61085e-17\n  0.0820696  -0.382857   -0.152114   -0.650033      -0.029283    1.33429e-16\n  0.738528    0.589106    0.415463    0.11976        0.0369652   2.77474e-16\n -0.516058   -0.820124   -0.0482765   0.0293335     -0.222851    4.3515e-17","category":"page"},{"location":"methods/CorrespondenceAnalysis/#A.10-Principal-inertias-*λ*sub*k*/sub","page":"Correspondence Analysis","title":"A.10 Principal inertias λ<sub>k</sub>","text":"","category":"section"},{"location":"methods/CorrespondenceAnalysis/","page":"Correspondence Analysis","title":"Correspondence Analysis","text":"lambda_k = alpha_k^2 k = 12space where space k = minI-1J-1","category":"page"},{"location":"methods/CorrespondenceAnalysis/","page":"Correspondence Analysis","title":"Correspondence Analysis","text":"F * Dr * transpose(F)","category":"page"},{"location":"methods/CorrespondenceAnalysis/","page":"Correspondence Analysis","title":"Correspondence Analysis","text":"20×20 Matrix{Float64}:\n  0.111608    -0.00621648    0.00238871   …  -0.00190682  -0.00943001\n -0.00621648   0.168372      0.019383         0.0126478   -0.0215311\n  0.00238871   0.019383      0.191052        -0.00470524   0.00799422\n -0.0172022   -0.0011774    -0.0189871       -0.0206101   -0.00401321\n  0.0173567   -0.0193707     0.000861992      0.00392212  -0.0115102\n -0.0367434   -0.0198474    -0.0321792    …  -0.0139609   -0.0366429\n -0.0365044    0.0451249    -0.00200741       0.015891    -0.0300645\n -0.00498185  -0.0269155     0.0335267        0.00132939  -0.0156328\n -0.0229912   -0.00660581    0.00707136      -0.00754909   0.0237837\n -0.00728714  -0.0431406    -0.0378191       -0.0095094    0.0267062\n -0.00711515  -0.0142537    -0.0468059    …  -0.0117642   -0.0292263\n  0.00309654  -0.00198345   -0.0164962        0.00728305   0.0360607\n -0.0128892    0.0408842    -0.0271626        0.0136309   -0.0189993\n  0.0116829   -0.0334037     5.20459e-5      -0.00350846  -0.0124359\n  0.00264352   0.000650844   0.0283163       -0.0362417   -0.022822\n -0.0168451   -0.0277517    -0.0404056    …  -0.0242476    0.0355322\n  0.0395399   -0.0443538    -0.0368557        0.0025206    0.00502957\n -0.00820328  -0.0205112    -0.0272223        0.00635882  -0.00713614\n -0.00190682   0.0126478    -0.00470524       0.063882     0.00653783\n -0.00943001  -0.0215311     0.00799422       0.00653783   0.0778","category":"page"},{"location":"methods/CorrespondenceAnalysis/","page":"Correspondence Analysis","title":"Correspondence Analysis","text":"G * Dr * transpose(G)","category":"page"},{"location":"methods/CorrespondenceAnalysis/","page":"Correspondence Analysis","title":"Correspondence Analysis","text":"30×30 Matrix{Float64}:\n  0.287853     0.0020899    -0.05        …   0.00497576   0.11076\n  0.0020899    0.129844      0.0130032      -0.0190987   -0.000360857\n -0.05         0.0130032     0.153873       -0.0352912   -0.0291732\n -0.00529241  -0.0455742    -0.0329921       0.0243373   -0.0418147\n -0.023562    -0.00914246    0.00986709     -0.00640361  -0.0275514\n -0.0182422   -0.0193868    -0.00577019  …   0.0754695   -0.0335052\n -0.0250851    0.00135759    0.0146238      -0.0034414   -0.0212417\n -0.0466778    0.00935246   -0.0376175       0.0168005   -0.000841622\n -0.0348982   -0.0422496    -0.018585       -0.05         0.0193547\n  0.0871981   -0.0433852    -0.0223625      -0.04332     -0.00941375\n -0.0498566    0.0502712     0.0303993   …  -0.0368006    0.0452482\n  0.0119569   -0.0415984    -0.0351104      -0.00113308   0.0242462\n  0.0343865    0.0226615     0.0252612      -0.0303605    0.0441172\n  ⋮                                      ⋱               \n -0.0443       0.0285077    -0.0110312      -0.0312327    0.0336166\n -0.0474029   -0.0376146    -0.0349975       0.0229156   -0.0192874\n  0.0767784   -0.0299231    -0.00979266  …  -0.0179498    0.0661687\n -0.00787155  -0.0268708     0.0176321      -0.0231306   -0.0170495\n  0.067699    -0.041674     -0.00071316     -0.0350977   -0.0162272\n -0.0389861   -0.042058      0.078894        0.0546878   -0.0481857\n -0.0438775   -0.0171296    -0.0288536      -0.0110206   -0.040126\n  0.0496774    0.0339437    -0.0213707   …  -0.0449494    0.0304283\n -0.0385524    0.00616321    0.0545189      -0.0232554   -0.00913441\n  0.00719823   0.00789567   -0.00189163     -0.0193612   -0.014159\n  0.00497576  -0.0190987    -0.0352912       0.0942309   -0.00795953\n  0.11076     -0.000360857  -0.0291732      -0.00795953   0.150838","category":"page"},{"location":"methods/CorrespondenceAnalysis/#Create-Correspondence-Analysis-Function","page":"Correspondence Analysis","title":"Create Correspondence Analysis Function","text":"","category":"section"},{"location":"methods/CorrespondenceAnalysis/","page":"Correspondence Analysis","title":"Correspondence Analysis","text":"function correspondence_analysis(N::NamedMatrix)\n  \n  # A.1 Create the correspondence matrix\n  P = N / sum(N)\n\n  # A.2 Calculate column and row masses\n  r = vec(sum(P, dims = 2))\n  c = vec(sum(P, dims = 1))\n\n  # A.3 Diagonal matrices of row and column masses\n  Dr = Diagonal(r)\n  Dc = Diagonal(c)\n\n  # A.4 Calculate the matrix of standardized residuals\n  SR = Dr^(-1/2) * (P - r * transpose(c)) * Dc^(-1/2)\n\n  # A.5 Calculate the Singular Value Decomposition (SVD) of S\n  svd = LinearAlgebra.svd(SR)\n  U = svd.U\n  V = svd.V\n  S = svd.S\n  D = Diagonal(S)\n\n  # A.6 Standard coordinates Φ of rows\n  Φ_rownames = names(N)[1]\n  Φ_colnames = vec([\"Dim\"].*string.([1:1:size(N,1);]))\n  Φ = NamedArray(Dr^(-1/2) * U, names = (Φ_rownames, Φ_colnames), dimnames = (\"Plot\", \"Dimension\"))[1:end,1:end .!= end]\n  \n  # A.7 Standard coordinates Γ of columns\n  Γ_rownames = names(N)[2]\n  Γ_colnames = vec([\"Dim\"].*string.([1:1:size(N,1);]))\n  Γ = NamedArray(Dc^(-1/2) * V, names = (Γ_rownames, Γ_colnames), dimnames = (\"Species\", \"Dimension\"))[1:end,1:end .!= end]\n  \n  # A.8 Principal coordinates F of rows\n  # F = Φ * D\n  F = Dr^(-1/2) * U * D\n  F = F[1:end,1:end .!= end]\n  \n  # A.9 Principal coordinates G of columns\n  # G = Γ * D\n  G = Dc^(-1/2) * V * D\n  G = G[1:end,1:end .!= end]\n\n  results = (sv = D, # Singular values\n             rownames = names(N)[1], # Row names\n             rowmass = r, # Row masses\n            #  rowdist = , # Row chi-square distances to centroid\n            #  rowinertia = , # Row inertias\n             rowcoord = Φ, # Row standard coordinates\n            #  rowsup = , # Indicies of row supplementary points\n             colnames = names(N)[2], # Column names\n             colmass = c, # Column masses\n            #  coldist = , # Column chi-square distances to centroid\n            #  colinertia = , # Column inertias\n             colcoord = Γ, # Column standard coordinates\n            #  colsup = , # Indices of column supplementary points\n            N = N # The frequency table\n            )\n\n  return results\n\nend","category":"page"},{"location":"methods/CorrespondenceAnalysis/","page":"Correspondence Analysis","title":"Correspondence Analysis","text":"correspondence_analysis (generic function with 1 method)","category":"page"},{"location":"methods/CorrespondenceAnalysis/#Test-Function","page":"Correspondence Analysis","title":"Test Function","text":"","category":"section"},{"location":"methods/CorrespondenceAnalysis/","page":"Correspondence Analysis","title":"Correspondence Analysis","text":"ca_results = correspondence_analysis(N)","category":"page"},{"location":"methods/CorrespondenceAnalysis/","page":"Correspondence Analysis","title":"Correspondence Analysis","text":"(sv = [0.6285538734975543 0.0 … 0.0 0.0; 0.0 0.592865843166005 … 0.0 0.0; … ; 0.0 0.0 … 0.09693513414686916 0.0; 0.0 0.0 … 0.0 1.3417730517178384e-16], rownames = [\"SiteA-1\", \"SiteA-2\", \"SiteA-3\", \"SiteA-4\", \"SiteA-5\", \"SiteA-6\", \"SiteA-7\", \"SiteA-8\", \"SiteA-9\", \"SiteA-10\", \"SiteA-11\", \"SiteA-12\", \"SiteA-13\", \"SiteA-14\", \"SiteA-15\", \"SiteA-16\", \"SiteA-17\", \"SiteA-18\", \"SiteA-19\", \"SiteA-20\"], rowmass = [0.04999999999999999, 0.05, 0.049999999999999996, 0.05, 0.05, 0.05000000000000001, 0.049999999999999996, 0.05000000000000002, 0.049999999999999996, 0.049999999999999996, 0.05, 0.05, 0.04999999999999999, 0.05, 0.05, 0.049999999999999996, 0.049999999999999996, 0.05000000000000001, 0.05, 0.05000000000000001], rowcoord = [0.48672325436211406 -0.4425722994916393 … 0.2540464613662324 0.489504593503425; -0.751819930002042 1.3946556786933388 … 0.32767035864344946 -0.26770202479133304; … ; -0.43028201185575154 -0.06975367528017733 … -0.19471720063454273 1.7773099397488037; -0.06601349449550468 -0.9051343020038952 … 2.756075388482872 -1.4513787339358968], colnames = [\"Species1\", \"Species2\", \"Species3\", \"Species4\", \"Species5\", \"Species6\", \"Species7\", \"Species8\", \"Species9\", \"Species10\"  …  \"Species21\", \"Species22\", \"Species23\", \"Species24\", \"Species25\", \"Species26\", \"Species27\", \"Species28\", \"Species29\", \"Species30\"], colmass = [0.014619445973046706, 0.03509231182945023, 0.03589283669337291, 0.029367840998973965, 0.04947051366778396, 0.06064577028960117, 0.04090819345813372, 0.04564169444902769, 0.02373947255221797, 0.021093922253387326  …  0.037631473465615455, 0.03458500369347802, 0.034051447448272584, 0.03175179212980403, 0.04626555592464588, 0.017683122018486937, 0.05163712647655302, 0.02333155190680658, 0.04565546279942191, 0.030970392169786434], colcoord = [-0.6903160660221958 -1.476377122101793 … -0.514613643518885 1.1595554476895726; -0.4414476827068227 -0.24869792195517818 … 0.06793435838566357 1.2530583129607327; … ; 1.1749639344172944 0.9936577351025302 … -2.1048655770674656 0.38133967972109967; -0.8210241274996654 -1.3833212877845855 … 0.19892224796424532 -2.2989735148187354], N = [0.0 0.019435329302988535 … 0.0 0.0; 0.0 0.0 … 0.06966489783811937 0.0; … ; 0.0 0.0 … 0.05528193381599993 8.909509241404038e-5; 0.07202130411142336 0.032099768393747084 … 0.0 0.0534476732463204])","category":"page"},{"location":"methods/CorrespondenceAnalysis/#Plot-Test-Results","page":"Correspondence Analysis","title":"Plot Test Results","text":"","category":"section"},{"location":"methods/CorrespondenceAnalysis/","page":"Correspondence Analysis","title":"Correspondence Analysis","text":"begin\n  plots_x = ca_results.rowcoord[:,\"Dim1\"]\n  plots_y = ca_results.rowcoord[:,\"Dim2\"]\n\n  species_x = ca_results.colcoord[:,\"Dim1\"]\n  species_y = ca_results.colcoord[:,\"Dim2\"]\n\n  Plots.scatter(species_x, species_y, series_annotations = text.(ca_results.colnames, 8, :right, :bottom), framestyle=:origin, label = \"Species\")\n  Plots.scatter!(plots_x, plots_y, series_annotations = text.(ca_results.rownames, 8, :right, :bottom), label = \"Plots\")\nend","category":"page"},{"location":"methods/CorrespondenceAnalysis/","page":"Correspondence Analysis","title":"Correspondence Analysis","text":"(Image: )","category":"page"},{"location":"methods/CorrespondenceAnalysis/#References","page":"Correspondence Analysis","title":"References","text":"","category":"section"},{"location":"methods/CorrespondenceAnalysis/","page":"Correspondence Analysis","title":"Correspondence Analysis","text":"Greenacre, Michael. 2017. Correspondence Analysis in Practice, Third Edition. CRC Press.","category":"page"},{"location":"methods/CorrespondenceAnalysis/","page":"Correspondence Analysis","title":"Correspondence Analysis","text":"Nenadic, Oleg, and Michael Greenacre. 2007. “Correspondence Analysis in R, with Two- and <span class=\"nocase\">Three-dimensional Graphics</span>: The Ca Package.” Journal of Statistical Software 20 (February): 1–13. https://doi.org/10.18637/jss.v020.i03.","category":"page"},{"location":"reference/","page":"Reference","title":"Reference","text":"CurrentModule = VegSci","category":"page"},{"location":"reference/#Reference","page":"Reference","title":"Reference","text":"","category":"section"},{"location":"reference/#Content","page":"Reference","title":"Content","text":"","category":"section"},{"location":"reference/","page":"Reference","title":"Reference","text":"Pages = [\"_reference.md\"]","category":"page"},{"location":"reference/#Index","page":"Reference","title":"Index","text":"","category":"section"},{"location":"reference/","page":"Reference","title":"Reference","text":"","category":"page"},{"location":"reference/#Public-Interface","page":"Reference","title":"Public Interface","text":"","category":"section"},{"location":"reference/","page":"Reference","title":"Reference","text":"Modules = [\n    VegSci,\n]\nPrivate = false","category":"page"},{"location":"reference/#VegSci.SyntopicTable","page":"Reference","title":"VegSci.SyntopicTable","text":"SyntopicTable\n\nFields\n\nname – The names of the association, of class String\nreleve_n – The number of releves used to compose the syntopic table object, of class Int64\nreleve_ids – The ids of the releves used in the construction of the syntopic table object, usually the row names of the releve by species matrix, of class Vector{String}\nspecies_n – The number of species in the syntopic table, of class Int64\nspecies_names – The names of species in the syntopic table, of class Vector{String}\nabundance_units – The abundance units, of class String\nrelative_frequency – The relative frequency of occurrence of each species across all releves, of class Vector{Float64}\nabsolute_frequency – Vector{Float64}\nminimum_abundance – Vector{Float64}\nmean_abundance – Vector{Float64}\nmedian_abundance – Vector{Float64}\nmaximum_abundance – Vector{Float64}\nfidelity – Vector{Float64}\nfidelity_p – Vector{String}\nfidelity_n – Vector{String}\n\n\n\n\n\n","category":"type"},{"location":"reference/#VegSci.compose_syntopic_table_object","page":"Reference","title":"VegSci.compose_syntopic_table_object","text":"composesyntopictable_object(name::String, x::NamedArray)::SyntopicTable\n\nCompose a single syntopic table object from a releve by species matrix \n\nInput\n\nname – The name given to the association represented in the sytopic table, of class String\nx – A releve by species matrix, of class NamedArrays::NamedMatrix\ncover_abundance_scale – The units of the matrix values, of class String\n\nOutput\n\nA object of class VegSci.SyntopicTable. See ...\n\nNotes\n\nAlgorithm\n\nReferences\n\n\n\n\n\n","category":"function"},{"location":"reference/#VegSci.correspondence_analysis-Tuple{NamedArrays.NamedMatrix}","page":"Reference","title":"VegSci.correspondence_analysis","text":"correspondence_analysis(N::NamedMatrix)::NamedMatrix\n\nPerform a correspondence analysis following the computational algorithm outlined in appendix A of Greenacre (2017).\n\nInput\n\nN – A releve by species matrix of the class NamedArrays::NamedMatrix\n\nOutput\n\nNotes\n\nAlgorithm\n\nReferences\n\nGreenacre, M., 2017. Correspondence Analysis in Practice, Third Edition. CRC Press.\n\n\n\n\n\n","category":"method"},{"location":"reference/#VegSci.generate_test_array-Tuple{}","page":"Reference","title":"VegSci.generate_test_array","text":"greet_your_package_name(name)\n\nCreate a rown by coln NamedArray object containing random values.\n\n...\n\nArguments\n\nrown::Int64: The number of rows in the array.\ncoln::Int64: The number of columns in the array.\nmeancoloccs::Int64: The mean number of non-zero elements in the array.\nrowprefix::String: The prefix to the row number. \"Releve\" by default.\ncolprefix::String: The prefix to the column number. \"Species\" by default.\nrowdim::String: The row dimension name. \"Releve\" by default.\ncoldim::String: The column dimension name. \"Species\" by default.\n\n...\n\nExamples\n\njulia>generate_test_array(rown = 10, coln = 10, meancoloccs = 5, rowprefix = \"Releve\", colprefix = \"Species\")\n\n\n\n\n\n","category":"method"},{"location":"reference/#VegSci.indval_fidelity-Tuple{NamedArrays.NamedMatrix, Dict{String, Vector{String}}}","page":"Reference","title":"VegSci.indval_fidelity","text":"indval_fidelity(x::NamedMatrix, clusters::Dict{String, Vector{String}})::NamedMatrix\n\nCalculate the Dufrêne-Legendre Indicator Value Index (IndVal) fidelity values for a given releve by species matrix and set of clusters.\n\nInput\n\nx – A releve by species matrix of the class NamedArrays::NamedMatrix\nclusters – A dictionary containing the names of the clusters and associated lists of row names belonging to that cluster of the class Dict{String, Vector{String}}\n\nOutput\n\nA cluster by species NamedMatrix containing the fidelity values.\n\nNotes\n\nAlgorithm\n\nThis function implements the Dufrêne-Legendre Indicator Value Index as described in Dufrêne & Legendre (1997)\n\nReferences\n\nDufrêne, M. & Legendre, P. 1997. Species assemblages and indicator species: the need for a flexible asymmetrical approach. Ecol. Monogr. 67: 345-366.\n\n\n\n\n\n","category":"method"},{"location":"reference/#VegSci.jaccard_coefficient-Tuple{Union{Matrix, NamedArrays.NamedMatrix}}","page":"Reference","title":"VegSci.jaccard_coefficient","text":"\n\n\n\n","category":"method"},{"location":"reference/#VegSci.nzfunc-Tuple{Function, NamedArrays.NamedArray}","page":"Reference","title":"VegSci.nzfunc","text":"Draws heavily from the function outlines here: https://discourse.julialang.org/t/nanmean-options/4994/17\n\n\n\n\n\n","category":"method"},{"location":"reference/#Internal-functions","page":"Reference","title":"Internal functions","text":"","category":"section"},{"location":"reference/","page":"Reference","title":"Reference","text":"Modules = [\n    VegSci,\n]\nPublic = false","category":"page"},{"location":"reference/#VegSci.binary_dissimilarity-Tuple{Union{Matrix, NamedArrays.NamedMatrix}, String}","page":"Reference","title":"VegSci.binary_dissimilarity","text":"binary_dissimilarity(x::Union{Matrix, NamedMatrix}, eq::AbstractString)\n\nCreate a personalised greeting for VegSci using a name.\n\n...\n\nArguments\n\nx::Union{Matrix, NamedMatrix}: A releve by species matrix of the class Matrix or NamedArrays.NamedMatrix\neq::AbstractString: A representing an equation using the terms a, b, and c. The Jaccard similarity by default. \"(a ./ (a .+ b .+ c)) + I\".\n\n...\n\nExamples\n\nx = generatetestarray(rown = 10, coln = 10)\njulia>binarysimilarity(x, \"(a ./ (a .+ b .+ c)) + I\")\n\n\n\n\n\n","category":"method"},{"location":"","page":"Home","title":"Home","text":"CurrentModule = VegSci","category":"page"},{"location":"","page":"Home","title":"Home","text":"Documentation for VegSci.jl.","category":"page"},{"location":"#VegSci","page":"Home","title":"VegSci","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"Tools for vegetation science.","category":"page"},{"location":"#Background","page":"Home","title":"Background","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"VegSci.jl is a package containing tools for vegetation science using Julia (Bezanson et al. 2017), a growing scientific programming language which solves the ‘two language problem’ (Roesch et al. 2023), offering C and FORTRAN-like performance alongside the readability and user-friendliness of higher level languages such as Python. VegSci.jl aims to collate selected functionality found in popular vegetation science software programs/packages such as JUICE, vegan, ade4, vegclust, vegsoup, and ecotraj into a single location with a user-friendly API and transparent methodologies. VegSci.jl is being developed with the aim of assisting in the creation of high-performance, reproducible analytical pipelines in vegetation research (Sperandii et al. 2024), developed primarily with the application to the vegetation of Great Britain in mind, but fully generalisable. Nomenclature follows Theurillat et al. (2021).","category":"page"},{"location":"#Installation","page":"Home","title":"Installation","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"To install the latest stable release of VegSci:","category":"page"},{"location":"","page":"Home","title":"Home","text":"using Pkg\nPkg.add(\"VegSci\")","category":"page"},{"location":"","page":"Home","title":"Home","text":"To install the development version of VegSci:","category":"page"},{"location":"","page":"Home","title":"Home","text":"using Pkg\nPkg.add(url=\"https://github.com/ZekeMarshall/VegSci.jl\", rev = \"develop\")","category":"page"},{"location":"#Usage-Example","page":"Home","title":"Usage Example","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"To demonstrate…","category":"page"},{"location":"","page":"Home","title":"Home","text":"First we begin with generating two example plot by species NamedArrays.NamedMatrix object using the function VegSci.generate_test_array as test data.","category":"page"},{"location":"","page":"Home","title":"Home","text":"dune = CSV.read(\"./data/dune.csv\", DataFrame, header = 1)\nx = float(NamedArray(Array(dune)))\nNamedArrays.setnames!(x, names(dune), 2)\nx","category":"page"},{"location":"","page":"Home","title":"Home","text":"20×30 Named Matrix{Float64}\nA ╲ B │ Achimill  Agrostol  Airaprae  …  Vicilath  Bracruta  Callcusp\n──────┼──────────────────────────────────────────────────────────────\n1     │      1.0       0.0       0.0  …       0.0       0.0       0.0\n2     │      3.0       0.0       0.0          0.0       0.0       0.0\n3     │      0.0       4.0       0.0          0.0       2.0       0.0\n4     │      0.0       8.0       0.0          0.0       2.0       0.0\n5     │      2.0       0.0       0.0          0.0       2.0       0.0\n6     │      2.0       0.0       0.0          0.0       6.0       0.0\n7     │      2.0       0.0       0.0          0.0       2.0       0.0\n8     │      0.0       4.0       0.0          0.0       2.0       0.0\n9     │      0.0       3.0       0.0          0.0       2.0       0.0\n10    │      4.0       0.0       0.0          1.0       2.0       0.0\n11    │      0.0       0.0       0.0          2.0       4.0       0.0\n12    │      0.0       4.0       0.0          0.0       4.0       0.0\n13    │      0.0       5.0       0.0          0.0       0.0       0.0\n14    │      0.0       4.0       0.0          0.0       0.0       4.0\n15    │      0.0       4.0       0.0          0.0       4.0       0.0\n16    │      0.0       7.0       0.0          0.0       4.0       3.0\n17    │      2.0       0.0       2.0          0.0       0.0       0.0\n18    │      0.0       0.0       0.0          1.0       6.0       0.0\n19    │      0.0       0.0       3.0          0.0       3.0       0.0\n20    │      0.0       5.0       0.0  …       0.0       4.0       3.0","category":"page"},{"location":"#Classification","page":"Home","title":"Classification","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"Let’s identify some potential associations using fuzzy c-means clustering, storing the cluster-releve memberships as a dictionary.","category":"page"},{"location":"","page":"Home","title":"Home","text":"r = Clustering.fuzzy_cmeans(transpose(x), 3, 2)\n\ncluster_weights = r.weights\nclusters_vec = vec(Tuple.(findmax(cluster_weights, dims = 2)[2]))\nclusters_mat = hcat(first.(clusters_vec), last.(clusters_vec))\n\nclusters = Dict\n\nfor i in unique(clusters_mat[:,2])\n\n    rowids = clusters_mat[clusters_mat[:,2] .== i, :][:,1]\n    rownames = names(x)[1][rowids]\n    clusters_i = Dict(string(i) => string.(rownames))\n    clusters = merge(clusters, clusters_i)\n    \nend\n\nclusters","category":"page"},{"location":"","page":"Home","title":"Home","text":"Dict{String, Vector{String}} with 3 entries:\n  \"1\" => [\"3\", \"4\", \"8\", \"9\", \"12\", \"13\"]\n  \"2\" => [\"1\", \"2\", \"5\", \"6\", \"7\", \"10\", \"11\", \"17\", \"18\"]\n  \"3\" => [\"14\", \"15\", \"16\", \"19\", \"20\"]","category":"page"},{"location":"#Creation-of-Syntopic-Tables","page":"Home","title":"Creation of Syntopic Tables","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"Once the plots have been grouped into clusters, we can proceed to summarise their composition via the creation of SyntopicTable objects.","category":"page"},{"location":"","page":"Home","title":"Home","text":"syn_1 = VegSci.compose_syntopic_table_object(\"Syn1\", x[getindex(clusters, \"1\"),:])\nsyn_2 = VegSci.compose_syntopic_table_object(\"Syn2\", x[getindex(clusters, \"2\"),:])\nVegSci.print_summary_syntopic_table(syn_1, \"normal\", \"proportion\")","category":"page"},{"location":"","page":"Home","title":"Home","text":"Community Name: Syn1\nReleves: n = 6\nSpecies: n = 19\nPostive Indicators: \nNegative Indicators: \n┌──────────┬───────────────────┬─────────────────┐\n│  Species │ RelativeFrequency │       Abundance │\n├──────────┼───────────────────┼─────────────────┤\n│ Alopgeni │               1.0 │ 5.0 (2.0 - 8.0) │\n│  Poatriv │               1.0 │ 5.0 (4.0 - 9.0) │\n│ Agrostol │               1.0 │ 4.0 (3.0 - 8.0) │\n│ Scorautu │               1.0 │ 2.0 (2.0 - 3.0) │\n│ Trifrepe │               1.0 │ 2.0 (1.0 - 3.0) │\n│  Poaprat │               0.8 │ 4.0 (2.0 - 5.0) │\n│ Sagiproc │               0.8 │ 2.0 (2.0 - 5.0) │\n│ Bracruta │               0.8 │ 2.0 (2.0 - 4.0) │\n│ Lolipere │               0.7 │ 4.5 (2.0 - 6.0) │\n│ Elymrepe │               0.5 │ 4.0 (4.0 - 6.0) │\n│ Juncbufo │               0.5 │ 4.0 (3.0 - 4.0) │\n│ Juncarti │               0.3 │ 4.0 (4.0 - 4.0) │\n│ Bellpere │               0.3 │ 2.0 (2.0 - 2.0) │\n│ Ranuflam │               0.3 │ 2.0 (2.0 - 2.0) │\n│ Rumeacet │               0.3 │ 2.0 (2.0 - 2.0) │\n│ Eleopalu │               0.2 │ 4.0 (4.0 - 4.0) │\n│ Bromhord │               0.2 │ 3.0 (3.0 - 3.0) │\n│ Cirsarve │               0.2 │ 2.0 (2.0 - 2.0) │\n│ Chenalbu │               0.2 │ 1.0 (1.0 - 1.0) │\n└──────────┴───────────────────┴─────────────────┘","category":"page"},{"location":"#Species-Fidelity","page":"Home","title":"Species Fidelity","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"Calculate the species fidelity scores using the Dufrêne-Legendre Indicator Value Index (IndVal) metric for each cluster.","category":"page"},{"location":"","page":"Home","title":"Home","text":"indval_fidelity = VegSci.indval_fidelity(x, clusters)","category":"page"},{"location":"","page":"Home","title":"Home","text":"3×30 Named Matrix{Float64}\nA ╲ B │  Achimill   Agrostol   Airaprae  …   Vicilath   Bracruta   Callcusp\n──────┼────────────────────────────────────────────────────────────────────\n1     │       0.0    2.30976        0.0  …        0.0   0.658824        0.0\n2     │   0.72428        0.0  0.0603567       0.18107   0.706757        0.0\n3     │       0.0        2.0   0.341772  …        0.0    1.31068    1.30435","category":"page"},{"location":"","page":"Home","title":"Home","text":"Let’s update the syntopic table objects with the fidelity values. By default the IndVal fidelity measure does not distinguish negative fidelity (Chytrý et al. 2002), so we just provide a ‘cut value’ to extract the postive, high-fidelity species.","category":"page"},{"location":"","page":"Home","title":"Home","text":"syn_1_f_mat = indval_fidelity[[\"1\"], :]\np_cut = 0.5\nsyn_1.fidelity = vec(syn_1_f_mat)\nsyn_1.fidelity_p = names(syn_1_f_mat[:, vec(map(col -> any(col .>= 0.5), eachcol(syn_1_f_mat)))])[2]\nVegSci.print_summary_syntopic_table(syn_1, \"normal\", \"proportion\")","category":"page"},{"location":"","page":"Home","title":"Home","text":"Community Name: Syn1\nReleves: n = 6\nSpecies: n = 19\nPostive Indicators: Agrostol Alopgeni Elymrepe Juncarti Juncbufo Lolipere Poaprat Poatriv Sagiproc Scorautu Trifrepe Bracruta\nNegative Indicators: \n┌──────────┬───────────────────┬─────────────────┐\n│  Species │ RelativeFrequency │       Abundance │\n├──────────┼───────────────────┼─────────────────┤\n│ Alopgeni │               1.0 │ 5.0 (2.0 - 8.0) │\n│  Poatriv │               1.0 │ 5.0 (4.0 - 9.0) │\n│ Agrostol │               1.0 │ 4.0 (3.0 - 8.0) │\n│ Scorautu │               1.0 │ 2.0 (2.0 - 3.0) │\n│ Trifrepe │               1.0 │ 2.0 (1.0 - 3.0) │\n│  Poaprat │               0.8 │ 4.0 (2.0 - 5.0) │\n│ Sagiproc │               0.8 │ 2.0 (2.0 - 5.0) │\n│ Bracruta │               0.8 │ 2.0 (2.0 - 4.0) │\n│ Lolipere │               0.7 │ 4.5 (2.0 - 6.0) │\n│ Elymrepe │               0.5 │ 4.0 (4.0 - 6.0) │\n│ Juncbufo │               0.5 │ 4.0 (3.0 - 4.0) │\n│ Juncarti │               0.3 │ 4.0 (4.0 - 4.0) │\n│ Bellpere │               0.3 │ 2.0 (2.0 - 2.0) │\n│ Ranuflam │               0.3 │ 2.0 (2.0 - 2.0) │\n│ Rumeacet │               0.3 │ 2.0 (2.0 - 2.0) │\n│ Eleopalu │               0.2 │ 4.0 (4.0 - 4.0) │\n│ Bromhord │               0.2 │ 3.0 (3.0 - 3.0) │\n│ Cirsarve │               0.2 │ 2.0 (2.0 - 2.0) │\n│ Chenalbu │               0.2 │ 1.0 (1.0 - 1.0) │\n└──────────┴───────────────────┴─────────────────┘","category":"page"},{"location":"#Generation-of-Pseudo-Releves","page":"Home","title":"Generation of Pseudo-Releves","text":"","category":"section"},{"location":"#Assignment-of-Releves-to-Vegetation-Classes","page":"Home","title":"Assignment of Releves to Vegetation Classes","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"Let’s compare the similarity of syn_1 and syn_2.","category":"page"},{"location":"#Steinhaus-coefficient","page":"Home","title":"Steinhaus coefficient","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"First, let’s compose a syntopic table object from the “y” sample data and extract the syntopic tables in matrix format.","category":"page"},{"location":"","page":"Home","title":"Home","text":"syn_1_mat = VegSci.extract_syntopic_matrix(syn_1)\nsyn_2_mat = VegSci.extract_syntopic_matrix(syn_2)","category":"page"},{"location":"","page":"Home","title":"Home","text":"1×21 Named Matrix{Float64}\nA ╲ B │ Achimill  Airaprae  Alopgeni  …  Trifrepe  Vicilath  Bracruta\n──────┼──────────────────────────────────────────────────────────────\nSyn2  │      2.0       2.0       2.0  …       3.0       1.0       3.0","category":"page"},{"location":"","page":"Home","title":"Home","text":"Now we have three matrices, containing the relative frequencies of each species present in the sample releves which constitute each syntaxon. However, each of the syntaxa are composed of a different set of species, in Julia we need a helper function to merge these matrices and ensure each matrix contains each species across all the matrices. This function is broadly equivalent to the R function base::merge.","category":"page"},{"location":"","page":"Home","title":"Home","text":"merged_syn_mats = VegSci.merge_namedarrays([syn_1_mat, syn_2_mat])","category":"page"},{"location":"","page":"Home","title":"Home","text":"2×27 Named Matrix{Float64}\nA ╲ B │ Agrostol  Alopgeni  Bellpere  …  Salirepe  Trifprat  Vicilath\n──────┼──────────────────────────────────────────────────────────────\nSyn1  │      4.0       5.0       2.0  …       0.0       0.0       0.0\nSyn2  │      0.0       2.0       2.0  …       3.0       2.0       1.0","category":"page"},{"location":"","page":"Home","title":"Home","text":"VegSci.steinhaus_coefficient(merged_syn_mats[[:\"Syn1\"], :], merged_syn_mats[Not(:\"Syn1\"), :])","category":"page"},{"location":"","page":"Home","title":"Home","text":"1×1 Named Matrix{Float64}\nA ╲ B │     Syn2\n──────┼─────────\nSyn1  │ 0.595041","category":"page"},{"location":"#Multivariate-Analysis","page":"Home","title":"Multivariate Analysis","text":"","category":"section"},{"location":"#Example-Workflow","page":"Home","title":"Example Workflow","text":"","category":"section"},{"location":"#External-Resources","page":"Home","title":"External Resources","text":"","category":"section"},{"location":"#Implemented-Methodologies","page":"Home","title":"Implemented Methodologies","text":"","category":"section"},{"location":"#Contribute","page":"Home","title":"Contribute","text":"","category":"section"},{"location":"#Acknowledgements","page":"Home","title":"Acknowledgements","text":"","category":"section"},{"location":"#References","page":"Home","title":"References","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"Bezanson, Jeff, Alan Edelman, Stefan Karpinksi, and Viral B. Shah. 2017. “Julia: A Fresh Approach to Numerical Computing.” SIAM Review 59 (1): 65–98. https://doi.org/10.1137/141000671.","category":"page"},{"location":"","page":"Home","title":"Home","text":"Chytrý, Milan, Lubomír Tichý, Jason Holt, and Zoltán Botta-Dukát. 2002. “Determination of Diagnostic Species with Statistical Fidelity Measures.” Journal of Vegetation Science 13 (1): 79–90. https://doi.org/10.1111/j.1654-1103.2002.tb02025.x.","category":"page"},{"location":"","page":"Home","title":"Home","text":"Roesch, Elisabeth, Joe G. Greener, Adam L. MacLean, Huda Nassar, Christopher Rackauckas, Timothy E. Holy, and Michael P. H. Stumpf. 2023. “Julia for Biologists.” Nature Methods 20 (5): 655–64. https://doi.org/10.1038/s41592-023-01832-z.","category":"page"},{"location":"","page":"Home","title":"Home","text":"Sperandii, Marta Gaia, Manuele Bazzichetto, Glenda Mendieta-Leiva, Sebastian Schmidtlein, Michael Bott, Renato A. Ferreira de Lima, Valério D. Pillar, Jodi N. Price, Viktoria Wagner, and Milan Chytrý. 2024. “Towards More Reproducibility in Vegetation Research.” Journal of Vegetation Science 35 (1): e13224. https://doi.org/10.1111/jvs.13224.","category":"page"},{"location":"","page":"Home","title":"Home","text":"Theurillat, Jean-Paul, Wolfgang Willner, Federico Fernández-González, Helga Bültmann, Andraž Čarni, Daniela Gigante, Ladislav Mucina, and Heinrich Weber. 2021. “International Code of Phytosociological Nomenclature. 4th Edition.” Applied Vegetation Science 24 (1): e12491. https://doi.org/10.1111/avsc.12491.","category":"page"},{"location":"methods/FidelityMeasures/#Fidelity-Measures","page":"Fidelity Measures","title":"Fidelity Measures","text":"","category":"section"},{"location":"methods/FidelityMeasures/","page":"Fidelity Measures","title":"Fidelity Measures","text":"using VegSci\nusing Clustering\nusing CSV\nusing DataFrames\nusing NamedArrays","category":"page"},{"location":"methods/FidelityMeasures/","page":"Fidelity Measures","title":"Fidelity Measures","text":"[ Info: Precompiling VegSci [31ef3d96-7648-423b-b844-5d3d759e611e]\n[ Info: Precompiling Clustering [aaaa29a8-35af-508c-8bc3-b662a17a0fe5]","category":"page"},{"location":"methods/FidelityMeasures/#Outline","page":"Fidelity Measures","title":"Outline","text":"","category":"section"},{"location":"methods/FidelityMeasures/","page":"Fidelity Measures","title":"Fidelity Measures","text":"This methods page provides an overview of the step-by-step implementation of the fidelity metrics following Chytrý et al. (2002).","category":"page"},{"location":"methods/FidelityMeasures/","page":"Fidelity Measures","title":"Fidelity Measures","text":"The functionality outlined here aims to replicate the functionality found in the program JUICE Tichý (2002).","category":"page"},{"location":"methods/FidelityMeasures/#Load-example-data.","page":"Fidelity Measures","title":"Load example data.","text":"","category":"section"},{"location":"methods/FidelityMeasures/","page":"Fidelity Measures","title":"Fidelity Measures","text":"Load the dune dataset bundled with the R package vegan.","category":"page"},{"location":"methods/FidelityMeasures/","page":"Fidelity Measures","title":"Fidelity Measures","text":"begin\n    dune_df = CSV.read(\"../data/dune.csv\", DataFrame, header = 1)\n    dune_na = NamedArray(Array(dune_df))\n    NamedArrays.setnames!(dune_na, names(dune_df), 2)\n  dune_na = float.(dune_na)\nend","category":"page"},{"location":"methods/FidelityMeasures/","page":"Fidelity Measures","title":"Fidelity Measures","text":"20×30 Named Matrix{Float64}\nA ╲ B │ Achimill  Agrostol  Airaprae  …  Vicilath  Bracruta  Callcusp\n──────┼──────────────────────────────────────────────────────────────\n1     │      1.0       0.0       0.0  …       0.0       0.0       0.0\n2     │      3.0       0.0       0.0          0.0       0.0       0.0\n3     │      0.0       4.0       0.0          0.0       2.0       0.0\n4     │      0.0       8.0       0.0          0.0       2.0       0.0\n5     │      2.0       0.0       0.0          0.0       2.0       0.0\n6     │      2.0       0.0       0.0          0.0       6.0       0.0\n7     │      2.0       0.0       0.0          0.0       2.0       0.0\n8     │      0.0       4.0       0.0          0.0       2.0       0.0\n9     │      0.0       3.0       0.0          0.0       2.0       0.0\n10    │      4.0       0.0       0.0          1.0       2.0       0.0\n11    │      0.0       0.0       0.0          2.0       4.0       0.0\n12    │      0.0       4.0       0.0          0.0       4.0       0.0\n13    │      0.0       5.0       0.0          0.0       0.0       0.0\n14    │      0.0       4.0       0.0          0.0       0.0       4.0\n15    │      0.0       4.0       0.0          0.0       4.0       0.0\n16    │      0.0       7.0       0.0          0.0       4.0       3.0\n17    │      2.0       0.0       2.0          0.0       0.0       0.0\n18    │      0.0       0.0       0.0          1.0       6.0       0.0\n19    │      0.0       0.0       3.0          0.0       3.0       0.0\n20    │      0.0       5.0       0.0  …       0.0       4.0       3.0","category":"page"},{"location":"methods/FidelityMeasures/#Identify-Clusters","page":"Fidelity Measures","title":"Identify Clusters","text":"","category":"section"},{"location":"methods/FidelityMeasures/","page":"Fidelity Measures","title":"Fidelity Measures","text":"Let’s identify some clusters, storing the cluster-releve memberships as a dictionary.","category":"page"},{"location":"methods/FidelityMeasures/","page":"Fidelity Measures","title":"Fidelity Measures","text":"r = Clustering.fuzzy_cmeans(transpose(dune_na), 3, 2)\n\ncluster_weights = r.weights\nclusters_vec = vec(Tuple.(findmax(cluster_weights, dims = 2)[2]))\nclusters_mat = hcat(first.(clusters_vec), last.(clusters_vec))\n\nclusters = Dict\n\nfor i in unique(clusters_mat[:,2])\n\n    rowids = clusters_mat[clusters_mat[:,2] .== i, :][:,1]\n    rownames = names(dune_na)[1][rowids]\n    clusters_i = Dict(string(i) => string.(rownames))\n    clusters = merge(clusters, clusters_i)\n    \nend\n\nclusters","category":"page"},{"location":"methods/FidelityMeasures/","page":"Fidelity Measures","title":"Fidelity Measures","text":"Dict{String, Vector{String}} with 3 entries:\n  \"1\" => [\"3\", \"4\", \"8\", \"9\", \"12\", \"13\"]\n  \"2\" => [\"14\", \"15\", \"16\", \"19\", \"20\"]\n  \"3\" => [\"1\", \"2\", \"5\", \"6\", \"7\", \"10\", \"11\", \"17\", \"18\"]","category":"page"},{"location":"methods/FidelityMeasures/","page":"Fidelity Measures","title":"Fidelity Measures","text":"Create a presence-absence matrix by replacing all non-zero values with an Integer value of 1.","category":"page"},{"location":"methods/FidelityMeasures/","page":"Fidelity Measures","title":"Fidelity Measures","text":"dune_pa = Int.(dune_na .!= 0)","category":"page"},{"location":"methods/FidelityMeasures/","page":"Fidelity Measures","title":"Fidelity Measures","text":"20×30 Named Matrix{Int64}\nA ╲ B │ Achimill  Agrostol  Airaprae  …  Vicilath  Bracruta  Callcusp\n──────┼──────────────────────────────────────────────────────────────\n1     │        1         0         0  …         0         0         0\n2     │        1         0         0            0         0         0\n3     │        0         1         0            0         1         0\n4     │        0         1         0            0         1         0\n5     │        1         0         0            0         1         0\n6     │        1         0         0            0         1         0\n7     │        1         0         0            0         1         0\n8     │        0         1         0            0         1         0\n9     │        0         1         0            0         1         0\n10    │        1         0         0            1         1         0\n11    │        0         0         0            1         1         0\n12    │        0         1         0            0         1         0\n13    │        0         1         0            0         0         0\n14    │        0         1         0            0         0         1\n15    │        0         1         0            0         1         0\n16    │        0         1         0            0         1         1\n17    │        1         0         1            0         0         0\n18    │        0         0         0            1         1         0\n19    │        0         0         1            0         1         0\n20    │        0         1         0  …         0         1         1","category":"page"},{"location":"methods/FidelityMeasures/#Calculate-fidelity-metrics","page":"Fidelity Measures","title":"Calculate fidelity metrics","text":"","category":"section"},{"location":"methods/FidelityMeasures/","page":"Fidelity Measures","title":"Fidelity Measures","text":"Using cluster 1 as an example, p = 1.","category":"page"},{"location":"methods/FidelityMeasures/#Observed-Frequencies","page":"Fidelity Measures","title":"Observed Frequencies","text":"","category":"section"},{"location":"methods/FidelityMeasures/","page":"Fidelity Measures","title":"Fidelity Measures","text":"First, calculate the observed frequencies f(o)<sub>i</sub>.","category":"page"},{"location":"methods/FidelityMeasures/","page":"Fidelity Measures","title":"Fidelity Measures","text":"***N***","category":"page"},{"location":"methods/FidelityMeasures/","page":"Fidelity Measures","title":"Fidelity Measures","text":"Calculate N the number of releves in the matrix.","category":"page"},{"location":"methods/FidelityMeasures/","page":"Fidelity Measures","title":"Fidelity Measures","text":"N = size(dune_pa)[1]","category":"page"},{"location":"methods/FidelityMeasures/","page":"Fidelity Measures","title":"Fidelity Measures","text":"20","category":"page"},{"location":"methods/FidelityMeasures/","page":"Fidelity Measures","title":"Fidelity Measures","text":"***N<sub>p*</sub>**","category":"page"},{"location":"methods/FidelityMeasures/","page":"Fidelity Measures","title":"Fidelity Measures","text":"Calculate N<sub>p</sub> the number of releves in the particular vegetation unit.","category":"page"},{"location":"methods/FidelityMeasures/","page":"Fidelity Measures","title":"Fidelity Measures","text":"Np = length(getindex(clusters, \"1\"))","category":"page"},{"location":"methods/FidelityMeasures/","page":"Fidelity Measures","title":"Fidelity Measures","text":"6","category":"page"},{"location":"methods/FidelityMeasures/","page":"Fidelity Measures","title":"Fidelity Measures","text":"***n***","category":"page"},{"location":"methods/FidelityMeasures/","page":"Fidelity Measures","title":"Fidelity Measures","text":"Calculate n the number of occurrences of the species in the matrix.","category":"page"},{"location":"methods/FidelityMeasures/","page":"Fidelity Measures","title":"Fidelity Measures","text":"n = sum(dune_pa, dims = 1)\nsetnames!(n, [\"all\"], 1)\nn","category":"page"},{"location":"methods/FidelityMeasures/","page":"Fidelity Measures","title":"Fidelity Measures","text":"1×30 Named Matrix{Int64}\nA ╲ B │ Achimill  Agrostol  Airaprae  …  Vicilath  Bracruta  Callcusp\n──────┼──────────────────────────────────────────────────────────────\nall   │        7        10         2  …         3        15         3","category":"page"},{"location":"methods/FidelityMeasures/","page":"Fidelity Measures","title":"Fidelity Measures","text":"***f(o*)<sub>1</sub>**","category":"page"},{"location":"methods/FidelityMeasures/","page":"Fidelity Measures","title":"Fidelity Measures","text":"Calculate f(o)<sub>1</sub> or n<sub>p</sub>, the number of occurences of the species in the particular vegetation unit.","category":"page"},{"location":"methods/FidelityMeasures/","page":"Fidelity Measures","title":"Fidelity Measures","text":"np = sum(dune_pa[getindex(clusters, \"1\"),:], dims = 1)\nfo_1 = np","category":"page"},{"location":"methods/FidelityMeasures/","page":"Fidelity Measures","title":"Fidelity Measures","text":"1×30 Named Matrix{Int64}\n A ╲ B │ Achimill  Agrostol  Airaprae  …  Vicilath  Bracruta  Callcusp\n───────┼──────────────────────────────────────────────────────────────\nsum(A) │        0         6         0  …         0         5         0","category":"page"},{"location":"methods/FidelityMeasures/#Dufrêne-Legendre-Indicator-Value-Index","page":"Fidelity Measures","title":"Dufrêne-Legendre Indicator Value Index","text":"","category":"section"},{"location":"methods/FidelityMeasures/","page":"Fidelity Measures","title":"Fidelity Measures","text":"Calculate the Dufrêne-Legendre Indicator Value Index (IndVal) measure of species fidelity (Dufrêne and Legendre 1997) which does not use observed and expected frequencies.","category":"page"},{"location":"methods/FidelityMeasures/","page":"Fidelity Measures","title":"Fidelity Measures","text":"indval = ((np .* (N - Np)) ./ (((n .* Np) .- (2 .* np)) .+ (np .* N))) .* (np ./ Np)","category":"page"},{"location":"methods/FidelityMeasures/","page":"Fidelity Measures","title":"Fidelity Measures","text":"1×30 Named Matrix{Float64}\n A ╲ B │  Achimill   Agrostol   Airaprae  …   Vicilath   Bracruta   Callcusp\n───────┼────────────────────────────────────────────────────────────────────\nsum(A) │       0.0        0.5        0.0  …        0.0   0.324074        0.0","category":"page"},{"location":"methods/FidelityMeasures/","page":"Fidelity Measures","title":"Fidelity Measures","text":"***f(o*)<sub>2</sub>**","category":"page"},{"location":"methods/FidelityMeasures/","page":"Fidelity Measures","title":"Fidelity Measures","text":"Calculate n − n<sub>p</sub> the number of releves containing the species that aren’t in a particular vegetation unit.","category":"page"},{"location":"methods/FidelityMeasures/","page":"Fidelity Measures","title":"Fidelity Measures","text":"fo_2 = n - np","category":"page"},{"location":"methods/FidelityMeasures/","page":"Fidelity Measures","title":"Fidelity Measures","text":"┌ Warning: Using names of left argument\n└ @ NamedArrays ~/.julia/packages/NamedArrays/nqYoX/src/arithmetic.jl:25\n\n1×30 Named Matrix{Int64}\nA ╲ B │ Achimill  Agrostol  Airaprae  …  Vicilath  Bracruta  Callcusp\n──────┼──────────────────────────────────────────────────────────────\nall   │        7         4         2  …         3        10         3","category":"page"},{"location":"methods/FidelityMeasures/","page":"Fidelity Measures","title":"Fidelity Measures","text":"***f(o*)<sub>3</sub>**","category":"page"},{"location":"methods/FidelityMeasures/","page":"Fidelity Measures","title":"Fidelity Measures","text":"Calculate N<sub>p</sub> − n<sub>p</sub> the number of releves which don’t contain the species in a particular vegetation unit.","category":"page"},{"location":"methods/FidelityMeasures/","page":"Fidelity Measures","title":"Fidelity Measures","text":"fo_3 = Np .- np","category":"page"},{"location":"methods/FidelityMeasures/","page":"Fidelity Measures","title":"Fidelity Measures","text":"1×30 Named Matrix{Int64}\n A ╲ B │ Achimill  Agrostol  Airaprae  …  Vicilath  Bracruta  Callcusp\n───────┼──────────────────────────────────────────────────────────────\nsum(A) │        6         0         6  …         6         1         6","category":"page"},{"location":"methods/FidelityMeasures/","page":"Fidelity Measures","title":"Fidelity Measures","text":"***f(o*)<sub>4</sub>**","category":"page"},{"location":"methods/FidelityMeasures/","page":"Fidelity Measures","title":"Fidelity Measures","text":"Calculate N − N<sub>p</sub> − n + n<sub>p</sub> the number of releves not containing the species and not in the vegetation unit","category":"page"},{"location":"methods/FidelityMeasures/","page":"Fidelity Measures","title":"Fidelity Measures","text":"fo_4 = N - Np .- n .+ np","category":"page"},{"location":"methods/FidelityMeasures/","page":"Fidelity Measures","title":"Fidelity Measures","text":"1×30 Named Matrix{Int64}\nA ╲ B │ Achimill  Agrostol  Airaprae  …  Vicilath  Bracruta  Callcusp\n──────┼──────────────────────────────────────────────────────────────\nall   │        7        10        12  …        11         4        11","category":"page"},{"location":"methods/FidelityMeasures/#Expected-Frequencies","page":"Fidelity Measures","title":"Expected Frequencies","text":"","category":"section"},{"location":"methods/FidelityMeasures/","page":"Fidelity Measures","title":"Fidelity Measures","text":"Then calculate the expected frequencies f(e)<sub>i</sub>","category":"page"},{"location":"methods/FidelityMeasures/","page":"Fidelity Measures","title":"Fidelity Measures","text":"**f(e)_{1}**","category":"page"},{"location":"methods/FidelityMeasures/","page":"Fidelity Measures","title":"Fidelity Measures","text":"Calculate the expected number of the releves containing the species in the particular vegetation unit n ⋅ N<sub>p</sub>/N.","category":"page"},{"location":"methods/FidelityMeasures/","page":"Fidelity Measures","title":"Fidelity Measures","text":"fe_1 = n .* (Np / N)","category":"page"},{"location":"methods/FidelityMeasures/","page":"Fidelity Measures","title":"Fidelity Measures","text":"1×30 Named Matrix{Float64}\nA ╲ B │ Achimill  Agrostol  Airaprae  …  Vicilath  Bracruta  Callcusp\n──────┼──────────────────────────────────────────────────────────────\nall   │      2.1       3.0       0.6  …       0.9       4.5       0.9","category":"page"},{"location":"methods/FidelityMeasures/","page":"Fidelity Measures","title":"Fidelity Measures","text":"**f(e)_{2}**","category":"page"},{"location":"methods/FidelityMeasures/","page":"Fidelity Measures","title":"Fidelity Measures","text":"Cal","category":"page"},{"location":"methods/FidelityMeasures/","page":"Fidelity Measures","title":"Fidelity Measures","text":"fe_2 = n .* ((N - Np) / N)","category":"page"},{"location":"methods/FidelityMeasures/","page":"Fidelity Measures","title":"Fidelity Measures","text":"1×30 Named Matrix{Float64}\nA ╲ B │ Achimill  Agrostol  Airaprae  …  Vicilath  Bracruta  Callcusp\n──────┼──────────────────────────────────────────────────────────────\nall   │      4.9       7.0       1.4  …       2.1      10.5       2.1","category":"page"},{"location":"methods/FidelityMeasures/","page":"Fidelity Measures","title":"Fidelity Measures","text":"**f(e)_{3}**","category":"page"},{"location":"methods/FidelityMeasures/","page":"Fidelity Measures","title":"Fidelity Measures","text":"fe_3 = (N .- n) .* (Np ./ N)","category":"page"},{"location":"methods/FidelityMeasures/","page":"Fidelity Measures","title":"Fidelity Measures","text":"1×30 Named Matrix{Float64}\nA ╲ B │ Achimill  Agrostol  Airaprae  …  Vicilath  Bracruta  Callcusp\n──────┼──────────────────────────────────────────────────────────────\nall   │      3.9       3.0       5.4  …       5.1       1.5       5.1","category":"page"},{"location":"methods/FidelityMeasures/","page":"Fidelity Measures","title":"Fidelity Measures","text":"**f(e)_{4}**","category":"page"},{"location":"methods/FidelityMeasures/","page":"Fidelity Measures","title":"Fidelity Measures","text":"fe_4 = (N .- n) .* ((N - Np) / N)","category":"page"},{"location":"methods/FidelityMeasures/","page":"Fidelity Measures","title":"Fidelity Measures","text":"1×30 Named Matrix{Float64}\nA ╲ B │ Achimill  Agrostol  Airaprae  …  Vicilath  Bracruta  Callcusp\n──────┼──────────────────────────────────────────────────────────────\nall   │      9.1       7.0      12.6  …      11.9       3.5      11.9","category":"page"},{"location":"methods/FidelityMeasures/#Compose-functions","page":"Fidelity Measures","title":"Compose functions","text":"","category":"section"},{"location":"methods/FidelityMeasures/","page":"Fidelity Measures","title":"Fidelity Measures","text":"Here we create two functions, the first which doesn’t use observed and expected frequencies - the Dufrêne-Legendre Indicator Value Index function.","category":"page"},{"location":"methods/FidelityMeasures/","page":"Fidelity Measures","title":"Fidelity Measures","text":"function indval_fidelity(x::NamedMatrix, clusters::Dict{String, Vector{String}})\n\n    N = size(x)[1]\n    n = sum(x, dims = 1)\n\n    indval_all = NamedArrays.NamedArray(zeros(length(names(clusters)), size(x)[2]), names = (names(clusters), names(x)[2]))\n\n    for i in names(clusters)\n        Np = length(getindex(clusters, i))\n        np = sum(x[getindex(clusters, i),:], dims = 1)\n        indval = ((np .* (N - Np)) ./ (((n .* Np) .- (2 .* np)) .+ (np .* N))) .* (np ./ Np)\n        indval_all[i,:] = indval\n    end\n\n    return indval_all\n\nend","category":"page"},{"location":"methods/FidelityMeasures/","page":"Fidelity Measures","title":"Fidelity Measures","text":"indval_fidelity (generic function with 1 method)","category":"page"},{"location":"methods/FidelityMeasures/","page":"Fidelity Measures","title":"Fidelity Measures","text":"Test the indval_fidelity function.","category":"page"},{"location":"methods/FidelityMeasures/","page":"Fidelity Measures","title":"Fidelity Measures","text":"indval_fidelity(dune_pa, clusters)","category":"page"},{"location":"methods/FidelityMeasures/","page":"Fidelity Measures","title":"Fidelity Measures","text":"3×30 Named Matrix{Float64}\nA ╲ B │  Achimill   Agrostol   Airaprae  …   Vicilath   Bracruta   Callcusp\n──────┼────────────────────────────────────────────────────────────────────\n1     │       0.0        0.5        0.0  …        0.0   0.324074        0.0\n2     │       0.0   0.393443   0.107143           0.0   0.326531   0.391304\n3     │  0.316872        0.0  0.0339506  …   0.135802    0.18107        0.0","category":"page"},{"location":"methods/FidelityMeasures/#References","page":"Fidelity Measures","title":"References","text":"","category":"section"},{"location":"methods/FidelityMeasures/","page":"Fidelity Measures","title":"Fidelity Measures","text":"Chytrý, Milan, Lubomír Tichý, Jason Holt, and Zoltán Botta-Dukát. 2002. “Determination of Diagnostic Species with Statistical Fidelity Measures.” Journal of Vegetation Science 13 (1): 79–90. https://doi.org/10.1111/j.1654-1103.2002.tb02025.x.","category":"page"},{"location":"methods/FidelityMeasures/","page":"Fidelity Measures","title":"Fidelity Measures","text":"Dufrêne, Marc, and Pierre Legendre. 1997. “Species Assemblages and Indicator Species:the Need for a Flexible Asymmetrical Approach.” Ecological Monographs 67 (3): 345–66. https://doi.org/10.1890/0012-9615(1997)067[0345:SAAIST]2.0.CO;2.","category":"page"},{"location":"methods/FidelityMeasures/","page":"Fidelity Measures","title":"Fidelity Measures","text":"Tichý, Lubomír. 2002. “JUICE, Software for Vegetation Classification.” Journal of Vegetation Science 13 (3): 451–53. https://doi.org/10.1111/j.1654-1103.2002.tb02069.x.","category":"page"}]
}

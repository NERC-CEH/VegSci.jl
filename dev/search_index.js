var documenterSearchIndex = {"docs":
[{"location":"methods/CorrespondenceAnalysis/#Correspondence-Analysis","page":"Correspondence Analysis","title":"Correspondence Analysis","text":"","category":"section"},{"location":"methods/CorrespondenceAnalysis/#Outline","page":"Correspondence Analysis","title":"Outline","text":"","category":"section"},{"location":"methods/CorrespondenceAnalysis/","page":"Correspondence Analysis","title":"Correspondence Analysis","text":"This page details how to perform correspondence analysis in Julia following the computational algorithm outlined in appendix A of Greenacre (2017) and implemented in the R package ca (Nenadic and Greenacre 2007).","category":"page"},{"location":"methods/CorrespondenceAnalysis/","page":"Correspondence Analysis","title":"Correspondence Analysis","text":"The Julia package MultivariateStats.jl does not currently contain an implementation of correspondence analysis.","category":"page"},{"location":"methods/CorrespondenceAnalysis/#Import-Required-Packages","page":"Correspondence Analysis","title":"Import Required Packages","text":"","category":"section"},{"location":"methods/CorrespondenceAnalysis/#Julia","page":"Correspondence Analysis","title":"Julia","text":"","category":"section"},{"location":"methods/CorrespondenceAnalysis/","page":"Correspondence Analysis","title":"Correspondence Analysis","text":"using Pkg; Pkg.activate(\"docs\")\nusing EcoVeg\nusing NamedArrays\nusing LinearAlgebra\nusing CSV\nusing BenchmarkTools\nusing DataFrames\n# using Plots","category":"page"},{"location":"methods/CorrespondenceAnalysis/#R","page":"Correspondence Analysis","title":"R","text":"","category":"section"},{"location":"methods/CorrespondenceAnalysis/","page":"Correspondence Analysis","title":"Correspondence Analysis","text":"library(ca)\nlibrary(microbenchmark)\nlibrary(ggplot2)\nlibrary(dplyr)","category":"page"},{"location":"methods/CorrespondenceAnalysis/","page":"Correspondence Analysis","title":"Correspondence Analysis","text":"Attaching package: 'dplyr'\n\nThe following objects are masked from 'package:stats':\n\n    filter, lag\n\nThe following objects are masked from 'package:base':\n\n    intersect, setdiff, setequal, union","category":"page"},{"location":"methods/CorrespondenceAnalysis/","page":"Correspondence Analysis","title":"Correspondence Analysis","text":"library(JuliaCall)","category":"page"},{"location":"methods/CorrespondenceAnalysis/#Create-example-data","page":"Correspondence Analysis","title":"Create example data","text":"","category":"section"},{"location":"methods/CorrespondenceAnalysis/","page":"Correspondence Analysis","title":"Correspondence Analysis","text":"Create example data in the form of a site by species named matrix, N.","category":"page"},{"location":"methods/CorrespondenceAnalysis/","page":"Correspondence Analysis","title":"Correspondence Analysis","text":"<details class=\"code-fold\"> <summary>Code</summary>","category":"page"},{"location":"methods/CorrespondenceAnalysis/","page":"Correspondence Analysis","title":"Correspondence Analysis","text":"N = generate_test_array(rown = 20, coln = 30, meancoloccs = 10, rowprefix = \"SiteA-\", colprefix = \"Species\")","category":"page"},{"location":"methods/CorrespondenceAnalysis/","page":"Correspondence Analysis","title":"Correspondence Analysis","text":"</details>","category":"page"},{"location":"methods/CorrespondenceAnalysis/","page":"Correspondence Analysis","title":"Correspondence Analysis","text":"20×30 Named Matrix{Float64}\nReleve ╲ Species │   Species1    Species2  …   Species29   Species30\n─────────────────┼──────────────────────────────────────────────────\nSiteA-1          │        0.0         0.0  …    0.170432    0.158011\nSiteA-2          │        0.0   0.0870126      0.0725648         0.0\nSiteA-3          │        0.0         0.0            0.0         0.0\nSiteA-4          │   0.131351         0.0            0.0   0.0843551\nSiteA-5          │        0.0    0.295832            0.0         0.0\nSiteA-6          │        0.0         0.0            0.0         0.0\nSiteA-7          │ 0.00278463         0.0            0.0    0.145937\nSiteA-8          │   0.109003         0.0            0.0         0.0\n⋮                           ⋮           ⋮  ⋱           ⋮           ⋮\nSiteA-13         │        0.0         0.0            0.0   0.0647773\nSiteA-14         │        0.0   0.0165251            0.0         0.0\nSiteA-15         │  0.0247495         0.0            0.0         0.0\nSiteA-16         │        0.0    0.164256     0.00753465         0.0\nSiteA-17         │        0.0   0.0928379      0.0579124   0.0955104\nSiteA-18         │  0.0702064         0.0            0.0         0.0\nSiteA-19         │   0.152927   0.0883153            0.0         0.0\nSiteA-20         │  0.0351665         0.0  …         0.0         0.0","category":"page"},{"location":"methods/CorrespondenceAnalysis/","page":"Correspondence Analysis","title":"Correspondence Analysis","text":"<!– ## Perform chi^2 test","category":"page"},{"location":"methods/CorrespondenceAnalysis/","page":"Correspondence Analysis","title":"Correspondence Analysis","text":"Perform a chi-squared (chi^2) test to check whether there is asignificant dependence between the rows and columns. –>","category":"page"},{"location":"methods/CorrespondenceAnalysis/#A.1-Create-the-correspondence-matrix","page":"Correspondence Analysis","title":"A.1 Create the correspondence matrix","text":"","category":"section"},{"location":"methods/CorrespondenceAnalysis/","page":"Correspondence Analysis","title":"Correspondence Analysis","text":"Calculate the correspondence matrix P following <a href=\"#eq-p\" class=\"quarto-xref\">Equation 1</a>.","category":"page"},{"location":"methods/CorrespondenceAnalysis/","page":"Correspondence Analysis","title":"Correspondence Analysis","text":"<span id=\"eq-p\"> $ P = \\frac{1}{n}N  \\qquad(1)$ </span>","category":"page"},{"location":"methods/CorrespondenceAnalysis/","page":"Correspondence Analysis","title":"Correspondence Analysis","text":"begin\n  n = sum(N)\n  P = N / n\nend","category":"page"},{"location":"methods/CorrespondenceAnalysis/","page":"Correspondence Analysis","title":"Correspondence Analysis","text":"20×30 Named Matrix{Float64}\nReleve ╲ Species │    Species1     Species2  …    Species29    Species30\n─────────────────┼──────────────────────────────────────────────────────\nSiteA-1          │         0.0          0.0  …   0.00852162   0.00790053\nSiteA-2          │         0.0   0.00435063      0.00362824          0.0\nSiteA-3          │         0.0          0.0             0.0          0.0\nSiteA-4          │  0.00656756          0.0             0.0   0.00421775\nSiteA-5          │         0.0    0.0147916             0.0          0.0\nSiteA-6          │         0.0          0.0             0.0          0.0\nSiteA-7          │ 0.000139232          0.0             0.0   0.00729684\nSiteA-8          │  0.00545016          0.0             0.0          0.0\n⋮                            ⋮            ⋮  ⋱            ⋮            ⋮\nSiteA-13         │         0.0          0.0             0.0   0.00323887\nSiteA-14         │         0.0  0.000826253             0.0          0.0\nSiteA-15         │  0.00123748          0.0             0.0          0.0\nSiteA-16         │         0.0   0.00821279     0.000376733          0.0\nSiteA-17         │         0.0    0.0046419      0.00289562   0.00477552\nSiteA-18         │  0.00351032          0.0             0.0          0.0\nSiteA-19         │  0.00764635   0.00441577             0.0          0.0\nSiteA-20         │  0.00175833          0.0  …          0.0          0.0","category":"page"},{"location":"methods/CorrespondenceAnalysis/#A.2-Calculate-column-and-row-masses","page":"Correspondence Analysis","title":"A.2 Calculate column and row masses","text":"","category":"section"},{"location":"methods/CorrespondenceAnalysis/","page":"Correspondence Analysis","title":"Correspondence Analysis","text":"Calculate the row and and column masses using <a href=\"#eq-rowmasses\" class=\"quarto-xref\">Equation 2</a> and <a href=\"#eq-columnmasses\" class=\"quarto-xref\">Equation 3</a> respectively.","category":"page"},{"location":"methods/CorrespondenceAnalysis/","page":"Correspondence Analysis","title":"Correspondence Analysis","text":"<span id=\"eq-rowmasses\"> $ r = P1 \\space \\space r\\{i} = \\sum^{J}_{j = 1} P_{ij}  \\qquad(2)$ </span>","category":"page"},{"location":"methods/CorrespondenceAnalysis/","page":"Correspondence Analysis","title":"Correspondence Analysis","text":"<span id=\"eq-columnmasses\"> $ c = P^{t}1 \\space \\space c\\{j} = \\sum^{I}_{i = 1} P_{ij}  \\qquad(3)$ </span>","category":"page"},{"location":"methods/CorrespondenceAnalysis/","page":"Correspondence Analysis","title":"Correspondence Analysis","text":"r = vec(sum(P, dims = 2))","category":"page"},{"location":"methods/CorrespondenceAnalysis/","page":"Correspondence Analysis","title":"Correspondence Analysis","text":"20-element Vector{Float64}:\n 0.05\n 0.05\n 0.05000000000000001\n 0.05\n 0.049999999999999996\n 0.05\n 0.05000000000000001\n 0.049999999999999996\n 0.05\n 0.05000000000000002\n 0.049999999999999996\n 0.05\n 0.049999999999999996\n 0.049999999999999996\n 0.04999999999999999\n 0.049999999999999996\n 0.049999999999999996\n 0.05\n 0.04999999999999999\n 0.049999999999999996","category":"page"},{"location":"methods/CorrespondenceAnalysis/","page":"Correspondence Analysis","title":"Correspondence Analysis","text":"c = vec(sum(P, dims = 1))","category":"page"},{"location":"methods/CorrespondenceAnalysis/","page":"Correspondence Analysis","title":"Correspondence Analysis","text":"30-element Vector{Float64}:\n 0.029797285454353825\n 0.04254821738424704\n 0.022168578795640586\n 0.03667780057407388\n 0.03559269646595144\n 0.013147319471395386\n 0.03143078895024295\n 0.026883538366246268\n 0.02503468016746781\n 0.045659374956502644\n ⋮\n 0.015518681305573994\n 0.050225117248218466\n 0.035453680445382094\n 0.026486700867364404\n 0.04638580027640751\n 0.04378936059704854\n 0.0402633052739362\n 0.0191261733084541\n 0.027429514127492536","category":"page"},{"location":"methods/CorrespondenceAnalysis/#A.3-Diagonal-matrices-of-row-and-column-masses","page":"Correspondence Analysis","title":"A.3 Diagonal matrices of row and column masses","text":"","category":"section"},{"location":"methods/CorrespondenceAnalysis/","page":"Correspondence Analysis","title":"Correspondence Analysis","text":"Dr = Diagonal(r)","category":"page"},{"location":"methods/CorrespondenceAnalysis/","page":"Correspondence Analysis","title":"Correspondence Analysis","text":"20×20 Diagonal{Float64, Vector{Float64}}:\n 0.05   ⋅     ⋅     ⋅     ⋅     ⋅    …   ⋅     ⋅     ⋅     ⋅     ⋅     ⋅ \n  ⋅    0.05   ⋅     ⋅     ⋅     ⋅        ⋅     ⋅     ⋅     ⋅     ⋅     ⋅ \n  ⋅     ⋅    0.05   ⋅     ⋅     ⋅        ⋅     ⋅     ⋅     ⋅     ⋅     ⋅ \n  ⋅     ⋅     ⋅    0.05   ⋅     ⋅        ⋅     ⋅     ⋅     ⋅     ⋅     ⋅ \n  ⋅     ⋅     ⋅     ⋅    0.05   ⋅        ⋅     ⋅     ⋅     ⋅     ⋅     ⋅ \n  ⋅     ⋅     ⋅     ⋅     ⋅    0.05  …   ⋅     ⋅     ⋅     ⋅     ⋅     ⋅ \n  ⋅     ⋅     ⋅     ⋅     ⋅     ⋅        ⋅     ⋅     ⋅     ⋅     ⋅     ⋅ \n  ⋅     ⋅     ⋅     ⋅     ⋅     ⋅        ⋅     ⋅     ⋅     ⋅     ⋅     ⋅ \n  ⋅     ⋅     ⋅     ⋅     ⋅     ⋅        ⋅     ⋅     ⋅     ⋅     ⋅     ⋅ \n  ⋅     ⋅     ⋅     ⋅     ⋅     ⋅        ⋅     ⋅     ⋅     ⋅     ⋅     ⋅ \n  ⋅     ⋅     ⋅     ⋅     ⋅     ⋅    …   ⋅     ⋅     ⋅     ⋅     ⋅     ⋅ \n  ⋅     ⋅     ⋅     ⋅     ⋅     ⋅        ⋅     ⋅     ⋅     ⋅     ⋅     ⋅ \n  ⋅     ⋅     ⋅     ⋅     ⋅     ⋅        ⋅     ⋅     ⋅     ⋅     ⋅     ⋅ \n  ⋅     ⋅     ⋅     ⋅     ⋅     ⋅        ⋅     ⋅     ⋅     ⋅     ⋅     ⋅ \n  ⋅     ⋅     ⋅     ⋅     ⋅     ⋅       0.05   ⋅     ⋅     ⋅     ⋅     ⋅ \n  ⋅     ⋅     ⋅     ⋅     ⋅     ⋅    …   ⋅    0.05   ⋅     ⋅     ⋅     ⋅ \n  ⋅     ⋅     ⋅     ⋅     ⋅     ⋅        ⋅     ⋅    0.05   ⋅     ⋅     ⋅ \n  ⋅     ⋅     ⋅     ⋅     ⋅     ⋅        ⋅     ⋅     ⋅    0.05   ⋅     ⋅ \n  ⋅     ⋅     ⋅     ⋅     ⋅     ⋅        ⋅     ⋅     ⋅     ⋅    0.05   ⋅ \n  ⋅     ⋅     ⋅     ⋅     ⋅     ⋅        ⋅     ⋅     ⋅     ⋅     ⋅    0.05","category":"page"},{"location":"methods/CorrespondenceAnalysis/","page":"Correspondence Analysis","title":"Correspondence Analysis","text":"Dc = Diagonal(c)","category":"page"},{"location":"methods/CorrespondenceAnalysis/","page":"Correspondence Analysis","title":"Correspondence Analysis","text":"30×30 Diagonal{Float64, Vector{Float64}}:\n 0.0297973   ⋅          ⋅         …   ⋅          ⋅          ⋅ \n  ⋅         0.0425482   ⋅             ⋅          ⋅          ⋅ \n  ⋅          ⋅         0.0221686      ⋅          ⋅          ⋅ \n  ⋅          ⋅          ⋅             ⋅          ⋅          ⋅ \n  ⋅          ⋅          ⋅             ⋅          ⋅          ⋅ \n  ⋅          ⋅          ⋅         …   ⋅          ⋅          ⋅ \n  ⋅          ⋅          ⋅             ⋅          ⋅          ⋅ \n  ⋅          ⋅          ⋅             ⋅          ⋅          ⋅ \n  ⋅          ⋅          ⋅             ⋅          ⋅          ⋅ \n  ⋅          ⋅          ⋅             ⋅          ⋅          ⋅ \n ⋮                                ⋱                        \n  ⋅          ⋅          ⋅             ⋅          ⋅          ⋅ \n  ⋅          ⋅          ⋅             ⋅          ⋅          ⋅ \n  ⋅          ⋅          ⋅             ⋅          ⋅          ⋅ \n  ⋅          ⋅          ⋅             ⋅          ⋅          ⋅ \n  ⋅          ⋅          ⋅         …   ⋅          ⋅          ⋅ \n  ⋅          ⋅          ⋅             ⋅          ⋅          ⋅ \n  ⋅          ⋅          ⋅            0.0402633   ⋅          ⋅ \n  ⋅          ⋅          ⋅             ⋅         0.0191262   ⋅ \n  ⋅          ⋅          ⋅             ⋅          ⋅         0.0274295","category":"page"},{"location":"methods/CorrespondenceAnalysis/#A.4-Calculate-the-matrix-of-standardized-residuals","page":"Correspondence Analysis","title":"A.4 Calculate the matrix of standardized residuals","text":"","category":"section"},{"location":"methods/CorrespondenceAnalysis/","page":"Correspondence Analysis","title":"Correspondence Analysis","text":"<span id=\"eq-standardizedresiduals\"> $ SR = D\\{r}^{-\\frac{1}{2}}(P - rc^{T})D_{c}^{-\\frac{1}{2}}  \\qquad(4)$ </span>","category":"page"},{"location":"methods/CorrespondenceAnalysis/","page":"Correspondence Analysis","title":"Correspondence Analysis","text":"SR = Dr^(-1/2) * (P - r * transpose(c)) * Dc^(-1/2)","category":"page"},{"location":"methods/CorrespondenceAnalysis/","page":"Correspondence Analysis","title":"Correspondence Analysis","text":"20×30 Named Matrix{Float64}\nReleve ╲ Species │    Species1     Species2  …    Species29    Species30\n─────────────────┼──────────────────────────────────────────────────────\nSiteA-1          │  -0.0385988   -0.0461239  …      0.24464     0.176302\nSiteA-2          │  -0.0385988    0.0482011       0.0864026   -0.0370334\nSiteA-3          │  -0.0385988   -0.0461239      -0.0309242   -0.0370334\nSiteA-4          │    0.131551   -0.0461239      -0.0309242    0.0768569\nSiteA-5          │  -0.0385988     0.274569      -0.0309242   -0.0370334\nSiteA-6          │  -0.0385988   -0.0461239      -0.0309242   -0.0370334\nSiteA-7          │  -0.0349916   -0.0461239      -0.0309242     0.160001\nSiteA-8          │    0.102602   -0.0461239      -0.0309242   -0.0370334\n⋮                            ⋮            ⋮  ⋱            ⋮            ⋮\nSiteA-13         │  -0.0385988   -0.0461239      -0.0309242    0.0504245\nSiteA-14         │  -0.0385988   -0.0282101      -0.0309242   -0.0370334\nSiteA-15         │ -0.00653879   -0.0461239      -0.0309242   -0.0370334\nSiteA-16         │  -0.0385988     0.131936      -0.0187418   -0.0370334\nSiteA-17         │  -0.0385988    0.0545159       0.0627117    0.0919181\nSiteA-18         │   0.0523451   -0.0461239      -0.0309242   -0.0370334\nSiteA-19         │      0.1595    0.0496133      -0.0309242   -0.0370334\nSiteA-20         │   0.0069552   -0.0461239  …   -0.0309242   -0.0370334","category":"page"},{"location":"methods/CorrespondenceAnalysis/#A.5-Calculate-the-Singular-Value-Decomposition-(SVD)-of-S","page":"Correspondence Analysis","title":"A.5 Calculate the Singular Value Decomposition (SVD) of S","text":"","category":"section"},{"location":"methods/CorrespondenceAnalysis/","page":"Correspondence Analysis","title":"Correspondence Analysis","text":"begin\n  svd = LinearAlgebra.svd(SR)\n  U = svd.U\n  S = svd.S\n  V = svd.V\n  Vt = svd.Vt\nend","category":"page"},{"location":"methods/CorrespondenceAnalysis/","page":"Correspondence Analysis","title":"Correspondence Analysis","text":"20×30 Matrix{Float64}:\n  0.0277472   0.263536    0.183036    0.284186    …   0.07413     -0.00044748\n -0.124673    0.132335   -0.0313571   0.079454        0.133775     0.130072\n  0.0492648   0.360312   -0.0436118   0.151669       -0.0524779   -0.137841\n  0.0599456   0.101318   -0.24344    -0.0485777      -0.178755    -0.348148\n -0.0644521   0.0249991  -0.186244   -0.164796       -0.210954    -0.019968\n  0.126481   -0.106551    0.129724    0.112612    …   0.0511834    0.150883\n  0.163159   -0.0512313  -0.0907901   0.0994037      -0.413552    -0.174815\n -0.246268   -0.0135586   0.0581568  -0.00182286      0.0113439   -0.136203\n  0.0433817  -0.34875     0.204373   -0.010393        0.143411     0.0404354\n  0.0686343  -0.105994    0.182573   -0.413977       -0.00786521  -0.105437\n  0.432171   -0.149333   -0.181619    0.0809251   …   0.0748871   -0.026061\n -0.353368    0.249685   -0.0616244  -0.0453439       0.219725     0.0720968\n -0.0429023   0.190243    0.30537    -0.108484        0.159298    -0.259405\n  0.213778    0.202971   -0.449343   -0.293665        0.0312296    0.467769\n  0.234056    0.0461315   0.147221    0.281817        0.0811585    0.0418743\n -0.0497457   0.0412138  -0.0808324  -0.205025    …  -0.14202      0.173201\n  0.167446    0.256396    0.151087   -0.234452       -0.286027    -0.122344\n -0.0892483  -0.10088    -0.388253    0.221433        0.127351     0.0106292\n  0.19401     0.176481    0.0552762  -0.244265        0.107382    -0.0533481\n -0.0990352  -0.126195   -0.0711957  -0.311605        0.142285    -0.134679","category":"page"},{"location":"methods/CorrespondenceAnalysis/#A.6-Standard-coordinates-*Φ*-of-rows","page":"Correspondence Analysis","title":"A.6 Standard coordinates Φ of rows","text":"","category":"section"},{"location":"methods/CorrespondenceAnalysis/","page":"Correspondence Analysis","title":"Correspondence Analysis","text":"<span id=\"eq-standardcoordinatesrows\"> $ \\Phi = D_{r}^{-\\frac{1}{2}} U  \\qquad(5)$ </span>","category":"page"},{"location":"methods/CorrespondenceAnalysis/","page":"Correspondence Analysis","title":"Correspondence Analysis","text":"Φ = Dr^(-1/2) * U","category":"page"},{"location":"methods/CorrespondenceAnalysis/","page":"Correspondence Analysis","title":"Correspondence Analysis","text":"20×20 Matrix{Float64}:\n  0.542131    0.841649   -0.707821  -1.38023    …   0.219159   -0.619357  1.0\n  1.03052    -0.159256    0.347044  -0.571611      -1.29544     0.372989  1.0\n  0.477683   -0.652137   -1.23403   -0.608532      -0.300774   -0.82542   1.0\n  0.569041   -0.463937   -0.92046   -1.2413        -1.5854      2.08046   1.0\n  2.04167     0.448324    2.04881    0.589515      -0.795633    0.571818  1.0\n  1.14386    -0.554638   -0.282652  -1.27691    …   0.846201   -0.416927  1.0\n  0.328224   -0.139496   -1.28021   -0.84642       -0.454645   -1.66797   1.0\n -0.77596    -0.571572    0.124988   0.997407      -0.775544   -1.37952   1.0\n -1.20384    -3.0903      0.806721  -0.194074       0.0255838   0.232227  1.0\n -0.131173    0.844404    0.74448    0.492471      -1.03398     0.114153  1.0\n -0.139023    0.411493   -1.5002     1.96263    …  -1.09167     0.893059  1.0\n -0.396141    0.703335   -1.55756    1.14588        0.396413    0.183787  1.0\n -2.49513     2.01586     1.19386   -1.56641       -0.946202   -0.462779  1.0\n -1.17239    -1.30337     0.984823  -0.0023841      0.0830796   0.430646  1.0\n -0.738665   -0.0871971  -1.10044    0.246693       1.2481      0.140134  1.0\n  0.0637213   0.336415    0.544282   0.667391   …   0.637572   -1.67736   1.0\n -0.219168    0.738382    0.178073  -1.04666        2.42829     1.87591   1.0\n  0.859668   -0.1891      0.65495    0.777036       1.2833     -0.350366  1.0\n  0.914553    0.421802    0.910888   0.514256       0.737739   -0.578849  1.0\n -0.699585    0.449335    0.044459   1.34126        0.373856    1.08337   1.0","category":"page"},{"location":"methods/CorrespondenceAnalysis/","page":"Correspondence Analysis","title":"Correspondence Analysis","text":"# NamedArrays.setnames!(NamedArray(Φ), names = vec(names(N)[1]))\n# NamedArray(Φ, names(N)[1])","category":"page"},{"location":"methods/CorrespondenceAnalysis/#A.7-Standard-coordinates-*Γ*-of-columns","page":"Correspondence Analysis","title":"A.7 Standard coordinates Γ of columns","text":"","category":"section"},{"location":"methods/CorrespondenceAnalysis/","page":"Correspondence Analysis","title":"Correspondence Analysis","text":"<span id=\"eq-standardcoordinatescolumns\"> $ \\Gamma = D_{c}^{-\\frac{1}{2}} V  \\qquad(6)$ </span>","category":"page"},{"location":"methods/CorrespondenceAnalysis/","page":"Correspondence Analysis","title":"Correspondence Analysis","text":"Γ = Dc^(-1/2) * V","category":"page"},{"location":"methods/CorrespondenceAnalysis/","page":"Correspondence Analysis","title":"Correspondence Analysis","text":"30×20 Matrix{Float64}:\n  0.160743    -0.722244    0.285397   …  -0.517025    1.12392   -0.573722\n  1.27761      0.641555    1.74678       -0.489063    0.855574  -0.611789\n  1.22932     -0.210604   -0.292911      -2.60763     0.371252  -0.478173\n  1.48389      0.414872    0.791945       1.15622    -1.27544   -1.62706\n  0.465907    -0.121331   -0.484532       1.215       1.79504    0.30412\n -0.407832     1.17587    -1.39454    …   0.129133    1.54475   -1.43673\n -2.15349      1.22124     0.374751       0.167163   -0.362303   0.910496\n  1.62133      0.0356063   1.58289        0.0083305  -0.44619    0.636651\n  0.322265     0.298816    0.275601      -1.47833     0.324154   0.977762\n  0.623052    -0.178683   -0.282869       1.22766    -1.37135    1.46796\n  ⋮                                   ⋱                         \n  0.368465    -0.14963    -1.08514        3.0549      1.83656    0.58943\n -0.51469      0.217093   -1.50407        0.421448   -0.199464  -0.143708\n -0.875218     1.23369    -0.0776353     -1.04178    -1.80226    0.995381\n -1.1275      -2.96656     0.721649       0.342896    0.932523   1.76801\n -0.733064     1.25813     0.982183   …   1.35324    -0.604114   0.223364\n  0.694621    -0.392623   -0.802119      -0.926349   -1.42959   -0.947848\n -0.245193     0.347176   -1.77955       -1.27817     1.11786   -0.76953\n  0.536019     0.9673     -0.379457       0.920846    0.776459   1.02884\n -0.00270187   0.785371   -0.832278       0.0641791  -0.322114  -0.813187","category":"page"},{"location":"methods/CorrespondenceAnalysis/#A.8-Principal-coordinates-F-of-rows","page":"Correspondence Analysis","title":"A.8 Principal coordinates F of rows","text":"","category":"section"},{"location":"methods/CorrespondenceAnalysis/","page":"Correspondence Analysis","title":"Correspondence Analysis","text":"<span id=\"eq-principalcoordinatesrows\"> $ F = D_{r}^{-\\frac{1}{2}} U D_{\\alpha} = \\Phi D_{\\alpha}  \\qquad(7)$ </span>","category":"page"},{"location":"methods/CorrespondenceAnalysis/","page":"Correspondence Analysis","title":"Correspondence Analysis","text":"F = Φ * Diagonal(S)","category":"page"},{"location":"methods/CorrespondenceAnalysis/","page":"Correspondence Analysis","title":"Correspondence Analysis","text":"20×20 Matrix{Float64}:\n  0.364635    0.536427   -0.437139   -0.77529     …  -0.0581634  7.62993e-17\n  0.693123   -0.101502    0.214329   -0.321079        0.0350272  7.62993e-17\n  0.321287   -0.415641   -0.762115   -0.341818       -0.0775147  7.62993e-17\n  0.382733   -0.295692   -0.568462   -0.697251        0.195374   7.62993e-17\n  1.37322     0.285741    1.26531     0.331136        0.053699   7.62993e-17\n  0.769353   -0.3535     -0.174561   -0.717252    …  -0.0391533  7.62993e-17\n  0.220761   -0.0889081  -0.79064    -0.475442       -0.156638   7.62993e-17\n -0.521906   -0.364293    0.0771904   0.560252       -0.12955    7.62993e-17\n -0.809693   -1.96961     0.498218   -0.109013        0.0218083  7.62993e-17\n -0.0882265   0.538183    0.459779    0.276626        0.01072    7.62993e-17\n -0.0935063   0.262266   -0.926497    1.10243     …   0.0838666  7.62993e-17\n -0.266442    0.448272   -0.961927    0.643649        0.0172593  7.62993e-17\n -1.67821     1.28481     0.737307   -0.879868       -0.0434593  7.62993e-17\n -0.788543   -0.830704    0.608211   -0.00133917      0.0404417  7.62993e-17\n -0.496822   -0.0555753  -0.679616    0.13857         0.0131599  7.62993e-17\n  0.0428586   0.214415    0.33614     0.374879    …  -0.15752    7.62993e-17\n -0.147411    0.47061     0.109975   -0.587918        0.176165   7.62993e-17\n  0.578208   -0.120523    0.404487    0.436468       -0.0329027  7.62993e-17\n  0.615123    0.268837    0.56255     0.288862       -0.0543593  7.62993e-17\n -0.470537    0.286385    0.0274571   0.753398        0.101739   7.62993e-17","category":"page"},{"location":"methods/CorrespondenceAnalysis/#A.9-Principal-coordinates-G-of-columns","page":"Correspondence Analysis","title":"A.9 Principal coordinates G of columns","text":"","category":"section"},{"location":"methods/CorrespondenceAnalysis/","page":"Correspondence Analysis","title":"Correspondence Analysis","text":"<span id=\"eq-principalcoordinatesrows\"> $ G = D_{c}^{-\\frac{1}{2}} V D_{\\alpha} = \\Gamma D_{\\alpha}  \\qquad(8)$ </span>","category":"page"},{"location":"methods/CorrespondenceAnalysis/","page":"Correspondence Analysis","title":"Correspondence Analysis","text":"G = Γ * Diagonal(S)","category":"page"},{"location":"methods/CorrespondenceAnalysis/","page":"Correspondence Analysis","title":"Correspondence Analysis","text":"30×20 Matrix{Float64}:\n  0.108114    -0.460324    0.176256    0.195066  …   0.105547   -4.37746e-17\n  0.859314     0.408897    1.07878     0.275903      0.0803464  -4.6679e-17\n  0.826837    -0.134229   -0.180897   -0.918404      0.0348641  -3.64842e-17\n  0.998056     0.26442     0.489093   -0.142478     -0.119776   -1.24143e-16\n  0.313367    -0.0773305  -0.299239   -0.327366      0.168571    2.32041e-17\n -0.274305     0.749447   -0.861245    0.813528  …   0.145067   -1.09622e-16\n -1.44843      0.77836     0.23144    -0.377392     -0.0340237   6.94702e-17\n  1.0905       0.0226938   0.977566    0.322952     -0.0419014   4.8576e-17\n  0.216753     0.190451    0.170207    0.197298      0.0304411   7.46025e-17\n  0.419061    -0.113884   -0.174695   -0.153319     -0.128782    1.12004e-16\n  ⋮                                              ⋱              \n  0.247827    -0.0953674  -0.670164   -0.583507      0.17247     4.49731e-17\n -0.346178     0.138365   -0.928893    0.943697     -0.0187315  -1.09648e-17\n -0.588666     0.786297   -0.0479463  -0.143759     -0.169249    7.59468e-17\n -0.758353    -1.89074     0.445679   -0.269286      0.0875726   1.34898e-16\n -0.493054     0.801875    0.60658     0.182385  …  -0.056732    1.70425e-17\n  0.467198    -0.250239   -0.495376   -0.270616     -0.134252   -7.23201e-17\n -0.164915     0.221274   -1.09902     0.777537      0.104977   -5.87146e-17\n  0.360523     0.616511   -0.234347   -0.72603       0.0729168   7.84994e-17\n -0.00181726   0.500558   -0.514002   -1.18077      -0.0302496  -6.20456e-17","category":"page"},{"location":"methods/CorrespondenceAnalysis/#A.10-Principal-inertias-*λ*sub*k*/sub","page":"Correspondence Analysis","title":"A.10 Principal inertias λ<sub>k</sub>","text":"","category":"section"},{"location":"methods/CorrespondenceAnalysis/","page":"Correspondence Analysis","title":"Correspondence Analysis","text":"<span id=\"eq-principalinertias\"> $ \\lambda\\{k} = \\alpha_{k}^{2}, k = 1,2,...,\\space where \\space k = min\\I-1,J-1\\\n \\qquad(9)$ </span>","category":"page"},{"location":"methods/CorrespondenceAnalysis/","page":"Correspondence Analysis","title":"Correspondence Analysis","text":"F * Dr * transpose(F)","category":"page"},{"location":"methods/CorrespondenceAnalysis/","page":"Correspondence Analysis","title":"Correspondence Analysis","text":"20×20 Matrix{Float64}:\n  0.185804     0.0172968    -0.0441563   …  -0.00915386   -0.0369694\n  0.0172968    0.13057      -0.00226797      0.00610265   -0.0212148\n -0.0441563   -0.00226797    0.209484       -0.0164003    -0.0222328\n  0.0198157   -0.0167266     0.0288903      -0.00482476   -0.0406749\n -0.0184064    0.0209121    -0.0313273       0.0597688    -0.0250034\n  0.0250116    0.031794      0.00710539  …  -0.00287972   -0.0233792\n  0.0166774    0.000573079   0.0202196      -0.0275567    -0.00793825\n -0.0127093   -0.0296196    -0.0408504      -0.0159874     0.0568817\n -0.0453142   -0.00132332   -0.0111181      -0.023888     -0.0139068\n  0.00296881   0.00725656   -0.0226813       0.0336077     0.015313\n  0.00623326  -0.0437973     0.0020329   …  -0.0130872     0.00252162\n -0.0041632   -0.00645339    0.00342205     -0.0246943     0.0150378\n -0.00942158  -0.05         -0.05           -0.0268769     0.0138181\n -0.0471243   -0.0287668    -0.00706715     -0.0371324    -0.0298188\n -0.0195146   -0.039298     -0.0112581      -0.033084     -0.00833025\n -0.0271492   -0.00430903   -0.0220503   …  -0.000593994   0.00622623\n  0.0314837    0.0106455     0.0191718      -0.00942428   -0.0123814\n -0.0312089    0.018626     -0.00891622      0.00883097   -0.0303511\n -0.00915386   0.00610265   -0.0164003       0.134015      0.00325934\n -0.0369694   -0.0212148    -0.0222328       0.00325934    0.159143","category":"page"},{"location":"methods/CorrespondenceAnalysis/","page":"Correspondence Analysis","title":"Correspondence Analysis","text":"G * Dr * transpose(G)","category":"page"},{"location":"methods/CorrespondenceAnalysis/","page":"Correspondence Analysis","title":"Correspondence Analysis","text":"30×30 Matrix{Float64}:\n  0.130693     -0.0233681   -0.0177667   …  -0.05        -0.0148655\n -0.0233681     0.15719     -0.0130419       0.00484713  -0.031006\n -0.0177667    -0.0130419    0.215532        0.104433     0.0212732\n  0.017716      0.0598352    0.049445        0.0354312    0.001405\n  0.0368593    -0.0385474    0.0497935       0.0425507    0.0421976\n -0.05         -0.0143735   -0.0403772   …   0.0554215   -0.0335066\n -0.0130109    -0.0436006   -0.0453818      -0.0374281    0.00991364\n -0.000429491   0.0958988    0.0118984      -0.05        -0.0482198\n  0.0314036     0.0220936   -0.044188       -0.00633348  -0.0332198\n -0.0020434    -0.00216661   0.0540027       0.0114867    0.00496454\n  ⋮                                      ⋱               \n -0.0486332    -0.00743175  -0.0080931       0.0193996   -0.000987393\n -0.00576169   -0.035604    -0.0432601      -0.035824    -0.05\n -0.0247264    -0.0140882   -0.00912491      0.0795669    0.0337331\n -0.000477128  -0.0427819   -0.0329925      -0.0491217   -0.04899\n -0.00185211    0.0356473   -0.05        …  -0.00910993  -0.0113144\n  0.00826969   -0.01742      0.00901839     -0.0203782   -0.00285874\n -0.0352838    -0.05        -0.0487494      -0.033483    -0.00465508\n -0.05          0.00484713   0.104433        0.227753     0.104689\n -0.0148655    -0.031006     0.0212732       0.104689     0.171627","category":"page"},{"location":"methods/CorrespondenceAnalysis/#Create-Correspondence-Analysis-Function","page":"Correspondence Analysis","title":"Create Correspondence Analysis Function","text":"","category":"section"},{"location":"methods/CorrespondenceAnalysis/","page":"Correspondence Analysis","title":"Correspondence Analysis","text":"function correspondence_analysis(N::NamedMatrix)\n  \n  # A.1 Create the correspondence matrix\n  P = N / sum(N)\n\n  # A.2 Calculate column and row masses\n  r = vec(sum(P, dims = 2))\n  c = vec(sum(P, dims = 1))\n\n  # A.3 Diagonal matrices of row and column masses\n  Dr = Diagonal(r)\n  Dc = Diagonal(c)\n\n  # A.4 Calculate the matrix of standardized residuals\n  SR = Dr^(-1/2) * (P - r * transpose(c)) * Dc^(-1/2)\n\n  # A.5 Calculate the Singular Value Decomposition (SVD) of S\n  svd = LinearAlgebra.svd(SR)\n  U = svd.U\n  V = svd.V\n  S = svd.S\n  D = Diagonal(S)\n\n  # A.6 Standard coordinates Φ of rows\n  Φ_rownames = names(N)[1]\n  Φ_colnames = vec([\"Dim\"].*string.([1:1:size(N,1);]))\n  Φ = NamedArray(Dr^(-1/2) * U, names = (Φ_rownames, Φ_colnames), dimnames = (\"Plot\", \"Dimension\"))\n  \n  # A.7 Standard coordinates Γ of columns\n  Γ_rownames = names(N)[2]\n  Γ_colnames = vec([\"Dim\"].*string.([1:1:size(N,1);]))\n  Γ = NamedArray(Dc^(-1/2) * V, names = (Γ_rownames, Γ_colnames), dimnames = (\"Species\", \"Dimension\"))\n  \n  # A.8 Principal coordinates F of rows\n  # F = Φ * D\n  F = Dr^(-1/2) * U * D\n  \n  # A.9 Principal coordinates G of columns\n  # G = Γ * D\n  G = Dc^(-1/2) * V * D\n\n  # [1:end, 1:end .∉ [[20]]]\n\n  results = (sv = D, # Singular values\n             rownames = names(N)[1], # Row names\n             rowmass = r, # Row masses\n            #  rowdist = , # Row chi-square distances to centroid\n            #  rowinertia = , # Row inertias\n             rowcoord = Φ, # Row standard coordinates\n            #  rowsup = , # Indicies of row supplementary points\n             colnames = names(N)[2], # Column names\n             colmass = c, # Column masses\n            #  coldist = , # Column chi-square distances to centroid\n            #  colinertia = , # Column inertias\n             colcoord = Γ, # Column standard coordinates\n            #  colsup = , # Indices of column supplementary points\n            N = N # The frequency table\n            )\n\n  return results\n\nend","category":"page"},{"location":"methods/CorrespondenceAnalysis/","page":"Correspondence Analysis","title":"Correspondence Analysis","text":"correspondence_analysis (generic function with 1 method)","category":"page"},{"location":"methods/CorrespondenceAnalysis/#Test-Function","page":"Correspondence Analysis","title":"Test Function","text":"","category":"section"},{"location":"methods/CorrespondenceAnalysis/","page":"Correspondence Analysis","title":"Correspondence Analysis","text":"ca_results = correspondence_analysis(N)","category":"page"},{"location":"methods/CorrespondenceAnalysis/","page":"Correspondence Analysis","title":"Correspondence Analysis","text":"(sv = [0.6725942692278521 0.0 … 0.0 0.0; 0.0 0.6373526331747739 … 0.0 0.0; … ; 0.0 0.0 … 0.09390935412880762 0.0; 0.0 0.0 … 0.0 7.629925883268047e-17], rownames = [\"SiteA-1\", \"SiteA-2\", \"SiteA-3\", \"SiteA-4\", \"SiteA-5\", \"SiteA-6\", \"SiteA-7\", \"SiteA-8\", \"SiteA-9\", \"SiteA-10\", \"SiteA-11\", \"SiteA-12\", \"SiteA-13\", \"SiteA-14\", \"SiteA-15\", \"SiteA-16\", \"SiteA-17\", \"SiteA-18\", \"SiteA-19\", \"SiteA-20\"], rowmass = [0.05, 0.05, 0.05000000000000001, 0.05, 0.049999999999999996, 0.05, 0.05000000000000001, 0.049999999999999996, 0.05, 0.05000000000000002, 0.049999999999999996, 0.05, 0.049999999999999996, 0.049999999999999996, 0.04999999999999999, 0.049999999999999996, 0.049999999999999996, 0.05, 0.04999999999999999, 0.049999999999999996], rowcoord = [0.5421314805290488 0.8416488279753974 … -0.6193569008593827 0.9999999999999994; 1.0305221892233063 -0.15925583078659358 … 0.3729892801517001 1.0000000000000004; … ; 0.914552612810756 0.4218024913287271 … -0.5788488016502343 1.0000000000000004; -0.6995851884957469 0.44933527195795236 … 1.0833713051657947 0.9999999999999996], colnames = [\"Species1\", \"Species2\", \"Species3\", \"Species4\", \"Species5\", \"Species6\", \"Species7\", \"Species8\", \"Species9\", \"Species10\"  …  \"Species21\", \"Species22\", \"Species23\", \"Species24\", \"Species25\", \"Species26\", \"Species27\", \"Species28\", \"Species29\", \"Species30\"], colmass = [0.029797285454353825, 0.04254821738424704, 0.022168578795640586, 0.03667780057407388, 0.03559269646595144, 0.013147319471395386, 0.03143078895024295, 0.026883538366246268, 0.02503468016746781, 0.045659374956502644  …  0.034696148400630476, 0.015518681305573994, 0.050225117248218466, 0.035453680445382094, 0.026486700867364404, 0.04638580027640751, 0.04378936059704854, 0.0402633052739362, 0.0191261733084541, 0.027429514127492536], colcoord = [0.16074252219581042 -0.7222439561309885 … 1.1239223324173633 -0.573721846516808; 1.2776116669880744 0.6415551010340832 … 0.8555742739239312 -0.611789016408664; … ; 0.5360187780009981 0.9672998622466116 … 0.7764589947116682 1.0288357667901207; -0.002701868119655921 0.7853709416909604 … -0.3221144382016358 -0.8131871410115292], N = [0.0 0.0 … 0.1704324316308754 0.15801063157599765; 0.0 0.08701262538580858 … 0.07256484830489757 0.0; … ; 0.15292704456766795 0.08831531700803892 … 0.0 0.0; 0.03516652551133091 0.0 … 0.0 0.0])","category":"page"},{"location":"methods/CorrespondenceAnalysis/#Plot-Test-Results","page":"Correspondence Analysis","title":"Plot Test Results","text":"","category":"section"},{"location":"methods/CorrespondenceAnalysis/","page":"Correspondence Analysis","title":"Correspondence Analysis","text":"begin\n  plots_x = ca_results.rowcoord[:,\"Dim1\"]\n  plots_y = ca_results.rowcoord[:,\"Dim2\"]\n\n  species_x = ca_results.colcoord[:,\"Dim1\"]\n  species_y = ca_results.colcoord[:,\"Dim2\"]\n\n  # scatter(species_x, species_y, series_annotations = text.(ca_results.colnames, 8, :right, :bottom), framestyle=:origin, label = \"Species\")\n  # scatter!(plots_x, plots_y, series_annotations = text.(ca_results.rownames, 8, :right, :bottom), label = \"Plots\")\nend","category":"page"},{"location":"methods/CorrespondenceAnalysis/","page":"Correspondence Analysis","title":"Correspondence Analysis","text":"30-element Named Vector{Float64}\nSpecies   │ \n──────────┼──────────\nSpecies1  │ -0.722244\nSpecies2  │  0.641555\nSpecies3  │ -0.210604\nSpecies4  │  0.414872\nSpecies5  │ -0.121331\nSpecies6  │   1.17587\nSpecies7  │   1.22124\nSpecies8  │ 0.0356063\n⋮                   ⋮\nSpecies23 │  0.217093\nSpecies24 │   1.23369\nSpecies25 │  -2.96656\nSpecies26 │   1.25813\nSpecies27 │ -0.392623\nSpecies28 │  0.347176\nSpecies29 │    0.9673\nSpecies30 │  0.785371","category":"page"},{"location":"methods/CorrespondenceAnalysis/#R-vs-Julia-Dune-Data","page":"Correspondence Analysis","title":"R vs Julia Dune Data","text":"","category":"section"},{"location":"methods/CorrespondenceAnalysis/","page":"Correspondence Analysis","title":"Correspondence Analysis","text":"Let’s see how the R function ca::ca() compares to the Julia function correspondence_analysis() defined above.","category":"page"},{"location":"methods/CorrespondenceAnalysis/","page":"Correspondence Analysis","title":"Correspondence Analysis","text":"First load the dune dataset bundled in {vegan}.","category":"page"},{"location":"methods/CorrespondenceAnalysis/#Julia-2","page":"Correspondence Analysis","title":"Julia","text":"","category":"section"},{"location":"methods/CorrespondenceAnalysis/","page":"Correspondence Analysis","title":"Correspondence Analysis","text":"begin\n    dune_df = CSV.read(\"../data/dune.csv\", DataFrame, header = 1)\n    dune_na = NamedArray(Array(dune_df))\n    NamedArrays.setnames!(dune_na, names(dune_df), 2)\nend","category":"page"},{"location":"methods/CorrespondenceAnalysis/","page":"Correspondence Analysis","title":"Correspondence Analysis","text":"(OrderedCollections.OrderedDict{Any, Int64}(\"1\" => 1, \"2\" => 2, \"3\" => 3, \"4\" => 4, \"5\" => 5, \"6\" => 6, \"7\" => 7, \"8\" => 8, \"9\" => 9, \"10\" => 10…), OrderedCollections.OrderedDict{Any, Int64}(\"Achimill\" => 1, \"Agrostol\" => 2, \"Airaprae\" => 3, \"Alopgeni\" => 4, \"Anthodor\" => 5, \"Bellpere\" => 6, \"Bromhord\" => 7, \"Chenalbu\" => 8, \"Cirsarve\" => 9, \"Comapalu\" => 10…))","category":"page"},{"location":"methods/CorrespondenceAnalysis/#R-2","page":"Correspondence Analysis","title":"R","text":"","category":"section"},{"location":"methods/CorrespondenceAnalysis/","page":"Correspondence Analysis","title":"Correspondence Analysis","text":"dune <- as.matrix(read.csv(file = \"../data/dune.csv\"))","category":"page"},{"location":"methods/CorrespondenceAnalysis/#Run-CA-in-Julia-on-Dune-data","page":"Correspondence Analysis","title":"Run CA in Julia on Dune data","text":"","category":"section"},{"location":"methods/CorrespondenceAnalysis/","page":"Correspondence Analysis","title":"Correspondence Analysis","text":"dune_ca_julia = correspondence_analysis(dune_na)","category":"page"},{"location":"methods/CorrespondenceAnalysis/","page":"Correspondence Analysis","title":"Correspondence Analysis","text":"(sv = [0.7321237072731497 0.0 … 0.0 0.0; 0.0 0.6325690627910964 … 0.0 0.0; … ; 0.0 0.0 … 0.05896537573383853 0.0; 0.0 0.0 … 0.0 7.091790502929597e-17], rownames = [\"1\", \"2\", \"3\", \"4\", \"5\", \"6\", \"7\", \"8\", \"9\", \"10\", \"11\", \"12\", \"13\", \"14\", \"15\", \"16\", \"17\", \"18\", \"19\", \"20\"], rowmass = [0.02627737226277372, 0.06131386861313868, 0.05839416058394161, 0.0656934306569343, 0.06277372262773723, 0.07007299270072993, 0.05839416058394161, 0.05839416058394161, 0.06131386861313869, 0.06277372262773723, 0.04671532846715329, 0.051094890510948905, 0.04817518248175183, 0.03503649635036496, 0.03357664233576642, 0.04817518248175183, 0.0218978102189781, 0.03941605839416058, 0.04525547445255475, 0.04525547445255475], rowcoord = [0.8116737226994164 1.0826713631197626 … 2.417299499470586 0.9999999999999976; 0.6326772260449806 0.6958357017624843 … -0.049159624022002205 0.9999999999999993; … ; 0.6902687683328907 -3.2642026272615623 … 0.014843350243563693 1.0; -1.9443804612344018 -1.0688808878703615 … -1.087127732821526 1.0000000000000004], colnames = [\"Achimill\", \"Agrostol\", \"Airaprae\", \"Alopgeni\", \"Anthodor\", \"Bellpere\", \"Bromhord\", \"Chenalbu\", \"Cirsarve\", \"Comapalu\"  …  \"Ranuflam\", \"Rumeacet\", \"Sagiproc\", \"Salirepe\", \"Scorautu\", \"Trifprat\", \"Trifrepe\", \"Vicilath\", \"Bracruta\", \"Callcusp\"], colmass = [0.02335766423357664, 0.07007299270072993, 0.0072992700729927005, 0.05255474452554745, 0.030656934306569343, 0.01897810218978102, 0.021897810218978103, 0.00145985401459854, 0.00291970802919708, 0.00583941605839416  …  0.020437956204379562, 0.026277372262773723, 0.029197080291970802, 0.016058394160583942, 0.07883211678832117, 0.01313868613138686, 0.06861313868613139, 0.00583941605839416, 0.07153284671532847, 0.014598540145985401], colcoord = [1.2410388912758308 -0.13374974813501736 … 1.0922556626083908 0.5378610945054166; -1.275443784762892 0.3264688587581394 … -1.3054088243241777 0.6482522649395861; … ; -0.2488978439865396 -0.4185696756019523 … -0.01770675187655213 -0.49012289845882706; -2.6661966956330643 -0.8970175654454415 … -0.22298366681774884 -0.2585309105382417], N = [1 0 … 0 0; 3 0 … 0 0; … ; 0 0 … 3 0; 0 5 … 4 3])","category":"page"},{"location":"methods/CorrespondenceAnalysis/#Run-CA-in-R-using-Dune-data","page":"Correspondence Analysis","title":"Run CA in R using Dune data","text":"","category":"section"},{"location":"methods/CorrespondenceAnalysis/","page":"Correspondence Analysis","title":"Correspondence Analysis","text":"dune_ca_r <- ca::ca(dune)","category":"page"},{"location":"methods/CorrespondenceAnalysis/","page":"Correspondence Analysis","title":"Correspondence Analysis","text":"dune_ca_coords_r <- ca::cacoord(dune_ca_r)\ndune_ca_r_rowcoord <- dune_ca_coords_r$rows\ndune_ca_r_colcoord <- dune_ca_coords_r$columns","category":"page"},{"location":"methods/CorrespondenceAnalysis/#Check-equality-of-R-and-Julia-CA-results","page":"Correspondence Analysis","title":"Check equality of R and Julia CA results","text":"","category":"section"},{"location":"methods/CorrespondenceAnalysis/","page":"Correspondence Analysis","title":"Correspondence Analysis","text":"Check whether the standard row (plot) and column (species) coordinates produced by the Julia function correspondence_analaysis() the R function ca::ca() are identical.","category":"page"},{"location":"methods/CorrespondenceAnalysis/","page":"Correspondence Analysis","title":"Correspondence Analysis","text":"First retrieve the Julia results in R.","category":"page"},{"location":"methods/CorrespondenceAnalysis/","page":"Correspondence Analysis","title":"Correspondence Analysis","text":"dune_ca_julia <- JuliaCall::julia_eval(\"dune_ca_julia\")\ndune_ca_julia_rowcoord <- dune_ca_julia$rowcoord\ndune_ca_julia_colcoord <- dune_ca_julia$colcoord","category":"page"},{"location":"methods/CorrespondenceAnalysis/","page":"Correspondence Analysis","title":"Correspondence Analysis","text":"Then check for equivalence. Note that there are two differences in R and Julia data structure:","category":"page"},{"location":"methods/CorrespondenceAnalysis/","page":"Correspondence Analysis","title":"Correspondence Analysis","text":"Row and column names are stripped from the Julia results when  calling JuliaCall::julia_eval(\"dune_ca_julia\"), so the R results  are also unnamed.\nThe Julia results contain an additional dimension, populated with  1.0 values.","category":"page"},{"location":"methods/CorrespondenceAnalysis/","page":"Correspondence Analysis","title":"Correspondence Analysis","text":"These differences are corrected below whilst checking for equivalence.","category":"page"},{"location":"methods/CorrespondenceAnalysis/","page":"Correspondence Analysis","title":"Correspondence Analysis","text":"The R function all.equal is used rather than identical as the Julia implementation returns results with higher precision.","category":"page"},{"location":"methods/CorrespondenceAnalysis/","page":"Correspondence Analysis","title":"Correspondence Analysis","text":"plots_allequal <- all.equal(dune_ca_julia_rowcoord[,-20], unname(dune_ca_r_rowcoord))\nspecies_allequal <- all.equal(dune_ca_julia_colcoord[,-20], unname(dune_ca_r_colcoord))\nisTRUE(all(plots_allequal, species_allequal))","category":"page"},{"location":"methods/CorrespondenceAnalysis/","page":"Correspondence Analysis","title":"Correspondence Analysis","text":"[1] TRUE","category":"page"},{"location":"methods/CorrespondenceAnalysis/","page":"Correspondence Analysis","title":"Correspondence Analysis","text":"Let’s view the first two dimensions of the Julia and R results side-by-side.","category":"page"},{"location":"methods/CorrespondenceAnalysis/#Visualise-standard-coordinates","page":"Correspondence Analysis","title":"Visualise standard coordinates","text":"","category":"section"},{"location":"methods/CorrespondenceAnalysis/","page":"Correspondence Analysis","title":"Correspondence Analysis","text":"(Image: )","category":"page"},{"location":"methods/CorrespondenceAnalysis/#References","page":"Correspondence Analysis","title":"References","text":"","category":"section"},{"location":"methods/CorrespondenceAnalysis/","page":"Correspondence Analysis","title":"Correspondence Analysis","text":"Greenacre, Michael. 2017. Correspondence Analysis in Practice, Third Edition. CRC Press.","category":"page"},{"location":"methods/CorrespondenceAnalysis/","page":"Correspondence Analysis","title":"Correspondence Analysis","text":"Nenadic, Oleg, and Michael Greenacre. 2007. “Correspondence Analysis in R, with Two- and <span class=\"nocase\">Three-dimensional Graphics</span>: The Ca Package.” Journal of Statistical Software 20 (February): 1–13. https://doi.org/10.18637/jss.v020.i03.","category":"page"},{"location":"reference/","page":"Reference","title":"Reference","text":"CurrentModule = EcoVeg","category":"page"},{"location":"reference/#Reference","page":"Reference","title":"Reference","text":"","category":"section"},{"location":"reference/#Content","page":"Reference","title":"Content","text":"","category":"section"},{"location":"reference/","page":"Reference","title":"Reference","text":"Pages = [\"_reference.md\"]","category":"page"},{"location":"reference/#Index","page":"Reference","title":"Index","text":"","category":"section"},{"location":"reference/","page":"Reference","title":"Reference","text":"","category":"page"},{"location":"reference/#Public-Interface","page":"Reference","title":"Public Interface","text":"","category":"section"},{"location":"reference/","page":"Reference","title":"Reference","text":"Modules = [\n    EcoVeg,\n]\nPrivate = false","category":"page"},{"location":"reference/#EcoVeg.binary_similarity","page":"Reference","title":"EcoVeg.binary_similarity","text":"binary_similarity(x::NamedArray, eq::AbstractString)\n\nCreate a personalised greeting for EcoVeg using a name.\n\n...\n\nArguments\n\nx::NamedArray: A site by species \neq::AbstractString: A representing an equation using the terms a, b, and c. The Jaccard similarity by default. \"(a ./ (a .+ b .+ c)) + I\".\n\n...\n\nExamples\n\nx = generatetestarray(rown = 10, coln = 10)\njulia>binarysimilarity(x, \"(a ./ (a .+ b .+ c)) + I\")\n\n\n\n\n\n","category":"function"},{"location":"reference/#EcoVeg.generate_test_array-Tuple{}","page":"Reference","title":"EcoVeg.generate_test_array","text":"greet_your_package_name(name)\n\nCreate a rown by coln NamedArray object containing random values.\n\n...\n\nArguments\n\nrown::Int64: The number of rows in the array.\ncoln::Int64: The number of columns in the array.\nmeancoloccs::Int64: The mean number of non-zero elements in the array.\nrowprefix::String: The prefix to the row number. \"Releve\" by default.\ncolprefix::String: The prefix to the column number. \"Species\" by default.\nrowdim::String: The row dimension name. \"Releve\" by default.\ncoldim::String: The column dimension name. \"Species\" by default.\n\n...\n\nExamples\n\njulia>generate_test_array(rown = 10, coln = 10, meancoloccs = 5, rowprefix = \"Releve\", colprefix = \"Species\")\n\n\n\n\n\n","category":"method"},{"location":"reference/#EcoVeg.nzfunc-Tuple{Function, NamedArrays.NamedArray}","page":"Reference","title":"EcoVeg.nzfunc","text":"Draws heavily from the function outlines here: https://discourse.julialang.org/t/nanmean-options/4994/17\n\n\n\n\n\n","category":"method"},{"location":"reference/#Internal-functions","page":"Reference","title":"Internal functions","text":"","category":"section"},{"location":"reference/","page":"Reference","title":"Reference","text":"Modules = [\n    EcoVeg,\n]\nPublic = false","category":"page"},{"location":"","page":"Home","title":"Home","text":"CurrentModule = EcoVeg","category":"page"},{"location":"","page":"Home","title":"Home","text":"Documentation for EcoVeg.jl.","category":"page"},{"location":"#EcoVeg","page":"Home","title":"EcoVeg","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"Tools for vegetation science.","category":"page"},{"location":"#Background","page":"Home","title":"Background","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"EcoVeg.jl contains tools for vegetation science using the Julia programming language [@bezanson2017].","category":"page"},{"location":"","page":"Home","title":"Home","text":"Solves two language problem [@roesch2023]","category":"page"},{"location":"","page":"Home","title":"Home","text":"Aims to collate functionality found in JUICE, vegan, MAVIS into a single location with a user-friendly API and transparent methodologies. With the aim of assisting in the creation of reproducible analysis [@sperandii2024].","category":"page"},{"location":"","page":"Home","title":"Home","text":"Nomenclature follows @theurillat2021.","category":"page"},{"location":"#Installation","page":"Home","title":"Installation","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"To install the latest stable release of EcoVeg:","category":"page"},{"location":"","page":"Home","title":"Home","text":"using Pkg\nPkg.add(\"EcoVeg\")","category":"page"},{"location":"","page":"Home","title":"Home","text":"To install the development version of Ecoveg:","category":"page"},{"location":"","page":"Home","title":"Home","text":"using Pkg\nPkg.add(url=\"https://github.com/ZekeMarshall/EcoVeg.jl\", rev = \"develop\")","category":"page"},{"location":"#Usage-Example","page":"Home","title":"Usage Example","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"To demonstrate…","category":"page"},{"location":"","page":"Home","title":"Home","text":"First we begin with generating two example plot by species NamedArrays.NamedMatrix object using the function EcoVeg.generate_test_array as test data.","category":"page"},{"location":"","page":"Home","title":"Home","text":"x = generate_test_array(rown = 20, coln = 30, meancoloccs = 10, rowprefix = \"SiteA-\", colprefix = \"Species\")","category":"page"},{"location":"","page":"Home","title":"Home","text":"20×30 Named Matrix{Float64}\nReleve ╲ Species │   Species1    Species2  …   Species29   Species30\n─────────────────┼──────────────────────────────────────────────────\nSiteA-1          │        0.0         0.0  …         0.0         0.0\nSiteA-2          │        0.0         0.0            0.0   0.0742907\nSiteA-3          │  0.0704807   0.0369201            0.0         0.0\nSiteA-4          │        0.0         0.0            0.0         0.0\nSiteA-5          │        0.0         0.0       0.065016    0.114198\nSiteA-6          │        0.0         0.0     0.00555444         0.0\nSiteA-7          │        0.0   0.0550128            0.0   0.0563497\nSiteA-8          │        0.0         0.0            0.0   0.0475957\nSiteA-9          │        0.0   0.0139922            0.0         0.0\nSiteA-10         │   0.048195    0.058435      0.0296611         0.0\nSiteA-11         │        0.0         0.0            0.0         0.0\nSiteA-12         │        0.0         0.0            0.0   0.0508891\nSiteA-13         │        0.0   0.0798633            0.0    0.131321\nSiteA-14         │        0.0         0.0            0.0    0.183577\nSiteA-15         │        0.0         0.0       0.140305   0.0119757\nSiteA-16         │  0.0752609    0.067526      0.0843943         0.0\nSiteA-17         │  0.0864513         0.0            0.0         0.0\nSiteA-18         │ 0.00308486         0.0            0.0    0.147017\nSiteA-19         │        0.0    0.133836            0.0         0.0\nSiteA-20         │        0.0         0.0  …         0.0         0.0","category":"page"},{"location":"#Classification","page":"Home","title":"Classification","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"Let’s artifically create some clusters for now…","category":"page"},{"location":"","page":"Home","title":"Home","text":"cluster1 = [\"SiteA-1\", \"SiteA-2\", \"SiteA-4\", \"SiteA-7\", \"SiteA-10\", \"SiteA-11\", \"SiteA-12\", \"SiteA-15\", \"SiteA-18\", \"SiteA-19\"]\ncluster2 = [\"SiteA-3\", \"SiteA-5\", \"SiteA-6\", \"SiteA-8\", \"SiteA-9\", \"SiteA-13\", \"SiteA-14\", \"SiteA-16\", \"SiteA-17\", \"SiteA-20\"]","category":"page"},{"location":"","page":"Home","title":"Home","text":"10-element Vector{String}:\n \"SiteA-3\"\n \"SiteA-5\"\n \"SiteA-6\"\n \"SiteA-8\"\n \"SiteA-9\"\n \"SiteA-13\"\n \"SiteA-14\"\n \"SiteA-16\"\n \"SiteA-17\"\n \"SiteA-20\"","category":"page"},{"location":"#Creation-of-Syntopic-Tables","page":"Home","title":"Creation of Syntopic Tables","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"Once the plots have been grouped into clusters, we can proceed to summarise their composition via the creation of SyntopicTable objects.","category":"page"},{"location":"","page":"Home","title":"Home","text":"syn_1 = EcoVeg.compose_syntopic_table_object(\"Syn1\", x[cluster1,:])\nsyn_2 = EcoVeg.compose_syntopic_table_object(\"Syn2\", x[cluster2,:])\nprint_summary_syntopic_table(syn_2)","category":"page"},{"location":"","page":"Home","title":"Home","text":"Community Name: Syn2\nReleves: n = 10\nSpecies: n = 30\n╭───────────┬───────────────────┬─────────────────╮\n│   Species │ RelativeFrequency │       Abundance │\n├───────────┼───────────────────┼─────────────────┤\n│  Species8 │          0.116874 │ 0.1 (0.1 - 0.3) │\n│ Species15 │         0.0623607 │ 0.1 (0.0 - 0.2) │\n│ Species19 │         0.0584902 │ 0.1 (0.1 - 0.2) │\n│ Species11 │         0.0523788 │ 0.1 (0.1 - 0.2) │\n│ Species28 │         0.0513153 │ 0.2 (0.0 - 0.2) │\n│ Species26 │         0.0478617 │ 0.1 (0.1 - 0.2) │\n│ Species30 │         0.0476692 │ 0.1 (0.0 - 0.2) │\n│ Species14 │         0.0445658 │ 0.1 (0.0 - 0.2) │\n│ Species18 │         0.0403507 │ 0.1 (0.1 - 0.3) │\n│ Species21 │         0.0364615 │ 0.1 (0.1 - 0.2) │\n│ Species12 │         0.0343615 │ 0.1 (0.0 - 0.2) │\n│ Species17 │         0.0325703 │ 0.1 (0.0 - 0.1) │\n│ Species16 │         0.0315202 │ 0.1 (0.0 - 0.1) │\n│ Species23 │         0.0300857 │ 0.1 (0.0 - 0.1) │\n│  Species4 │         0.0298907 │ 0.1 (0.1 - 0.2) │\n│ Species13 │         0.0284227 │ 0.1 (0.0 - 0.1) │\n│  Species5 │         0.0275004 │ 0.1 (0.0 - 0.1) │\n│ Species22 │         0.0267309 │ 0.1 (0.0 - 0.1) │\n│  Species1 │         0.0232193 │ 0.1 (0.1 - 0.1) │\n│ Species27 │         0.0223382 │ 0.1 (0.1 - 0.1) │\n│  Species2 │         0.0198302 │ 0.1 (0.0 - 0.1) │\n│  Species7 │         0.0198162 │ 0.1 (0.1 - 0.1) │\n│  Species6 │          0.017789 │ 0.1 (0.1 - 0.1) │\n│ Species20 │         0.0175654 │ 0.1 (0.1 - 0.1) │\n│ Species25 │         0.0160109 │ 0.1 (0.0 - 0.1) │\n│  Species9 │         0.0156659 │ 0.1 (0.0 - 0.1) │\n│ Species29 │         0.0154965 │ 0.1 (0.0 - 0.1) │\n│ Species10 │         0.0115231 │ 0.1 (0.0 - 0.1) │\n│  Species3 │         0.0113954 │ 0.1 (0.0 - 0.1) │\n│ Species24 │        0.00993922 │ 0.0 (0.0 - 0.1) │\n╰───────────┴───────────────────┴─────────────────╯","category":"page"},{"location":"#Identification-of-High-Fidelity-Species","page":"Home","title":"Identification of High-Fidelity Species","text":"","category":"section"},{"location":"#Generation-of-Pseudo-Releves","page":"Home","title":"Generation of Pseudo-Releves","text":"","category":"section"},{"location":"#Assignment-of-Releves-to-Vegetation-Classes","page":"Home","title":"Assignment of Releves to Vegetation Classes","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"Let’s generate a second example matrix, consisting of sample 5 releves, against which we want to calculate the similarity.","category":"page"},{"location":"","page":"Home","title":"Home","text":"y = generate_test_array(rown = 5, coln = 30, meancoloccs = 10, rowprefix = \"SiteB-\", colprefix = \"Species\")","category":"page"},{"location":"","page":"Home","title":"Home","text":"5×30 Named Matrix{Float64}\nReleve ╲ Species │    Species1     Species2  …    Species29    Species30\n─────────────────┼──────────────────────────────────────────────────────\nSiteB-1          │         0.0     0.267636  …          0.0          0.0\nSiteB-2          │    0.149368    0.0515994             0.0     0.135862\nSiteB-3          │         0.0    0.0404588             0.0     0.108958\nSiteB-4          │         0.0          0.0        0.012553    0.0916869\nSiteB-5          │         0.0          0.0  …          0.0          0.0","category":"page"},{"location":"","page":"Home","title":"Home","text":"Three methods will be demonstrated.","category":"page"},{"location":"#Jaccard-Similarity","page":"Home","title":"Jaccard Similarity","text":"","category":"section"},{"location":"#Czekanowski-Index","page":"Home","title":"Czekanowski Index","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"First, let’s compose a syntopic table object from the “y” sample data and extract the syntopic tables in matrix format.","category":"page"},{"location":"","page":"Home","title":"Home","text":"syn_y = EcoVeg.compose_syntopic_table_object(\"Sample\", y)\nsyn_y_mat = extract_syntopic_matrix(syn_y)\nsyn_1_mat = extract_syntopic_matrix(syn_1)\nsyn_2_mat = extract_syntopic_matrix(syn_2)","category":"page"},{"location":"","page":"Home","title":"Home","text":"1×30 Named Matrix{Float64}\nA ╲ B │   Species8   Species15  …    Species3   Species24\n──────┼──────────────────────────────────────────────────\nSyn2  │   0.116874   0.0623607  …   0.0113954  0.00993922","category":"page"},{"location":"","page":"Home","title":"Home","text":"Now we have three matrices, containg the relative frequencies of each species present in the sample releves which constitute the phytocoenosis’. However, each of the phytocoenosis is composed of a different set of species, in Julia we need a helper function to ensure all columns are present in each of the matrices before joining.","category":"page"},{"location":"","page":"Home","title":"Home","text":"# align_array_columns(syn_y_mat, syn_2_mat)\n# align_array_columns(syn_y_mat, syn_1_mat)","category":"page"},{"location":"#Multivariate-Analysis","page":"Home","title":"Multivariate Analysis","text":"","category":"section"},{"location":"#Ecological-Trajectory-Analysis","page":"Home","title":"Ecological Trajectory Analysis","text":"","category":"section"},{"location":"#External-Resources","page":"Home","title":"External Resources","text":"","category":"section"},{"location":"#Implemented-Methodologies","page":"Home","title":"Implemented Methodologies","text":"","category":"section"},{"location":"#Contribute","page":"Home","title":"Contribute","text":"","category":"section"},{"location":"#Acknowledgements","page":"Home","title":"Acknowledgements","text":"","category":"section"},{"location":"#References","page":"Home","title":"References","text":"","category":"section"}]
}
